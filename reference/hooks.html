

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  
  
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Hooks | lakeFS</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Hooks" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hooks configuration and API reference" />
<meta property="og:description" content="Hooks configuration and API reference" />
<meta property="og:site_name" content="lakeFS" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hooks" />
<script type="application/ld+json">
{"description":"Hooks configuration and API reference","@type":"WebPage","headline":"Hooks","url":"/reference/hooks.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/logo.svg"}},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->
<meta property="og:image" content="/assets/img/shared-image.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script src="/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/assets/js/feedback.js"></script>


</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS" aria-label="Search lakeFS"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/"
           class="nav-list-link">What is lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/quickstart/"
           class="nav-list-link">Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/quickstart/run.html"
                   class="nav-list-link">Run lakeFS</a></li><li class="nav-list-item "><a href="/quickstart/repository.html"
                   class="nav-list-link">Create a Repository</a></li><li class="nav-list-item "><a href="/quickstart/add_data.html"
                   class="nav-list-link">Add Data</a></li><li class="nav-list-item "><a href="/quickstart/first_commit.html"
                   class="nav-list-link">Commit the Changes</a></li><li class="nav-list-item "><a href="/quickstart/more_quickstart_options.html"
                   class="nav-list-link">More Quickstart Options</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/deploy/"
           class="nav-list-link">Deploy and Setup lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/deploy/aws.html"
                   class="nav-list-link">AWS</a></li><li class="nav-list-item "><a href="/deploy/azure.html"
                   class="nav-list-link">Azure</a></li><li class="nav-list-item "><a href="/deploy/gcp.html"
                   class="nav-list-link">GCP</a></li><li class="nav-list-item "><a href="/deploy/onprem.html"
                   class="nav-list-link">On-Prem</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/integrations/spark.html"
                   class="nav-list-link">Spark</a></li><li class="nav-list-item "><a href="/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/integrations/airflow.html"
                   class="nav-list-link">Airflow</a></li><li class="nav-list-item "><a href="/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/integrations/presto_trino.html"
                   class="nav-list-link">Presto/Trino</a></li><li class="nav-list-item "><a href="/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/integrations/dbt.html"
                   class="nav-list-link">dbt</a></li><li class="nav-list-item "><a href="/integrations/kakfa.html"
                   class="nav-list-link">Kafka</a></li><li class="nav-list-item "><a href="/integrations/sagemaker.html"
                   class="nav-list-link">SageMaker</a></li><li class="nav-list-item "><a href="/integrations/hive.html"
                   class="nav-list-link">Hive</a></li><li class="nav-list-item "><a href="/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/integrations/iceberg.html"
                   class="nav-list-link">Iceberg</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/use_cases/"
           class="nav-list-link">Use Cases</a><ul class="nav-list "><li class="nav-list-item "><a href="/use_cases/iso_env.html"
                   class="nav-list-link">Isolated Dev/Test Environment</a></li><li class="nav-list-item "><a href="/use_cases/rollback.html"
                   class="nav-list-link">Rollback</a></li><li class="nav-list-item "><a href="/use_cases/reproducibility.html"
                   class="nav-list-link">Reproducibility</a></li><li class="nav-list-item "><a href="/use_cases/cicd_for_data.html"
                   class="nav-list-link">CI/CD for data lakes</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="/howto/import.html"
                   class="nav-list-link">Import data into lakeFS</a></li><li class="nav-list-item "><a href="/howto/garbage-collection.html"
                   class="nav-list-link">Garbage Collection</a></li><li class="nav-list-item "><a href="/howto/upgrade.html"
                   class="nav-list-link">Upgrade lakeFS</a></li><li class="nav-list-item "><a href="/howto/export.html"
                   class="nav-list-link">Exporting Data</a></li><li class="nav-list-item "><a href="/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/howto/protect-branches.html"
                   class="nav-list-link">Protect Branches</a></li><li class="nav-list-item "><a href="/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/reference/configuration.html"
                   class="nav-list-link">Configuration</a></li><li class="nav-list-item "><a href="/reference/cli.html"
                   class="nav-list-link">CLI (lakectl)</a></li><li class="nav-list-item "><a href="/reference/api.html"
                   class="nav-list-link">API Reference</a></li><li class="nav-list-item  active"><a href="/reference/hooks.html"
                   class="nav-list-link active">Hooks</a></li><li class="nav-list-item "><a href="/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/reference/s3.html"
                   class="nav-list-link">S3 Supported API</a></li><li class="nav-list-item "><a href="/reference/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/reference/saml-authentication-integration.html"
                   class="nav-list-link">SAML Authentication Integration</a></li><li class="nav-list-item "><a href="/reference/authorization.html"
                   class="nav-list-link">Authorization</a></li><li class="nav-list-item "><a href="/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/understand/model.html"
                   class="nav-list-link">Model</a></li><li class="nav-list-item "><a href="/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/how/"
                   class="nav-list-link">How it Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li></ul></li><li class="nav-list-item "><a href="/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li></ul></li><li
            class="nav-list-item"><a href="/roadmap.html"
           class="nav-list-link">Roadmap</a></li><li
            class="nav-list-item"><a href="/commitment.html"
           class="nav-list-link">Commitment to OSS</a></li><li
            class="nav-list-item"><a href="/contributing.html"
           class="nav-list-link">Contributing</a></li><li
            class="nav-list-item"><a href="/faq.html"
           class="nav-list-link">FAQ</a></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/cloud-registration/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                lakeFS Cloud
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/cloud-registration/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                lakeFS Cloud
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/reference/">Reference</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Hooks</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                <h1 class="no_toc" id="hooks">
  
  
    <a href="#hooks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hooks
  
  
</h1>
    

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#example-use-cases" id="markdown-toc-example-use-cases">Example use cases</a></li>
  <li><a href="#terminology" id="markdown-toc-terminology">Terminology</a></li>
  <li><a href="#uploading-action-files" id="markdown-toc-uploading-action-files">Uploading Action files</a></li>
  <li><a href="#runs-api--cli" id="markdown-toc-runs-api--cli">Runs API &amp; CLI</a></li>
  <li><a href="#hook-types" id="markdown-toc-hook-types">Hook types</a>    <ol>
      <li><a href="#webhooks" id="markdown-toc-webhooks">Webhooks</a>        <ol>
          <li><a href="#action-file-webhook-properties" id="markdown-toc-action-file-webhook-properties">Action file Webhook properties</a></li>
          <li><a href="#request-body-schema" id="markdown-toc-request-body-schema">Request body schema</a></li>
        </ol>
      </li>
      <li><a href="#airflow-hooks" id="markdown-toc-airflow-hooks">Airflow Hooks</a>        <ol>
          <li><a href="#action-file-airflow-hook-properties" id="markdown-toc-action-file-airflow-hook-properties">Action file Airflow hook properties</a></li>
          <li><a href="#hook-record-in-configuration-field" id="markdown-toc-hook-record-in-configuration-field">Hook Record in configuration field</a></li>
        </ol>
      </li>
      <li><a href="#lua-hooks-experimental" id="markdown-toc-lua-hooks-experimental">Lua Hooks <span class="label">Experimental</span></a></li>
    </ol>
  </li>
</ol>

</div>

<p>Like other version control systems, lakeFS allows you to configure <code class="language-plaintext highlighter-rouge">Actions</code> to trigger when predefined events occur.</p>

<p>Supported Events:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Event</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pre-commit</code></td>
      <td>Runs when the commit occurs, before the commit is finalized</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">post-commit</code></td>
      <td>Runs after the commit is finalized</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pre-merge</code></td>
      <td>Runs on the source branch when the merge occurs, before the merge is finalized</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">post-merge</code></td>
      <td>Runs on the merge result, after the merge is finalized</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pre-create-branch</code></td>
      <td>Runs on the source branch prior to creating a new branch</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">post-create-branch</code></td>
      <td>Runs on the new branch after the branch was created</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pre-delete-branch</code></td>
      <td>Runs prior to deleting a branch</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">post-delete-branch</code></td>
      <td>Runs after the branch was deleted</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pre-create-tag</code></td>
      <td>Runs prior to creating a new tag</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">post-create-tag</code></td>
      <td>Runs after the tag was created</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pre-delete-tag</code></td>
      <td>Runs prior to deleting a tag</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">post-delete-tag</code></td>
      <td>Runs after the tag was deleted</td>
    </tr>
  </tbody>
</table></div>

<p>lakeFS Actions are handled per repository and cannot be shared between repositories.
A failure of any Hook under any Action of a <code class="language-plaintext highlighter-rouge">pre-*</code> event will result in aborting the lakeFS operation that is taking place.
Hook failures under any Action of a <code class="language-plaintext highlighter-rouge">post-*</code> event will not revert the operation.</p>

<p>Hooks are managed by Action files that are written to a prefix in the lakeFS repository.
This allows configuration-as-code inside lakeFS, where Action files are declarative and written in YAML.</p>
<h2 id="example-use-cases">
  
  
    <a href="#example-use-cases" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example use cases
  
  
</h2>
    

<ol>
  <li>Format Validator:
A webhook that checks new files to ensure they are of a set of allowed data format.</li>
  <li>Schema Validator:
A webhook that reads new Parquet and ORC files to ensure they don’t contain a block list of column names (or name prefixes).
This is useful for avoiding accidental PII exposure.</li>
  <li>Integration with external systems:
Post-merge and post-commit hooks could be used to export metadata about the change to another system. A common example is exporting <code class="language-plaintext highlighter-rouge">symlink.txt</code> files that allow e.g. <a href="/integrations/athena.html">AWS Athena</a> to read data from lakeFS.</li>
  <li>Notifying downstream consumers:
Running a post-merge hook to trigger an Airflow DAG or to send a Webhook to an API, notifying it of the change that happened</li>
</ol>

<p>For more examples and configuration samples, check out the <a href="https://github.com/treeverse/lakeFS/tree/master/examples/hooks">examples</a> on the lakeFS repository.</p>
<h2 id="terminology">
  
  
    <a href="#terminology" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Terminology
  
  
</h2>
    
<h3 class="no_toc" id="action">
  
  
    <a href="#action" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Action
  
  
</h3>
    

<p>An <strong>Action</strong> is a list of Hooks with the same trigger configuration, i.e. an event will trigger all Hooks under an Action or none at all.
The Hooks under an Action are ordered and so is their execution. A Hook will only be executed if all the previous Hooks that were triggered with it had passed.</p>
<h3 class="no_toc" id="hook">
  
  
    <a href="#hook" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hook
  
  
</h3>
    

<p>A <strong>Hook</strong> is the basic building block of an Action.
The failure of a single Hook will stop the execution of the containing Action and fail the Run.</p>
<h3 class="no_toc" id="action-file">
  
  
    <a href="#action-file" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Action file
  
  
</h3>
    

<p>Schema of the Action file:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>Data Type</th>
      <th>Required</th>
      <th>Default Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td>Identify the Action file</td>
      <td>String</td>
      <td>false</td>
      <td>If missing, filename is used instead</td>
    </tr>
    <tr>
      <td>on</td>
      <td>List of events that will trigger the hooks</td>
      <td>List</td>
      <td>true</td>
      <td> </td>
    </tr>
    <tr>
      <td>on<event>.branches</event></td>
      <td>Glob pattern list of branches that triggers the hooks</td>
      <td>List</td>
      <td>false</td>
      <td><strong>Not applicable to Tag events.</strong> If empty, Action runs on all branches</td>
    </tr>
    <tr>
      <td>hooks</td>
      <td>List of hooks to be executed</td>
      <td>List</td>
      <td>true</td>
      <td> </td>
    </tr>
    <tr>
      <td>hook.id</td>
      <td>ID of the hook, must be unique within the <code class="language-plaintext highlighter-rouge">Action</code></td>
      <td>String</td>
      <td>true</td>
      <td> </td>
    </tr>
    <tr>
      <td>hook.type</td>
      <td>Type of the hook (<a href="#hook-types">types</a>)</td>
      <td>String</td>
      <td>true</td>
      <td> </td>
    </tr>
    <tr>
      <td>hook.properties</td>
      <td>Hook’s specific configuration</td>
      <td>Dictionary</td>
      <td>true</td>
      <td> </td>
    </tr>
  </tbody>
</table></div>

<p>Example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Good files check</span>
<span class="na">description</span><span class="pi">:</span> <span class="s">set of checks to verify that branch is good</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">pre-commit</span><span class="pi">:</span>
  <span class="na">pre-merge</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">main</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">no_temp</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">webhook</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">checking no temporary files found</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://your.domain.io/webhook?notmp=true?t=1za2PbkZK1bd4prMuTDr6BeEQwWYcX2R"</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">no_freeze</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">webhook</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">check production is not in dev freeze</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://your.domain.io/webhook?nofreeze=true?t=1za2PbkZK1bd4prMuTDr6BeEQwWYcX2R"</span>
</code></pre></div></div>

<p class="note"><strong>Note:</strong> lakeFS will validate action files only when an <strong>Event</strong> has occurred. <br />
Use <code class="language-plaintext highlighter-rouge">lakectl actions validate &lt;path&gt;</code> to validate your action files locally.</p>
<h3 class="no_toc" id="run">
  
  
    <a href="#run" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Run
  
  
</h3>
    

<p>A <strong>Run</strong> is an instantiation of the repository’s Action files when the triggering event occurs.
For example, if your repository contains a pre-commit hook, every commit would generate a Run for that specific commit.</p>

<p>lakeFS will fetch, parse and filter the repository Action files and start to execute the Hooks under each Action.
All executed Hooks (each with <code class="language-plaintext highlighter-rouge">hook_run_id</code>) exist in the context of that Run (<code class="language-plaintext highlighter-rouge">run_id</code>).</p><hr />
<h2 id="uploading-action-files">
  
  
    <a href="#uploading-action-files" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Uploading Action files
  
  
</h2>
    

<p>Action files should be uploaded with the prefix <code class="language-plaintext highlighter-rouge">_lakefs_actions/</code> to the lakeFS repository.
When an actionable event (see Supported Events above) takes place, lakeFS will read all files with prefix <code class="language-plaintext highlighter-rouge">_lakefs_actions/</code>
in the repository branch where the action occurred.
A failure to parse an Action file will result with a failing Run.</p>

<p>For example, lakeFS will search and execute all the matching Action files with the prefix <code class="language-plaintext highlighter-rouge">lakefs://example-repo/feature-1/_lakefs_actions/</code> on:</p>
<ol>
  <li>Commit to <code class="language-plaintext highlighter-rouge">feature-1</code> branch on <code class="language-plaintext highlighter-rouge">example-repo</code> repository.</li>
  <li>Merge to <code class="language-plaintext highlighter-rouge">main</code> branch from <code class="language-plaintext highlighter-rouge">feature-1</code> branch on <code class="language-plaintext highlighter-rouge">repo1</code> repository.</li>
</ol>
<h2 id="runs-api--cli">
  
  
    <a href="#runs-api--cli" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Runs API &amp; CLI
  
  
</h2>
    

<p>The <a href="/reference/api.html">lakeFS API</a> and <a href="/reference/cli.html#lakectl-actions">lakectl</a> expose the results of executions per repository, branch, commit, and specific Action.
The endpoint also allows to download the execution log of any executed Hook under each Run for observability.</p>
<h3 class="no_toc" id="result-files">
  
  
    <a href="#result-files" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Result Files
  
  
</h3>
    

<p>The metadata section of lakeFS repository with each Run contains two types of files:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">_lakefs/actions/log/&lt;runID&gt;/&lt;hookRunID&gt;.log</code> - Execution log of the specific Hook run.</li>
  <li><code class="language-plaintext highlighter-rouge">_lakefs/actions/log/&lt;runID&gt;/run.manifest</code> - Manifest with all Hooks execution for the run with their results and additional metadata.</li>
</ol>

<p class="note"><strong>Note:</strong> Metadata section of a lakeFS repository is where lakeFS keeps its metadata, like commits and metaranges.
Metadata files stored in the metadata section aren’t accessible like user stored files.</p><hr />
<h2 id="hook-types">
  
  
    <a href="#hook-types" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hook types
  
  
</h2>
    

<p>Currently, there are two types of Hooks that are supported by lakeFS: <a href="#webhooks">Webhook</a> and <a href="#airflow-hooks">Airflow</a>.
Experimental support for <a href="#lua-hooks-experimental">Lua</a> was introduced in lakeFS 0.86.0.</p>
<h3 id="webhooks">
  
  
    <a href="#webhooks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Webhooks
  
  
</h3>
    

<p>A Webhook is a Hook type that sends an HTTP POST request to the configured URL.
Any non 2XX response by the responding endpoint will fail the Hook, cancel the execution of the following Hooks
under the same Action. For <code class="language-plaintext highlighter-rouge">pre-*</code> hooks, the triggering operation will also be aborted.</p>

<p class="note"><strong>Warning:</strong> You should not use <code class="language-plaintext highlighter-rouge">pre-*</code> webhooks for long-running tasks, since they block the performed operation.
Moreover, the branch is locked during the execution of <code class="language-plaintext highlighter-rouge">pre-*</code> hooks, so the webhook server cannot perform any write operations on the branch (like uploading or commits).</p>
<h4 id="action-file-webhook-properties">
  
  
    <a href="#action-file-webhook-properties" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Action file Webhook properties
  
  
</h4>
    

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>Data Type</th>
      <th>Required</th>
      <th>Default Value</th>
      <th>Env Vars Support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>url</td>
      <td>The URL address of the request</td>
      <td>String</td>
      <td>true</td>
      <td> </td>
      <td>no</td>
    </tr>
    <tr>
      <td>timeout</td>
      <td>Time to wait for response before failing the hook</td>
      <td>String (golang’s <a href="https://golang.org/pkg/time/#Duration.String">Duration</a> representation)</td>
      <td>false</td>
      <td>1 minute</td>
      <td>no</td>
    </tr>
    <tr>
      <td>query_params</td>
      <td>List of query params that will be added to the request</td>
      <td>Dictionary(String:String or String:List(String)</td>
      <td>false</td>
      <td> </td>
      <td>yes</td>
    </tr>
    <tr>
      <td>headers</td>
      <td>Headers to add to the request</td>
      <td>Dictionary(String:String)</td>
      <td>false</td>
      <td> </td>
      <td>yes</td>
    </tr>
  </tbody>
</table></div>

<p class="note"><strong>Secrets &amp; Environment Variables</strong><br />
lakeFS Actions supports secrets by using environment variables.
The format <code class="language-plaintext highlighter-rouge">{{ ENV.SOME_ENV_VAR }}</code> will be replaced with the value of <code class="language-plaintext highlighter-rouge">$SOME_ENV_VAR</code>
during the execution of the action. If that environment variable doesn’t exist in the lakeFS server environment, the action run will fail.</p>

<p>Example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">...</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">prevent_user_columns</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">webhook</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Ensure no user_* columns under public/</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://&lt;host:port&gt;/webhooks/schema"</span>
      <span class="na">timeout</span><span class="pi">:</span> <span class="s">1m30s</span>
      <span class="na">query_params</span><span class="pi">:</span>
        <span class="na">disallow</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">user_"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">private_"</span><span class="pi">]</span>
        <span class="na">prefix</span><span class="pi">:</span> <span class="s">public/</span>
      <span class="na">headers</span><span class="pi">:</span>
        <span class="na">secret_header</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">ENV.MY_SECRET</span><span class="nv"> </span><span class="s">}}"</span>
<span class="nn">...</span>
</code></pre></div></div>
<h4 id="request-body-schema">
  
  
    <a href="#request-body-schema" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Request body schema
  
  
</h4>
    
<p>Upon execution, a webhook will send a request containing a JSON object with the following fields:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>event_type</td>
      <td>Type of the event that triggered the <code class="language-plaintext highlighter-rouge">Action</code></td>
      <td>string</td>
    </tr>
    <tr>
      <td>event_time</td>
      <td>Time of the event that triggered the <code class="language-plaintext highlighter-rouge">Action</code> (RFC3339 formatted)</td>
      <td>string</td>
    </tr>
    <tr>
      <td>action_name</td>
      <td>Containing <code class="language-plaintext highlighter-rouge">Hook</code> Action’s Name</td>
      <td>string</td>
    </tr>
    <tr>
      <td>hook_id</td>
      <td>ID of the <code class="language-plaintext highlighter-rouge">Hook</code></td>
      <td>string</td>
    </tr>
    <tr>
      <td>repository_id</td>
      <td>ID of the Repository</td>
      <td>string</td>
    </tr>
    <tr>
      <td>branch_id<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup></td>
      <td>ID of the Branch</td>
      <td>string</td>
    </tr>
    <tr>
      <td>source_ref</td>
      <td>Reference to the source on which the event was triggered</td>
      <td>string</td>
    </tr>
    <tr>
      <td>commit_message<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup></td>
      <td>The message for the commit (or merge) that is taking place</td>
      <td>string</td>
    </tr>
    <tr>
      <td>committer<sup id="fnref:2:1" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup></td>
      <td>Name of the committer</td>
      <td>string</td>
    </tr>
    <tr>
      <td>commit_metadata<sup id="fnref:2:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup></td>
      <td>The metadata for the commit that is taking place</td>
      <td>string</td>
    </tr>
    <tr>
      <td>tag_id<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup></td>
      <td>The ID of the created/deleted tag</td>
      <td>string</td>
    </tr>
  </tbody>
</table></div>

<p>Example:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"event_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pre-merge"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"event_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-02-28T14:03:31Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"action_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test action"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"hook_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prevent_user_columns"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"repository_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"repo1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"branch_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"feature-1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"source_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"feature-1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"commit_message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"merge commit message"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"committer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"committer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"commit_metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<h3 id="airflow-hooks">
  
  
    <a href="#airflow-hooks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Airflow Hooks
  
  
</h3>
    

<p>Airflow Hook triggers a DAG run in an Airflow installation using <a href="https://airflow.apache.org/docs/apache-airflow/stable/stable-rest-api-ref.html#operation/post_dag_run">Airflow’s REST API</a>.
The hook run succeeds if the DAG was triggered, and fails otherwise.</p>
<h4 id="action-file-airflow-hook-properties">
  
  
    <a href="#action-file-airflow-hook-properties" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Action file Airflow hook properties
  
  
</h4>
    

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Description</th>
      <th>Data Type</th>
      <th>Example</th>
      <th>Required</th>
      <th>Env Vars Support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>url</td>
      <td>The URL of the Airflow instance</td>
      <td>String</td>
      <td>“http://localhost:8080”</td>
      <td>true</td>
      <td>no</td>
    </tr>
    <tr>
      <td>dag_id</td>
      <td>The DAG to trigger</td>
      <td>String</td>
      <td>“example_dag”</td>
      <td>true</td>
      <td>no</td>
    </tr>
    <tr>
      <td>username</td>
      <td>The name of the Airflow user performing the request</td>
      <td>String</td>
      <td>“admin”</td>
      <td>true</td>
      <td>no</td>
    </tr>
    <tr>
      <td>password</td>
      <td>The password of the Airflow user performing the request</td>
      <td>String</td>
      <td>“admin”</td>
      <td>true</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>dag_conf</td>
      <td>DAG run configuration that will be passed as is</td>
      <td>JSON</td>
      <td> </td>
      <td>false</td>
      <td>no</td>
    </tr>
    <tr>
      <td>wait_for_dag</td>
      <td>Wait for DAG run to complete and reflect state (default: false)</td>
      <td>Boolean</td>
      <td> </td>
      <td>false</td>
      <td>no</td>
    </tr>
    <tr>
      <td>timeout</td>
      <td>Time to wait for the DAG run to complete (default: 1m)</td>
      <td>String (golang’s <a href="https://golang.org/pkg/time/#Duration.String">Duration</a> representation)</td>
      <td> </td>
      <td>false</td>
      <td>no</td>
    </tr>
  </tbody>
</table></div>

<p>Example:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">...</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">trigger_my_dag</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">airflow</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Trigger an example_dag</span>
    <span class="na">properties</span><span class="pi">:</span>
       <span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://localhost:8000"</span>
       <span class="na">dag_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">example_dag"</span>
       <span class="na">username</span><span class="pi">:</span> <span class="s2">"</span><span class="s">admin"</span>
       <span class="na">password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">ENV.AIRFLOW_SECRET</span><span class="nv"> </span><span class="s">}}"</span>
       <span class="na">dag_conf</span><span class="pi">:</span>
          <span class="na">some</span><span class="pi">:</span> <span class="s2">"</span><span class="s">additional_conf"</span>
<span class="nn">...</span>
</code></pre></div></div>
<h4 id="hook-record-in-configuration-field">
  
  
    <a href="#hook-record-in-configuration-field" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hook Record in configuration field
  
  
</h4>
    

<p>lakeFS will add an entry to the Airflow request configuration property (<code class="language-plaintext highlighter-rouge">conf</code>) with the event that triggered the action.</p>

<p>The key of the record will be <code class="language-plaintext highlighter-rouge">lakeFS_event</code> and the value will match the one described <a href="#request-body-schema">here</a></p>
<h3 id="lua-hooks-experimental">
  
  
    <a href="#lua-hooks-experimental" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lua Hooks <span class="label">Experimental</span>
  
  
</h3>
    

<p>As of version 0.86.0, lakeFS supports running hooks without relying on external components using an <a href="https://github.com/Shopify/go-lua">embedded Lua VM</a></p>

<p>Using Lua hooks, it is possible to pass a Lua script to be executed directly by the lakeFS server when an action occurs.</p>

<p>The Lua runtime embedded in lakeFS is limited for security reasons. It provides a narrow set of APIs and functions that by default do not allow:</p>

<ol>
  <li>Accessing any of the running lakeFS server’s environment</li>
  <li>Accessing the local filesystem available the lakeFS process</li>
</ol>
<h4 class="no_toc" id="example-of-a-lua-hook">
  
  
    <a href="#example-of-a-lua-hook" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example of a Lua hook:
  
  
</h4>
    

<p>This example will simply print out a JSON representation of the event that occurred:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">dump_all</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">post-commit</span><span class="pi">:</span>
  <span class="na">post-merge</span><span class="pi">:</span>
  <span class="na">post-create-tag</span><span class="pi">:</span>
  <span class="na">post-create-branch</span><span class="pi">:</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">dump_event</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">json = require("encoding/json")</span>
        <span class="s">print(json.marshal(action))</span>
</code></pre></div></div>

<p>A more useful example: ensure every commit contains a required metadata field:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">pre commit metadata field check</span>
<span class="na">on</span><span class="pi">:</span>
<span class="na">pre-commit</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">main</span>
    <span class="pi">-</span> <span class="s">dev</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">ensure_commit_metadata</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">args</span><span class="pi">:</span>
        <span class="na">notebook_url</span><span class="pi">:</span> <span class="pi">{</span><span class="s2">"</span><span class="s">pattern"</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my-jupyter.example.com/.*"</span><span class="pi">}</span>
        <span class="na">spark_version</span><span class="pi">:</span>  <span class="pi">{}</span>
      <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">regexp = require("regexp")</span>
        <span class="s">for k, props in pairs(args) do</span>
          <span class="s">current_value = action.commit.metadata[k]</span>
          <span class="s">if current_value == nil then</span>
            <span class="s">error("missing mandatory metadata field: " .. k)</span>
          <span class="s">end</span>
          <span class="s">if props.pattern and not regexp.match(props.pattern, current_value) then</span>
            <span class="s">error("current value for commit metadata field " .. k .. " does not match pattern: " .. props.pattern .. " - got: " .. current_value)</span>
          <span class="s">end</span>
        <span class="s">end</span>
</code></pre></div></div>

<p>For more examples and configuration samples, check out the <a href="https://github.com/treeverse/lakeFS/tree/master/examples/hooks">examples/hooks/</a> directory in the lakeFS repository.</p>

<p class="note">For the full set of exposed Lua APIs, usage and reasoning is available on the <a href="https://github.com/treeverse/lakeFS/blob/master/design/open/zero-deployment-hooks.md">proposal document</a></p><hr />
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>N\A for Tag events <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>N\A for Tag and Create/Delete Branch events <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:2:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a> <a href="#fnref:2:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p>Applicable only for Tag events <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

                

                
                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <a href="https://lakefs.io" class="site-title lh-tight">
                <div class="site-logo"></div>
            </a>
        </div>
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/assets/icons/github.svg" class="no-hover" />
                            <img src="/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/assets/icons/slack.svg" class="no-hover" />
                            <img src="/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left"><a href="https://www.treeverse.io/">
                    <div class="other-logo"><img src="/assets/by-treeverse.png" /></div>
                </a></div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>


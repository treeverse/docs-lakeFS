

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/v1.59/assets/css/just-the-docs-default.css">
  
  <style type="text/css">
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(10) > .nav-list > .nav-list-item:nth-child(5) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #ebedf5 0%, rgba(235, 237, 245, 0.8) 80%, rgba(235, 237, 245, 0) 100%); }

.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(10) > .nav-list-expander svg, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(10) > .nav-list > .nav-list-item:not(.passive):nth-child(5) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(10) > .nav-list, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(10) > .nav-list > .nav-list-item:not(.passive):nth-child(5) > .nav-list { display: block; }

.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list { display: block; }

</style>


  

  
    <script src="/v1.59/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/v1.59/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/v1.59/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Login to lakeFS with AWS IAM Roles | lakeFS Documentation</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Login to lakeFS with AWS IAM Roles" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This section covers how to authenticate to lakeFS using AWS IAM." />
<meta property="og:description" content="This section covers how to authenticate to lakeFS using AWS IAM." />
<meta property="og:site_name" content="lakeFS Documentation" />
<meta property="og:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="twitter:title" content="Login to lakeFS with AWS IAM Roles" />
<meta name="twitter:site" content="@lakeFS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"This section covers how to authenticate to lakeFS using AWS IAM.","headline":"Login to lakeFS with AWS IAM Roles","image":"https://docs.lakefs.io/assets/img/docs_logo.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/v1.59/assets/logo.svg"}},"url":"/v1.59/security/external-principals-aws.html"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<!-- type="text/plain" is intentional for cookie consent support -->
<script type="text/plain" data-category="analytics">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->

<meta name="robots" content="noindex">

<meta property="og:image" content="/v1.59/assets/img/lakefs-logo-with-text.png">
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<link rel="stylesheet" href="/v1.59/assets/css/cookieconsent.css" />
<script type="module" src="/v1.59/assets/js/cookieconsent-init.js"></script>
<script src="/v1.59/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/v1.59/assets/js/feedback.js"></script>


</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<img src="/assets/img/cookies.png" style="display: none;">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="lakeFS Documentation"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS Documentation" aria-label="Search lakeFS Documentation"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/v1.59/"
           class="nav-list-link">Welcome to lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/quickstart/"
           class="nav-list-link">⭐ Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.59/quickstart/launch.html"
                   class="nav-list-link">1️⃣ Run lakeFS</a></li><li class="nav-list-item "><a href="/v1.59/quickstart/query.html"
                   class="nav-list-link">2️⃣ Query the data</a></li><li class="nav-list-item "><a href="/v1.59/quickstart/branch.html"
                   class="nav-list-link">3️⃣ Create a branch</a></li><li class="nav-list-item "><a href="/v1.59/quickstart/commit-and-merge.html"
                   class="nav-list-link">4️⃣ Commit and Merge</a></li><li class="nav-list-item "><a href="/v1.59/quickstart/rollback.html"
                   class="nav-list-link">5️⃣ Roll back Changes</a></li><li class="nav-list-item "><a href="/v1.59/quickstart/actions-and-hooks.html"
                   class="nav-list-link">6️⃣ Using Actions and Hooks in lakeFS</a></li><li class="nav-list-item "><a href="/v1.59/quickstart/work-with-data-locally.html"
                   class="nav-list-link">7️⃣ Work with lakeFS data locally</a></li><li class="nav-list-item "><a href="/v1.59/quickstart/learning-more-lakefs.html"
                   class="nav-list-link">Learn more about lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/howto/deploy/"
                   class="nav-list-link">Install lakeFS</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/howto/deploy/aws.html"
                           class="nav-list-link">AWS</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/deploy/azure.html"
                           class="nav-list-link">Azure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/deploy/gcp.html"
                           class="nav-list-link">GCP</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/deploy/onprem.html"
                           class="nav-list-link">On-Premises</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/deploy/upgrade.html"
                           class="nav-list-link">Upgrade lakeFS</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/howto/hooks/"
                   class="nav-list-link">Actions and Hooks</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/howto/hooks/airflow.html"
                           class="nav-list-link">Airflow Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/hooks/lua.html"
                           class="nav-list-link">Lua Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/hooks/webhooks.html"
                           class="nav-list-link">Webhooks</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.59/howto/lakefs-tables.html"
                   class="nav-list-link">lakeFS Tables<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/howto/backup-and-restore.html"
                   class="nav-list-link">Backup and Restore Repository</a></li><li class="nav-list-item "><a href="/v1.59/howto/protect-branches.html"
                   class="nav-list-link">Branch Protection</a></li><li class="nav-list-item "><a href="/v1.59/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/v1.59/howto/catalog_exports.html"
                   class="nav-list-link">Data Catalogs Exports</a></li><li class="nav-list-item "><a href="/v1.59/howto/export.html"
                   class="nav-list-link">Export Data</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/howto/garbage-collection/"
                   class="nav-list-link">Garbage Collection</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/howto/garbage-collection/gc.html"
                           class="nav-list-link">Garbage Collection</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/garbage-collection/managed-gc.html"
                           class="nav-list-link">Managed Garbage Collection<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/howto/garbage-collection/standalone-gc.html"
                           class="nav-list-link">Standalone Garbage Collection<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.59/howto/import.html"
                   class="nav-list-link">Import Data</a></li><li class="nav-list-item "><a href="/v1.59/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/v1.59/howto/mirroring.html"
                   class="nav-list-link">Mirroring<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/howto/multiple-storage-backends.html"
                   class="nav-list-link">Multiple Storage Backend<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/howto/private-link.html"
                   class="nav-list-link">Private Link</a></li><li class="nav-list-item "><a href="/v1.59/howto/pull-requests.html"
                   class="nav-list-link">Pull Requests</a></li><li class="nav-list-item "><a href="/v1.59/howto/virtual-host-addressing.html"
                   class="nav-list-link">S3 Virtual-host addressing (advanced)</a></li><li class="nav-list-item "><a href="/v1.59/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li><li class="nav-list-item "><a href="/v1.59/howto/scim.html"
                   class="nav-list-link">System for Cross-domain Identity Management (SCIM)<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/howto/local-checkouts.html"
                   class="nav-list-link">Work with lakeFS data locally</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.59/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/v1.59/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/v1.59/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/v1.59/integrations/sagemaker.html"
                   class="nav-list-link">Amazon SageMaker</a></li><li class="nav-list-item "><a href="/v1.59/integrations/airflow.html"
                   class="nav-list-link">Apache Airflow</a></li><li class="nav-list-item "><a href="/v1.59/integrations/hive.html"
                   class="nav-list-link">Apache Hive</a></li><li class="nav-list-item "><a href="/v1.59/integrations/iceberg.html"
                   class="nav-list-link">Apache Iceberg</a></li><li class="nav-list-item "><a href="/v1.59/integrations/kafka.html"
                   class="nav-list-link">Apache Kafka</a></li><li class="nav-list-item "><a href="/v1.59/integrations/spark.html"
                   class="nav-list-link">Apache Spark</a></li><li class="nav-list-item "><a href="/v1.59/integrations/cloudera.html"
                   class="nav-list-link">Cloudera</a></li><li class="nav-list-item "><a href="/v1.59/integrations/databricks.html"
                   class="nav-list-link">Databricks</a></li><li class="nav-list-item "><a href="/v1.59/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/v1.59/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/v1.59/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/v1.59/integrations/git.html"
                   class="nav-list-link">Git</a></li><li class="nav-list-item "><a href="/v1.59/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/v1.59/integrations/glue_metastore.html"
                   class="nav-list-link">Glue Data Catalog</a></li><li class="nav-list-item "><a href="/v1.59/integrations/huggingface_datasets.html"
                   class="nav-list-link">HuggingFace Datasets</a></li><li class="nav-list-item "><a href="/v1.59/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/v1.59/integrations/mlflow.html"
                   class="nav-list-link">MLflow</a></li><li class="nav-list-item "><a href="/v1.59/integrations/presto_trino.html"
                   class="nav-list-link">Presto / Trino</a></li><li class="nav-list-item "><a href="/v1.59/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/v1.59/integrations/r.html"
                   class="nav-list-link">R</a></li><li class="nav-list-item "><a href="/v1.59/integrations/red_hat_openshift_ai.html"
                   class="nav-list-link">Red Hat OpenShift AI</a></li><li class="nav-list-item "><a href="/v1.59/integrations/unity-catalog.html"
                   class="nav-list-link">Unity Catalog</a></li><li class="nav-list-item "><a href="/v1.59/integrations/vertex_ai.html"
                   class="nav-list-link">Vertex AI</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.59/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/v1.59/understand/model.html"
                   class="nav-list-link">Concepts and  Model</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.59/understand/data-structure.html"
                   class="nav-list-link">Data Structure</a></li><li class="nav-list-item "><a href="/v1.59/understand/faq.html"
                   class="nav-list-link">FAQ</a></li><li class="nav-list-item "><a href="/v1.59/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/understand/how/"
                   class="nav-list-link">How lakeFS Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.59/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/understand/use_cases/"
                   class="nav-list-link">Use Cases</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/understand/use_cases/cicd_for_data.html"
                           class="nav-list-link">CI/CD for Data Lakes</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/understand/use_cases/etl_testing.html"
                           class="nav-list-link">ETL Testing Environment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/understand/use_cases/reproducibility.html"
                           class="nav-list-link">Reproducibility</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/understand/use_cases/rollback.html"
                           class="nav-list-link">Rollback</a>
                    </li></ul></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/reference/mount.html"
                   class="nav-list-link">Mount<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/reference/mount-csi-driver.html"
                           class="nav-list-link">Mount CSI Driver</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/reference/mount-write-mode-semantics.html"
                           class="nav-list-link">Mount Write Mode Semantics</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.59/reference/auditing.html"
                   class="nav-list-link">Auditing<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/v1.59/reference/s3.html"
                   class="nav-list-link">S3 Gateway API</a></li><li class="nav-list-item "><a href="/v1.59/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/v1.59/reference/api.html"
                   class="nav-list-link">lakeFS API</a></li><li class="nav-list-item "><a href="/v1.59/reference/configuration.html"
                   class="nav-list-link">lakeFS Server Configuration</a></li><li class="nav-list-item "><a href="/v1.59/reference/cli.html"
                   class="nav-list-link">lakectl (lakeFS command-line tool)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/project/"
           class="nav-list-link">The lakeFS Project</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.59/project/contributing.html"
                   class="nav-list-link">Contributing to lakeFS</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/project/docs/"
                   class="nav-list-link">Documentation</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/project/docs/callouts.html"
                           class="nav-list-link">Callouts</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.59/project/code-migrate-1.0-sdk.html"
                   class="nav-list-link">Migrating to 1.0</a></li></ul></li><li
            class="nav-list-item"><a href="/v1.59/cloud/"
           class="nav-list-link">lakeFS Cloud</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/enterprise/"
           class="nav-list-link">lakeFS Enterprise</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.59/enterprise/getstarted/"
                   class="nav-list-link">Get Started</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.59/enterprise/getstarted/quickstart.html"
                           class="nav-list-link">Quickstart</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/enterprise/getstarted/install.html"
                           class="nav-list-link">Install</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.59/enterprise/getstarted/migrate-from-oss.html"
                           class="nav-list-link">Migrate from lakeFS OSS</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.59/enterprise/upgrade.html"
                   class="nav-list-link">Upgrade</a></li><li class="nav-list-item "><a href="/v1.59/enterprise/troubleshooting.html"
                   class="nav-list-link">Troubleshooting lakeFS Enterprise</a></li><li class="nav-list-item "><a href="/v1.59/enterprise/configuration.html"
                   class="nav-list-link">Configuration Reference</a></li><li class="nav-list-item "><a href="/v1.59/enterprise/architecture.html"
                   class="nav-list-link">Architecture</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.59/security/"
           class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.59/security/ACL-server-implementation.html"
                   class="nav-list-link">ACL Server Implementation</a></li><li class="nav-list-item "><a href="/v1.59/security/access-control-lists.html"
                   class="nav-list-link">Access Control Lists (ACLs) -Deprecated-</a></li><li class="nav-list-item "><a href="/v1.59/security/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/v1.59/security/authorization-yaml.html"
                   class="nav-list-link">Authorization API</a></li><li class="nav-list-item  active"><a href="/v1.59/security/external-principals-aws.html"
                   class="nav-list-link active">Login to lakeFS with AWS IAM Roles<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/security/presigned-url.html"
                   class="nav-list-link">Presigned URLs</a></li><li class="nav-list-item "><a href="/v1.59/security/remote-authenticator.html"
                   class="nav-list-link">Remote Authenticator</a></li><li class="nav-list-item "><a href="/v1.59/security/rbac.html"
                   class="nav-list-link">Role-Based Access Control (RBAC)<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/security/sts-login.html"
                   class="nav-list-link">Short-lived token (STS like) Authentication for lakeFS<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.59/security/sso.html"
                   class="nav-list-link">Single Sign On (SSO)<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li></ul></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/v1.59/security/">Security</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Login to lakeFS with AWS IAM Roles</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 class="d-inline-block" id="authenticate-to-lakefs-with-aws-iam-roles">
  
  
    <a href="#authenticate-to-lakefs-with-aws-iam-roles" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Authenticate to lakeFS with AWS IAM Roles
  
  
</h1>
    

<p class="label label-purple">lakeFS Enterprise</p>

<blockquote class="note">
  <p>External principals API is available for lakeFS Enterprise. If you’re using the open-source version you can check the <a href="https://docs.lakefs.io/security/rbac.html#pluggable-authentication-and-authorization">pluggable APIs</a>.</p>
</blockquote>

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#server-configuration" id="markdown-toc-server-configuration">Server Configuration</a></li>
  <li><a href="#administration-of-iam-roles-in-lakefs" id="markdown-toc-administration-of-iam-roles-in-lakefs">Administration of IAM Roles in lakeFS</a></li>
  <li><a href="#get-lakefs-api-token" id="markdown-toc-get-lakefs-api-token">Get lakeFS API Token</a></li>
  <li><a href="#login-with-python" id="markdown-toc-login-with-python">Login with python</a></li>
</ol>

</div>
<h2 id="overview">
  
  
    <a href="#overview" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview
  
  
</h2>
    

<p>lakeFS supports authenticating users programmatically using AWS IAM roles instead of using static lakeFS access and secret keys.
The method enables you to bound IAM principal ARNs to lakeFS users.
A single lakeFS user may have many AWS’s principle ARNs attached to it. When a client is authenticating to a lakeFS server with an AWS’s session, the actions performed by the client are on behalf of the user attached to the ARN.</p>
<h3 id="using-session-names">
  
  
    <a href="#using-session-names" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using Session Names
  
  
</h3>
    

<p>The bound ARN can be attached to a single lakeFS user with or without SessionName, serving different users.
For example, consider the following mapping:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Principal ARN</th>
      <th>lakeFS User</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>arn:aws:sts::123456:assumed-role/Dev</td>
      <td>foo</td>
    </tr>
    <tr>
      <td>arn:aws:sts::123456:assumed-role/Dev/john@acme.com</td>
      <td>john</td>
    </tr>
  </tbody>
</table></div>

<p>if the bound ARN were <code class="language-plaintext highlighter-rouge">arn:aws:sts::123456:assumed-role/Dev/&lt;SessionName&gt;</code> it would allow any principal assuming <code class="language-plaintext highlighter-rouge">Dev</code> role in AWS account <code class="language-plaintext highlighter-rouge">123456</code> to login to it.
If the <code class="language-plaintext highlighter-rouge">SessionName</code> is <code class="language-plaintext highlighter-rouge">john@acme.com</code> then lakeFS would return token for <code class="language-plaintext highlighter-rouge">john</code> user</p>
<h3 id="how-aws-authentication-works">
  
  
    <a href="#how-aws-authentication-works" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How AWS authentication works
  
  
</h3>
    

<p>The AWS STS API includes a method, <code class="language-plaintext highlighter-rouge">sts:GetCallerIdentity</code>, which allows you to validate the identity of a client. The client signs a GetCallerIdentity query using the AWS Signature v4 algorithm and sends it to the lakeFS server.</p>

<p>The <code class="language-plaintext highlighter-rouge">GetCallerIdentity</code> query consists of four pieces of information: the request URL, the request body, the request headers and the request method. The AWS signature is computed over those fields. The lakeFS server reconstructs the query using this information and forwards it on to the AWS STS service. Depending on the response from the STS service, the server authenticates the client.</p>

<p>Notably, clients don’t need network-level access themselves to talk to the AWS STS API endpoint; they merely need access to the credentials to sign the request. However, it means that the lakeFS server does need network-level access to send requests to the STS endpoint.</p>

<p>Each signed AWS request includes the current timestamp to mitigate the risk of replay attacks. In addition, lakeFS allows you to require an additional header, <code class="language-plaintext highlighter-rouge">X-LakeFS-Server-ID</code> (added by default), to be present to mitigate against different types of replay attacks (such as a signed <code class="language-plaintext highlighter-rouge">GetCallerIdentity</code> request stolen from a dev lakeFS instance and used to authenticate to a prod lakeFS instance).</p>

<p>It’s also important to note that Amazon does NOT appear to include any sort of authorization around calls to GetCallerIdentity. For example, if you have an IAM policy on your credential that requires all access to be MFA authenticated, non-MFA authenticated credentials will still be able to authenticate to lakeFS using this method.</p>
<h2 id="server-configuration">
  
  
    <a href="#server-configuration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Server Configuration
  
  
</h2>
    

<blockquote class="note">
  <p>Note: lakeFS Helm chart supports the configuration since version <code class="language-plaintext highlighter-rouge">1.2.11</code> - see usage <a href="https://github.com/treeverse/charts/blob/master/examples/lakefs/enterprise/values-external-aws.yaml">values.yaml example</a>.</p>
</blockquote>

<ul>
  <li>in lakeFS <code class="language-plaintext highlighter-rouge">auth.authentication_api.external_principals_enabled</code> must be set to <code class="language-plaintext highlighter-rouge">true</code> in the configuration file, other configuration (<code class="language-plaintext highlighter-rouge">auth.authentication_api.*</code>) can be found at <a href="/reference/configuration.html">configuration reference</a></li>
</ul>

<p>For the full list of the Fluffy server configuration, see <a href="/enterprise/configuration.html#fluffy-server-configuration">Fluffy Configuration</a> under <code class="language-plaintext highlighter-rouge">auth.external.aws_auth</code></p>

<blockquote class="note">
  <p>By default, lakeFS clients will add the parameter <code class="language-plaintext highlighter-rouge">X-LakeFS-Server-ID: &lt;lakefs.ingress.domain&gt;</code> to the initial <a href="/reference/api.html#auth/externalPrincipalLogin">login request</a> for STS.</p>
</blockquote>

<p><strong>Example configuration with required headers:</strong></p>

<p>Configuration for <code class="language-plaintext highlighter-rouge">lakefs.yaml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">auth</span><span class="pi">:</span>
  <span class="na">authentication_api</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">http://&lt;fluffy-sso&gt;/api/v1</span>
    <span class="na">external_principals_enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">api</span><span class="pi">:</span>
    <span class="na">endpoint</span><span class="pi">:</span> <span class="s">http://&lt;fluffy-rbac&gt;/api/v1</span>
</code></pre></div></div>

<p>Configuration for <code class="language-plaintext highlighter-rouge">fluffy.yaml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># fluffy address for lakefs auth.authentication_api.endpoint</span>
<span class="c1"># used by lakeFS to log in and get the token</span>
<span class="na">listen_address</span><span class="pi">:</span> <span class="s">&lt;fluffy-sso&gt;</span>
<span class="na">auth</span><span class="pi">:</span>
  <span class="c1"># fluffy address for lakeFS auth.api.endpoint </span>
  <span class="c1"># used by lakeFS to manage the lifecycle attach/detach of the external principals</span>
  <span class="na">serve_listen_address</span><span class="pi">:</span> <span class="s">&lt;fluffy-rbac&gt;</span>
  <span class="na">external</span><span class="pi">:</span>
    <span class="na">aws_auth</span><span class="pi">:</span>
      <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
      <span class="c1"># headers that must be present by the client when doing login request</span>
      <span class="na">required_headers</span><span class="pi">:</span>
        <span class="c1"># same host as the lakeFS server ingress</span>
        <span class="na">X-LakeFS-Server-ID</span><span class="pi">:</span> <span class="s">&lt;lakefs.ingress.domain&gt;</span>
</code></pre></div></div>
<h2 id="administration-of-iam-roles-in-lakefs">
  
  
    <a href="#administration-of-iam-roles-in-lakefs" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Administration of IAM Roles in lakeFS
  
  
</h2>
    

<p>Administration refers to the management of the IAM roles that are allowed to authenticate to lakeFS.
Operations such as attaching and detaching IAM roles to a user, listing the roles attached to a user, and listing the users attached to a role. 
Currently, this is done through the lakeFS <a href="/reference/api.html#external">External Principals API</a> and generated clients.</p>

<p>Example of attaching an IAM roles to a user:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lakefs_sdk</span> <span class="k">as</span> <span class="n">lakefs</span>  

<span class="n">configuration</span> <span class="o">=</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">Configuration</span><span class="p">(</span><span class="n">host</span> <span class="o">=</span> <span class="s">"..."</span><span class="p">,</span><span class="n">username</span><span class="o">=</span><span class="s">"..."</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s">"..."</span><span class="p">)</span>
<span class="n">username</span> <span class="o">=</span> <span class="s">"&lt;lakefs-user&gt;"</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">ApiClient</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
<span class="n">auth_api</span> <span class="o">=</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">AuthApi</span><span class="p">(</span><span class="n">api</span><span class="p">)</span>
<span class="c1"># attach the role(s)to a lakeFS user
</span><span class="n">auth_api</span><span class="p">.</span><span class="n">create_user_external_principal</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">principal_id</span><span class="o">=</span><span class="s">'arn:aws:sts::&lt;id&gt;:assumed-role/&lt;role A&gt;/&lt;optional session name&gt;'</span><span class="p">)</span>
<span class="n">auth_api</span><span class="p">.</span><span class="n">create_user_external_principal</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">principal_id</span><span class="o">=</span><span class="s">'arn:aws:sts::&lt;id&gt;:assumed-role/&lt;role B&gt;'</span><span class="p">)</span>
<span class="c1"># list the roles attached to the user
</span><span class="n">resp</span> <span class="o">=</span> <span class="n">auth_api</span><span class="p">.</span><span class="n">list_user_external_principals</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">username</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">.</span><span class="n">results</span><span class="p">:</span>
    <span class="c1"># do something
</span></code></pre></div></div>
<h2 id="get-lakefs-api-token">
  
  
    <a href="#get-lakefs-api-token" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Get lakeFS API Token
  
  
</h2>
    

<p>The login to lakeFS is done by calling the <a href="/reference/api.html#auth/externalPrincipalLogin">login API</a> with the <code class="language-plaintext highlighter-rouge">GetCallerIdentity</code> request signed by the client.
Currently, the login operation is supported out of the box in:</p>
<ul>
  <li><a href="/integrations/spark.html#lakefs-hadoop-filesystem">lakeFS Hadoop FileSystem</a> version 0.2.4, see <a href="/integrations/spark.html#usage-with-temporaryawscredentialslakefstokenprovider">Spark usage</a></li>
  <li><a href="#login-with-python">python</a></li>
  <li><a href="https://docs.lakefs.io/reference/mount.html#authenticating-with-aws-iam-role">Everest mount</a></li>
</ul>

<p>For other use cases authenticate to lakeFS via login endpoint, this will require building the request input.</p>
<h2 id="login-with-python">
  
  
    <a href="#login-with-python" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Login with python
  
  
</h2>
    
<h3 id="prerequisites">
  
  
    <a href="#prerequisites" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> prerequisites
  
  
</h3>
    

<ol>
  <li>lakeFS should be <a href="#server-configuration">configured</a> to allow external principals to authenticate and the used IAM role should be <a href="#administration-of-iam-roles-in-lakefs">attached</a> to the relevant lakeFS user</li>
  <li>The Python SDK requires additional packages to be installed in order to generate a lakeFS client with the assumed role.
To install the required packages, run the following command:</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  pip <span class="nb">install</span> <span class="s2">"lakefs[aws-iam]"</span>
</code></pre></div></div>

<p>There are two ways in which external principals can be used to authenticate to lakeFS:</p>

<ol>
  <li>
    <p>If no other authentication flow is provided, and the <code class="language-plaintext highlighter-rouge">credentials.provider.type</code> configuration is set to <code class="language-plaintext highlighter-rouge">aws_iam</code> in <code class="language-plaintext highlighter-rouge">.lakectl.yaml</code>, the client will use the machine’s AWS role to authenticate with lakeFS:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="na">credentials</span><span class="pi">:</span>
   <span class="na">provider</span><span class="pi">:</span>
     <span class="na">type</span><span class="pi">:</span> <span class="s">aws_iam</span>
     <span class="na">aws_iam</span><span class="pi">:</span>
       <span class="na">token_ttl_seconds</span><span class="pi">:</span> <span class="m">3600</span>            <span class="c1"># TTL for the temporary token (default: 3600)</span>
       <span class="na">url_presign_ttl_seconds</span><span class="pi">:</span> <span class="m">60</span>        <span class="c1"># TTL for presigned URLs (default: 60)</span>
       <span class="na">token_request_headers</span><span class="pi">:</span>             <span class="c1"># Optional headers for token requests</span>
         <span class="na">HeaderName</span><span class="pi">:</span> <span class="s">HeaderValue</span>
</code></pre></div>    </div>
    <p>Or using environment variables:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">export </span><span class="nv">LAKECTL_CREDENTIALS_PROVIDER_TYPE</span><span class="o">=</span><span class="s2">"aws_iam"</span>
 <span class="nb">export </span><span class="nv">LAKECTL_CREDENTIALS_PROVIDER_AWS_IAM_TOKEN_TTL_SECONDS</span><span class="o">=</span><span class="s2">"3600"</span>
 <span class="nb">export </span><span class="nv">LAKECTL_CREDENTIALS_PROVIDER_AWS_IAM_PRESIGNED_URL_TTL_SECONDS</span><span class="o">=</span><span class="s2">"60"</span>
 <span class="nb">export </span><span class="nv">LAKECTL_CREDENTIALS_PROVIDER_AWS_IAM_TOKEN_REQUEST_HEADERS</span><span class="o">=</span><span class="s1">'{"HeaderName":"HeaderValue"}'</span>
</code></pre></div>    </div>
    <p>To use the client, merely <code class="language-plaintext highlighter-rouge">import lakefs</code> and use it as you would normally do:</p>
    <div class="language-python warning highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lakefs</span>

<span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">repository</span><span class="p">(</span><span class="s">"example-repo"</span><span class="p">).</span><span class="n">branches</span><span class="p">():</span>
 <span class="k">print</span><span class="p">(</span><span class="n">branch</span><span class="p">)</span>
</code></pre></div>    </div>
    <blockquote>
      <p>Please note, using the IAM provider configurations will not work with the lakectl command line tool, and will stop you from running it.</p>
    </blockquote>
  </li>
  <li>
    <p>Generate a lakeFS client with the assumed role by initiating a boto3 session with the desired role and call <code class="language-plaintext highlighter-rouge">lakefs.client.frow_aws_role</code>:</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kn">import</span> <span class="nn">lakefs</span>
 <span class="kn">import</span> <span class="nn">boto3</span>    
 <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
 <span class="n">my_client</span> <span class="o">=</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">from_aws_role</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span> <span class="n">ttl_seconds</span><span class="o">=</span><span class="mi">7200</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s">"&lt;lakefs-host&gt;"</span><span class="p">)</span>
    
 <span class="c1"># list repositories
</span> <span class="n">repos</span> <span class="o">=</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">repositories</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="n">my_client</span><span class="p">)</span>
 <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">repos</span><span class="p">:</span>
     <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button" >
                            <img src="/v1.59/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/v1.59/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/v1.59/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/v1.59/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/v1.59/assets/icons/github.svg" class="no-hover" />
                            <img src="/v1.59/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/v1.59/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/v1.59/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/v1.59/assets/icons/slack.svg" class="no-hover" />
                            <img src="/v1.59/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>


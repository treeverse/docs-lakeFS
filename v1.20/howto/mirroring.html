

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/v1.20/assets/css/just-the-docs-default.css">
  
  <style type="text/css">
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(3) > .nav-list > .nav-list-item:nth-child(9) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #ebedf5 0%, rgba(235, 237, 245, 0.8) 80%, rgba(235, 237, 245, 0) 100%); }

.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list-expander svg, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list > .nav-list-item:not(.passive):nth-child(9) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list > .nav-list-item:not(.passive):nth-child(9) > .nav-list { display: block; }

.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list { display: block; }

</style>


  

  
    <script src="/v1.20/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/v1.20/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/v1.20/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Mirroring | lakeFS Documentation</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Mirroring" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Mirroring allows replicating commits between lakeFS installations in different geo-locations/regions" />
<meta property="og:description" content="Mirroring allows replicating commits between lakeFS installations in different geo-locations/regions" />
<meta property="og:site_name" content="lakeFS Documentation" />
<meta property="og:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="twitter:title" content="Mirroring" />
<meta name="twitter:site" content="@lakeFS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Mirroring allows replicating commits between lakeFS installations in different geo-locations/regions","headline":"Mirroring","image":"https://docs.lakefs.io/assets/img/docs_logo.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/v1.20/assets/logo.svg"}},"url":"/v1.20/howto/mirroring.html"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<!-- type="text/plain" is intentional for cookie consent support -->
<script type="text/plain" data-category="analytics">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->
<meta name="robots" content="noindex">
<meta property="og:image" content="/v1.20/assets/img/lakefs-logo-with-text.png">
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<link rel="stylesheet" href="/v1.20/assets/css/cookieconsent.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script type="module" src="/v1.20/assets/js/cookieconsent-init.js"></script>
<script src="/v1.20/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/v1.20/assets/js/feedback.js"></script>
<link href="https://data-folks.masto.host/@lakeFS" rel="me">

</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<img src="/assets/img/cookies.png" style="display: none;">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="lakeFS Documentation"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS Documentation" aria-label="Search lakeFS Documentation"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/v1.20/"
           class="nav-list-link">Welcome to lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.20/quickstart/"
           class="nav-list-link">⭐ Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.20/quickstart/launch.html"
                   class="nav-list-link">1️⃣ Run lakeFS</a></li><li class="nav-list-item "><a href="/v1.20/quickstart/query.html"
                   class="nav-list-link">2️⃣ Query the data</a></li><li class="nav-list-item "><a href="/v1.20/quickstart/branch.html"
                   class="nav-list-link">3️⃣ Create a branch</a></li><li class="nav-list-item "><a href="/v1.20/quickstart/commit-and-merge.html"
                   class="nav-list-link">4️⃣ Commit and Merge</a></li><li class="nav-list-item "><a href="/v1.20/quickstart/rollback.html"
                   class="nav-list-link">5️⃣ Roll back Changes</a></li><li class="nav-list-item "><a href="/v1.20/quickstart/actions-and-hooks.html"
                   class="nav-list-link">6️⃣ Using Actions and Hooks in lakeFS</a></li><li class="nav-list-item "><a href="/v1.20/quickstart/work-with-data-locally.html"
                   class="nav-list-link">7️⃣ Work with lakeFS data locally</a></li><li class="nav-list-item "><a href="/v1.20/quickstart/learning-more-lakefs.html"
                   class="nav-list-link">Learn more about lakeFS</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.20/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/howto/deploy/"
                   class="nav-list-link">Install lakeFS</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/howto/deploy/aws.html"
                           class="nav-list-link">AWS</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/howto/deploy/azure.html"
                           class="nav-list-link">Azure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/howto/deploy/gcp.html"
                           class="nav-list-link">GCP</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/howto/deploy/onprem.html"
                           class="nav-list-link">On-Premises</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/howto/deploy/upgrade.html"
                           class="nav-list-link">Upgrade lakeFS</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/howto/hooks/"
                   class="nav-list-link">Actions and Hooks</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/howto/hooks/airflow.html"
                           class="nav-list-link">Airflow Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/howto/hooks/lua.html"
                           class="nav-list-link">Lua Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/howto/hooks/webhooks.html"
                           class="nav-list-link">Webhooks</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.20/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/v1.20/howto/catalog_exports.html"
                   class="nav-list-link">Data Catalogs Export</a></li><li class="nav-list-item "><a href="/v1.20/howto/export.html"
                   class="nav-list-link">Export Data</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/howto/garbage-collection/"
                   class="nav-list-link">Garbage Collection</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/howto/garbage-collection/gc.html"
                           class="nav-list-link">Garbage Collection</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/howto/garbage-collection/managed-gc.html"
                           class="nav-list-link">Managed Garbage Collection</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.20/howto/import.html"
                   class="nav-list-link">Import Data</a></li><li class="nav-list-item "><a href="/v1.20/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item  active"><a href="/v1.20/howto/mirroring.html"
                   class="nav-list-link active">Mirroring</a></li><li class="nav-list-item "><a href="/v1.20/howto/private-link.html"
                   class="nav-list-link">Private Link</a></li><li class="nav-list-item "><a href="/v1.20/howto/protect-branches.html"
                   class="nav-list-link">Protect Branches</a></li><li class="nav-list-item "><a href="/v1.20/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li><li class="nav-list-item "><a href="/v1.20/howto/scim.html"
                   class="nav-list-link">System for Cross-domain Identity Management (SCIM)</a></li><li class="nav-list-item "><a href="/v1.20/howto/local-checkouts.html"
                   class="nav-list-link">Work with lakeFS data locally</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.20/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.20/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/v1.20/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/v1.20/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/v1.20/integrations/sagemaker.html"
                   class="nav-list-link">Amazon SageMaker</a></li><li class="nav-list-item "><a href="/v1.20/integrations/airflow.html"
                   class="nav-list-link">Apache Airflow</a></li><li class="nav-list-item "><a href="/v1.20/integrations/hive.html"
                   class="nav-list-link">Apache Hive</a></li><li class="nav-list-item "><a href="/v1.20/integrations/iceberg.html"
                   class="nav-list-link">Apache Iceberg</a></li><li class="nav-list-item "><a href="/v1.20/integrations/kafka.html"
                   class="nav-list-link">Apache Kafka</a></li><li class="nav-list-item "><a href="/v1.20/integrations/spark.html"
                   class="nav-list-link">Apache Spark</a></li><li class="nav-list-item "><a href="/v1.20/integrations/cloudera.html"
                   class="nav-list-link">Cloudera</a></li><li class="nav-list-item "><a href="/v1.20/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/v1.20/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/v1.20/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/v1.20/integrations/git.html"
                   class="nav-list-link">Git</a></li><li class="nav-list-item "><a href="/v1.20/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/v1.20/integrations/glue_metastore.html"
                   class="nav-list-link">Glue Data Catalog</a></li><li class="nav-list-item "><a href="/v1.20/integrations/huggingface_datasets.html"
                   class="nav-list-link">HuggingFace Datasets</a></li><li class="nav-list-item "><a href="/v1.20/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/v1.20/integrations/presto_trino.html"
                   class="nav-list-link">Presto / Trino</a></li><li class="nav-list-item "><a href="/v1.20/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/v1.20/integrations/r.html"
                   class="nav-list-link">R</a></li><li class="nav-list-item "><a href="/v1.20/integrations/unity-catalog.html"
                   class="nav-list-link">Unity Catalog</a></li><li class="nav-list-item "><a href="/v1.20/integrations/vertex_ai.html"
                   class="nav-list-link">Vertex AI</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.20/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.20/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/v1.20/understand/model.html"
                   class="nav-list-link">Concepts and  Model</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.20/understand/faq.html"
                   class="nav-list-link">FAQ</a></li><li class="nav-list-item "><a href="/v1.20/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/understand/how/"
                   class="nav-list-link">How lakeFS Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.20/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/understand/use_cases/"
                   class="nav-list-link">Use Cases</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/understand/use_cases/cicd_for_data.html"
                           class="nav-list-link">CI/CD for Data Lakes</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/understand/use_cases/etl_testing.html"
                           class="nav-list-link">ETL Testing Environment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/understand/use_cases/reproducibility.html"
                           class="nav-list-link">Reproducibility</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/understand/use_cases/rollback.html"
                           class="nav-list-link">Rollback</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.20/understand/lakefs-cloud.html"
                   class="nav-list-link">lakeFS Cloud</a></li><li class="nav-list-item "><a href="/v1.20/understand/lakefs-enterprise.html"
                   class="nav-list-link">lakeFS Enterprise</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.20/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.20/reference/auditing.html"
                   class="nav-list-link">Auditing</a></li><li class="nav-list-item "><a href="/v1.20/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/v1.20/reference/s3.html"
                   class="nav-list-link">S3 Gateway API</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/reference/security/"
                   class="nav-list-link">Security</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/access-control-lists.html"
                           class="nav-list-link">Access Control Lists (ACLs)</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/authentication.html"
                           class="nav-list-link">Authentication</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/external-principals-aws.html"
                           class="nav-list-link">Login to lakeFS with AWS IAM Roles</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/presigned-url.html"
                           class="nav-list-link">Presigned URL</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/remote-authenticator.html"
                           class="nav-list-link">Remote Authenticator</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/rbac.html"
                           class="nav-list-link">Role-Based Access Control (RBAC)</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/sts-login.html"
                           class="nav-list-link">Short-lived token (STS like) Authentication for lakeFS</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.20/reference/security/sso.html"
                           class="nav-list-link">Single Sign On (SSO)</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.20/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/v1.20/reference/api.html"
                   class="nav-list-link">lakeFS API</a></li><li class="nav-list-item "><a href="/v1.20/reference/configuration.html"
                   class="nav-list-link">lakeFS Server Configuration</a></li><li class="nav-list-item "><a href="/v1.20/reference/cli.html"
                   class="nav-list-link">lakectl (lakeFS command-line tool)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.20/project/"
           class="nav-list-link">The lakeFS Project</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.20/project/contributing.html"
                   class="nav-list-link">Contributing to lakeFS</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.20/project/docs/"
                   class="nav-list-link">Documentation</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.20/project/docs/callouts.html"
                           class="nav-list-link">Callouts</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.20/project/code-migrate-1.0-sdk.html"
                   class="nav-list-link">Migrating to 1.0</a></li></ul></li><li
            class="nav-list-item"><a href="/v1.20/posts/tdd-semver.html"
           class="nav-list-link">lakeFS SemVer + TDD</a></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/v1.20/howto/">How-To</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Mirroring</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 class="d-inline-block" id="mirroring">
  
  
    <a href="#mirroring" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mirroring
  
  
</h1>
    
<p class="label label-green d-inline-block">lakeFS Cloud</p>
<p class="label label-green">Public Preview</p>

<blockquote class="note">
  <p>Mirroring is only available for <a href="/understand/lakefs-cloud.html">lakeFS Cloud</a>.</p>
</blockquote>

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#what-is-lakefs-mirroring" id="markdown-toc-what-is-lakefs-mirroring">What is lakeFS mirroring?</a></li>
  <li><a href="#uses-cases" id="markdown-toc-uses-cases">Uses cases</a></li>
  <li><a href="#setting-up-mirroring" id="markdown-toc-setting-up-mirroring">Setting up mirroring</a></li>
  <li><a href="#rbac" id="markdown-toc-rbac">RBAC</a></li>
  <li><a href="#other-replication-operations" id="markdown-toc-other-replication-operations">Other replication operations</a></li>
  <li><a href="#limitations" id="markdown-toc-limitations">Limitations</a></li>
</ol>

</div>
<h2 id="what-is-lakefs-mirroring">
  
  
    <a href="#what-is-lakefs-mirroring" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is lakeFS mirroring?
  
  
</h2>
    

<p>Mirroring in lakeFS allows replicating a lakeFS repository (“source”) into read-only copies (“mirror”) in different locations.</p>

<p>Unlike conventional mirroring, data isn’t simply copied between regions - lakeFS Cloud tracks the state of each commit, advancing the commit log on the mirror only once a commit has been fully replicated and all data is available.</p>

<p><img src="/v1.20/assets/img/mirroring/arch.png" alt="mirroring architecture" /></p>
<h2 id="uses-cases">
  
  
    <a href="#uses-cases" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Uses cases
  
  
</h2>
    
<h3 id="disaster-recovery">
  
  
    <a href="#disaster-recovery" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Disaster recovery
  
  
</h3>
    

<p>Typically, object stores provide a replication/batch copy API to allow for disaster recovery: as new objects are written, they are asynchronously copied to other geo locations.</p>

<p>In the case of regional failure, users can rely on the other geolocations which should contain relatively-up-to-date state.</p>

<p>The problem is reasoning about what managed to arrive by the time of disaster and what hasn’t:</p>
<ul>
  <li>have all the necessary files for a given dataset arrived?</li>
  <li>in cases there are dependencies between datasets, are all dependencies also up to date?</li>
  <li>what is currently in-flight or haven’t even started replicating yet?</li>
</ul>

<p>Reasoning about these is non-trivial, especially in the face of a regional disaster, however ensuring business continuity might require that we have these answers.</p>

<p>Using lakeFS mirroring makes it much easier to answer: we are guaranteed that the latest commit that exists in the replica is in a consistent state and is fully usable, even if it isn’t the absolute latest commit - it still reflects a known, consistent, point in time.</p>
<h3 id="data-locality">
  
  
    <a href="#data-locality" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Data Locality
  
  
</h3>
    

<p>For certain workloads, it might be cheaper to have data available in multiple regions: Expensive hardware such as GPUs might fluctuate in price, so we’d want to pick the region that currently offers the best pricing. The difference could easily offset to cost of the replicated data.</p>

<p>The challenge is reproducibility - Say we have an ML training job that reads image files from a path in the object store. Which files existed at the time of training?</p>

<p>If data is constantly flowing between regions, this might be harder to answer than we think. And even if we know - how can we recreate that exact state if we want to run the process again (for example, to rebuild that model for troubleshooting).</p>

<p>Using consistent commits solves this problem - with lakeFS mirroring, it is guaranteed that a commit ID, regardless of location, will always contain the exact same data.</p>

<p>We can train our model in region A, and a month later feed the same commit ID into another region - and get back the same results.</p>
<h2 id="setting-up-mirroring">
  
  
    <a href="#setting-up-mirroring" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting up mirroring
  
  
</h2>
    
<h3 id="configuring-bucket-replication-on-s3">
  
  
    <a href="#configuring-bucket-replication-on-s3" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring bucket replication on S3
  
  
</h3>
    

<p>The objects within the repository are copied using your cloud provider’s object store replication mechanism.
For AWS S3, please refer to the <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-how-setup.html">AWS S3 replication documentation</a> to make sure your lakeFS repository’s <a href="../understand/glossary.html#storage-namespace">storage namespace</a> (source) is replicated to the region you’d like your mirror to be located on (target).</p>

<p>After setting the replication rule, new objects will be replicated to the destination bucket.</p>

<p>In order to replicate the existing objects, we’d need to manually copy them - however, we can use <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/s3-batch-replication-batch.html">S3 batch jobs</a> to do this.</p>
<h3 id="creating-a-lakefs-user-with-a-replicator-policy">
  
  
    <a href="#creating-a-lakefs-user-with-a-replicator-policy" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating a lakeFS user with a “replicator” policy
  
  
</h3>
    

<p>On our source lakeFS installation, under <strong>Administration</strong> create a new user that will be used by the replication subsystem.
The user should have the following <a href="../reference/security/rbac.html">RBAC policy</a> attached:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ReplicationPolicy"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"fs:ReadRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:UpdateRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:DeleteRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListRepositories"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:AttachStorageNamespace"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadObject"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:WriteObject"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:DeleteObject"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListObjects"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateCommit"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateMetaRange"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadCommit"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListCommits"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:DeleteBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:RevertBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListBranches"</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="nl">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allow"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Alternatively</strong>, we can create a policy with a narrower scope, only for a specific repository and/or mirror:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ReplicationPolicy"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"fs:ListRepositories"</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="nl">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allow"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"fs:ReadRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadObject"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListObjects"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadCommit"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListCommits"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListBranches"</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="nl">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allow"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:lakefs:fs:::repository/{sourceRepositoryId}"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"fs:ReadRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:UpdateRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:DeleteRepository"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:AttachStorageNamespace"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadObject"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:WriteObject"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:DeleteObject"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListObjects"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateCommit"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateMetaRange"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadCommit"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListCommits"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:CreateBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:DeleteBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:RevertBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ReadBranch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fs:ListBranches"</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="nl">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allow"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:lakefs:fs:::repository/{mirrorId}"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"fs:AttachStorageNamespace"</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="nl">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allow"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:lakefs:fs:::namespace/{DestinationStorageNamespace}"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Once a user has been created and the replication policy attached to it, create an access key and secret to be used by the mirroring process.</p>
<h3 id="authorizing-the-lakefs-mirror-process-to-use-the-replication-user">
  
  
    <a href="#authorizing-the-lakefs-mirror-process-to-use-the-replication-user" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Authorizing the lakeFS Mirror process to use the replication user
  
  
</h3>
    

<p>Please <a href="mailto:support@treeverse.io?subject=Setting up replication">contact Treeverse customer success</a> to connect the newly created user with the mirroring process</p>
<h3 id="configuring-repository-replication">
  
  
    <a href="#configuring-repository-replication" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring repository replication
  
  
</h3>
    

<p>Replication has a stand-alone HTTP API. In this example, we’ll use cURL, but feel free to use any HTTP client or library:</p>

<pre><code class="language-bashhttps://treeverse.us-east-1">curl --location 'https://&lt;ORGANIZATION_ID&gt;.&lt;SOURCE_REGION&gt;.lakefscloud.io/service/replication/v1/repositories/&lt;SOURCE_REPO&gt;/mirrors' \
--header 'Content-Type: application/json' \
-u &lt;ACCESS_KEY_ID&gt;:&lt;SECRET_ACCESS_KEY&gt; \
-X POST \
--data '{
    "name": "&lt;MIRROR_NAME&gt;",
    "region": "&lt;MIRROR_REGION&gt;",
    "storage_namespace": "&lt;MIRROR_STORAGE_NAMESPACE&gt;"
}'
</code></pre>
<p>Using the following parameters:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ORGANIZATION_ID</code> - The ID as it appears in the URL of your lakeFS installation (e.g. <code class="language-plaintext highlighter-rouge">https://my-org.us-east-1.lakefscloud.io/</code>)</li>
  <li><code class="language-plaintext highlighter-rouge">SOURCE_REGION</code> - The region where our source repository is hosted</li>
  <li><code class="language-plaintext highlighter-rouge">SOURCE_REPO</code> - Name of the repository acting as our replication source. It should exist</li>
  <li><code class="language-plaintext highlighter-rouge">ACCESS_KEY_ID</code> &amp; <code class="language-plaintext highlighter-rouge">SECRET_ACCESS_KEY</code> - Credentials for your lakeFS user (make sure you have the necessary RBAC permissions as <a href="#rbac">listed below</a>)</li>
  <li><code class="language-plaintext highlighter-rouge">MIRROR_NAME</code> - Name used for the read-only mirror to be created on the destination region</li>
  <li><code class="language-plaintext highlighter-rouge">MIRROR_STORAGE_NAMESPACE</code> - Location acting as the replication target for the storage namespace of our source repository</li>
</ul>
<h3 id="mirroring-and-garbage-collection">
  
  
    <a href="#mirroring-and-garbage-collection" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mirroring and Garbage Collection
  
  
</h3>
    

<p>Garbage collection won’t run on mirrored repositories. 
Deletions from garbage collection should be replicated from the source:</p>
<ol>
  <li>Enable <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/delete-marker-replication.html">DELETED marker replication</a> on the source bucket.</li>
  <li>Create a <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html">lifecycle policy</a> on the destination bucket to delete the objects with the DELETED marker.</li>
</ol>
<h2 id="rbac">
  
  
    <a href="#rbac" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RBAC
  
  
</h2>
    

<p>These are the required RBAC permissions for working with the new cross-region replication feature:</p>

<p>Creating a Mirror:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Action</th>
      <th>ARN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fs:CreateRepository</code></td>
      <td><code class="language-plaintext highlighter-rouge">arn:lakefs:fs:::repository/{mirrorId}</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fs:MirrorRepository</code></td>
      <td><code class="language-plaintext highlighter-rouge">arn:lakefs:fs:::repository/{sourceRepositoryId}</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fs:AttachStorageNamespace</code></td>
      <td><code class="language-plaintext highlighter-rouge">arn:lakefs:fs:::namespace/{storageNamespace}</code></td>
    </tr>
  </tbody>
</table></div>

<p>Editing Mirrored Branches:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Action</th>
      <th>ARN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fs:MirrorRepository</code></td>
      <td><code class="language-plaintext highlighter-rouge">arn:lakefs:fs:::repository/{sourceRepositoryId}</code></td>
    </tr>
  </tbody>
</table></div>

<p>Deleting a Mirror:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Action</th>
      <th>ARN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fs:DeleteRepository</code></td>
      <td><code class="language-plaintext highlighter-rouge">arn:lakefs:fs:::repository/{mirrorId}</code></td>
    </tr>
  </tbody>
</table></div>

<p>Listing/Getting Mirrors for a Repository:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Action</th>
      <th>ARN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fs:ListRepositories</code></td>
      <td><code class="language-plaintext highlighter-rouge">*</code></td>
    </tr>
  </tbody>
</table></div>
<h2 id="other-replication-operations">
  
  
    <a href="#other-replication-operations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Other replication operations
  
  
</h2>
    
<h3 id="listing-all-mirrors-for-a-repository">
  
  
    <a href="#listing-all-mirrors-for-a-repository" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Listing all mirrors for a repository
  
  
</h3>
    

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">--location</span> <span class="s1">'https://&lt;ORGANIZATION_ID&gt;.&lt;SOURCE_REGION&gt;.lakefscloud.io/service/replication/v1/repositories/&lt;SOURCE_REPO&gt;/mirrors'</span> <span class="se">\</span>
<span class="nt">-u</span> &lt;ACCESS_KEY_ID&gt;:&lt;SECRET_ACCESS_KEY&gt; <span class="nt">-s</span>
</code></pre></div></div>
<h3 id="getting-a-specific-mirror">
  
  
    <a href="#getting-a-specific-mirror" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Getting a specific mirror
  
  
</h3>
    

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>url <span class="nt">--location</span> <span class="s1">'https://&lt;ORGANIZATION_ID&gt;.&lt;SOURCE_REGION&gt;.lakefscloud.io/service/replication/v1/repositories/&lt;SOURCE_REPO&gt;/mirrors/&lt;MIRROR_ID&gt;'</span> <span class="se">\</span>
<span class="nt">-u</span> &lt;ACCESS_KEY_ID&gt;:&lt;SECRET_ACCESS_KEY&gt; <span class="nt">-s</span>
</code></pre></div></div>
<h3 id="deleting-a-specific-mirror">
  
  
    <a href="#deleting-a-specific-mirror" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deleting a specific mirror
  
  
</h3>
    

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> DELETE <span class="s1">'https://&lt;ORGANIZATION_ID&gt;.&lt;SOURCE_REGION&gt;.lakefscloud.io/service/replication/v1/repositories/&lt;SOURCE_REPO&gt;/mirrors/&lt;MIRROR_ID&gt;'</span> <span class="se">\</span>
<span class="nt">-u</span> &lt;ACCESS_KEY_ID&gt;:&lt;SECRET_ACCESS_KEY&gt;
</code></pre></div></div>
<h2 id="limitations">
  
  
    <a href="#limitations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Limitations
  
  
</h2>
    

<ol>
  <li>Mirroring is currently only supported on <a href="https://aws.amazon.com/s3/">AWS S3</a> and <a href="https://lakefs.cloud">lakeFS Cloud for AWS</a></li>
  <li>Read-only mirrors cannot be written to. Mirroring is one-way, from source to destination(s)</li>
  <li>Currently, only branches are mirrored. Tags and arbitrary commits that do not belong to any branch are not replicated</li>
  <li><a href="./hooks">lakeFS Hooks</a> will only run on the source repository, not its replicas</li>
  <li>Replication is still asynchronous: reading from a branch will always return a valid commit that the source has pointed to, but it is not guaranteed to be the <strong>latest commit</strong> the source branch is pointing to.</li>
</ol>

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button" >
                            <img src="/v1.20/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/v1.20/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/v1.20/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/v1.20/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/v1.20/assets/icons/github.svg" class="no-hover" />
                            <img src="/v1.20/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/v1.20/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/v1.20/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://data-folks.masto.host/@lakeFS" class="site-button" >
                            <img src="/v1.20/assets/icons/mastodon.svg" class="no-hover" />
                            <img src="/v1.20/assets/icons/mastodon-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/v1.20/assets/icons/slack.svg" class="no-hover" />
                            <img src="/v1.20/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>


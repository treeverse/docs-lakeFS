

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/v1.45/assets/css/just-the-docs-default.css">
  
  


  

  
    <script src="/v1.45/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/v1.45/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/v1.45/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Mount CSI Driver | lakeFS Documentation</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Mount CSI Driver" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This section covers the usage of CSI Driver with Everest feature for mounting a lakeFS path to Kubernetes." />
<meta property="og:description" content="This section covers the usage of CSI Driver with Everest feature for mounting a lakeFS path to Kubernetes." />
<meta property="og:site_name" content="lakeFS Documentation" />
<meta property="og:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="twitter:title" content="Mount CSI Driver" />
<meta name="twitter:site" content="@lakeFS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"This section covers the usage of CSI Driver with Everest feature for mounting a lakeFS path to Kubernetes.","headline":"Mount CSI Driver","image":"https://docs.lakefs.io/assets/img/docs_logo.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/v1.45/assets/logo.svg"}},"url":"/v1.45/reference/mount-csi-driver.html"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<!-- type="text/plain" is intentional for cookie consent support -->
<script type="text/plain" data-category="analytics">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->

<meta name="robots" content="noindex">

<meta property="og:image" content="/v1.45/assets/img/lakefs-logo-with-text.png">
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<link rel="stylesheet" href="/v1.45/assets/css/cookieconsent.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script type="module" src="/v1.45/assets/js/cookieconsent-init.js"></script>
<script src="/v1.45/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/v1.45/assets/js/feedback.js"></script>
<link href="https://data-folks.masto.host/@lakeFS" rel="me">

</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<img src="/assets/img/cookies.png" style="display: none;">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="lakeFS Documentation"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS Documentation" aria-label="Search lakeFS Documentation"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/v1.45/"
           class="nav-list-link">Welcome to lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/quickstart/"
           class="nav-list-link">⭐ Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.45/quickstart/launch.html"
                   class="nav-list-link">1️⃣ Run lakeFS</a></li><li class="nav-list-item "><a href="/v1.45/quickstart/query.html"
                   class="nav-list-link">2️⃣ Query the data</a></li><li class="nav-list-item "><a href="/v1.45/quickstart/branch.html"
                   class="nav-list-link">3️⃣ Create a branch</a></li><li class="nav-list-item "><a href="/v1.45/quickstart/commit-and-merge.html"
                   class="nav-list-link">4️⃣ Commit and Merge</a></li><li class="nav-list-item "><a href="/v1.45/quickstart/rollback.html"
                   class="nav-list-link">5️⃣ Roll back Changes</a></li><li class="nav-list-item "><a href="/v1.45/quickstart/actions-and-hooks.html"
                   class="nav-list-link">6️⃣ Using Actions and Hooks in lakeFS</a></li><li class="nav-list-item "><a href="/v1.45/quickstart/work-with-data-locally.html"
                   class="nav-list-link">7️⃣ Work with lakeFS data locally</a></li><li class="nav-list-item "><a href="/v1.45/quickstart/learning-more-lakefs.html"
                   class="nav-list-link">Learn more about lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/howto/deploy/"
                   class="nav-list-link">Install lakeFS</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/howto/deploy/aws.html"
                           class="nav-list-link">AWS</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/deploy/azure.html"
                           class="nav-list-link">Azure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/deploy/gcp.html"
                           class="nav-list-link">GCP</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/deploy/onprem.html"
                           class="nav-list-link">On-Premises</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/deploy/upgrade.html"
                           class="nav-list-link">Upgrade lakeFS</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/howto/hooks/"
                   class="nav-list-link">Actions and Hooks</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/howto/hooks/airflow.html"
                           class="nav-list-link">Airflow Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/hooks/lua.html"
                           class="nav-list-link">Lua Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/hooks/webhooks.html"
                           class="nav-list-link">Webhooks</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.45/howto/backup-and-restore.html"
                   class="nav-list-link">Backup and Restore Repository</a></li><li class="nav-list-item "><a href="/v1.45/howto/protect-branches.html"
                   class="nav-list-link">Branch Protection</a></li><li class="nav-list-item "><a href="/v1.45/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/v1.45/howto/catalog_exports.html"
                   class="nav-list-link">Data Catalogs Export</a></li><li class="nav-list-item "><a href="/v1.45/howto/export.html"
                   class="nav-list-link">Export Data</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/howto/garbage-collection/"
                   class="nav-list-link">Garbage Collection</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/howto/garbage-collection/gc.html"
                           class="nav-list-link">Garbage Collection</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/garbage-collection/managed-gc.html"
                           class="nav-list-link">Managed Garbage Collection</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/howto/garbage-collection/standalone-gc.html"
                           class="nav-list-link">Standalone Garbage Collection</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.45/howto/import.html"
                   class="nav-list-link">Import Data</a></li><li class="nav-list-item "><a href="/v1.45/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/v1.45/howto/mirroring.html"
                   class="nav-list-link">Mirroring</a></li><li class="nav-list-item "><a href="/v1.45/howto/private-link.html"
                   class="nav-list-link">Private Link</a></li><li class="nav-list-item "><a href="/v1.45/howto/pull-requests.html"
                   class="nav-list-link">Pull Requests</a></li><li class="nav-list-item "><a href="/v1.45/howto/virtual-host-addressing.html"
                   class="nav-list-link">S3 Virtual-host addressing (advanced)</a></li><li class="nav-list-item "><a href="/v1.45/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li><li class="nav-list-item "><a href="/v1.45/howto/scim.html"
                   class="nav-list-link">System for Cross-domain Identity Management (SCIM)</a></li><li class="nav-list-item "><a href="/v1.45/howto/local-checkouts.html"
                   class="nav-list-link">Work with lakeFS data locally</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.45/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/v1.45/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/v1.45/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/v1.45/integrations/sagemaker.html"
                   class="nav-list-link">Amazon SageMaker</a></li><li class="nav-list-item "><a href="/v1.45/integrations/airflow.html"
                   class="nav-list-link">Apache Airflow</a></li><li class="nav-list-item "><a href="/v1.45/integrations/hive.html"
                   class="nav-list-link">Apache Hive</a></li><li class="nav-list-item "><a href="/v1.45/integrations/iceberg.html"
                   class="nav-list-link">Apache Iceberg</a></li><li class="nav-list-item "><a href="/v1.45/integrations/kafka.html"
                   class="nav-list-link">Apache Kafka</a></li><li class="nav-list-item "><a href="/v1.45/integrations/spark.html"
                   class="nav-list-link">Apache Spark</a></li><li class="nav-list-item "><a href="/v1.45/integrations/cloudera.html"
                   class="nav-list-link">Cloudera</a></li><li class="nav-list-item "><a href="/v1.45/integrations/databricks.html"
                   class="nav-list-link">Databricks</a></li><li class="nav-list-item "><a href="/v1.45/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/v1.45/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/v1.45/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/v1.45/integrations/git.html"
                   class="nav-list-link">Git</a></li><li class="nav-list-item "><a href="/v1.45/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/v1.45/integrations/glue_metastore.html"
                   class="nav-list-link">Glue Data Catalog</a></li><li class="nav-list-item "><a href="/v1.45/integrations/huggingface_datasets.html"
                   class="nav-list-link">HuggingFace Datasets</a></li><li class="nav-list-item "><a href="/v1.45/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/v1.45/integrations/presto_trino.html"
                   class="nav-list-link">Presto / Trino</a></li><li class="nav-list-item "><a href="/v1.45/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/v1.45/integrations/r.html"
                   class="nav-list-link">R</a></li><li class="nav-list-item "><a href="/v1.45/integrations/unity-catalog.html"
                   class="nav-list-link">Unity Catalog</a></li><li class="nav-list-item "><a href="/v1.45/integrations/vertex_ai.html"
                   class="nav-list-link">Vertex AI</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.45/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/v1.45/understand/model.html"
                   class="nav-list-link">Concepts and  Model</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.45/understand/data-structure.html"
                   class="nav-list-link">Data Structure</a></li><li class="nav-list-item "><a href="/v1.45/understand/faq.html"
                   class="nav-list-link">FAQ</a></li><li class="nav-list-item "><a href="/v1.45/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/understand/how/"
                   class="nav-list-link">How lakeFS Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.45/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/understand/use_cases/"
                   class="nav-list-link">Use Cases</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/understand/use_cases/cicd_for_data.html"
                           class="nav-list-link">CI/CD for Data Lakes</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/understand/use_cases/etl_testing.html"
                           class="nav-list-link">ETL Testing Environment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/understand/use_cases/reproducibility.html"
                           class="nav-list-link">Reproducibility</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/understand/use_cases/rollback.html"
                           class="nav-list-link">Rollback</a>
                    </li></ul></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.45/reference/auditing.html"
                   class="nav-list-link">Auditing</a></li><li class="nav-list-item "><a href="/v1.45/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/v1.45/reference/s3.html"
                   class="nav-list-link">S3 Gateway API</a></li><li class="nav-list-item "><a href="/v1.45/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/v1.45/reference/api.html"
                   class="nav-list-link">lakeFS API</a></li><li class="nav-list-item "><a href="/v1.45/reference/configuration.html"
                   class="nav-list-link">lakeFS Server Configuration</a></li><li class="nav-list-item "><a href="/v1.45/reference/cli.html"
                   class="nav-list-link">lakectl (lakeFS command-line tool)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/project/"
           class="nav-list-link">The lakeFS Project</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.45/project/contributing.html"
                   class="nav-list-link">Contributing to lakeFS</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/project/docs/"
                   class="nav-list-link">Documentation</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/project/docs/callouts.html"
                           class="nav-list-link">Callouts</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.45/project/code-migrate-1.0-sdk.html"
                   class="nav-list-link">Migrating to 1.0</a></li></ul></li><li
            class="nav-list-item"><a href="/v1.45/cloud/"
           class="nav-list-link">lakeFS Cloud</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/enterprise/"
           class="nav-list-link">lakeFS Enterprise</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.45/enterprise/getstarted/"
                   class="nav-list-link">Get Started</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.45/enterprise/getstarted/quickstart.html"
                           class="nav-list-link">Quickstart</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/enterprise/getstarted/install.html"
                           class="nav-list-link">Install</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.45/enterprise/getstarted/migrate-from-oss.html"
                           class="nav-list-link">Migrate from lakeFS OSS</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.45/enterprise/upgrade.html"
                   class="nav-list-link">Upgrade</a></li><li class="nav-list-item "><a href="/v1.45/enterprise/troubleshooting.html"
                   class="nav-list-link">Troubleshooting lakeFS Enterprise</a></li><li class="nav-list-item "><a href="/v1.45/enterprise/configuration.html"
                   class="nav-list-link">Configuration Reference</a></li><li class="nav-list-item "><a href="/v1.45/enterprise/architecture.html"
                   class="nav-list-link">Architecture</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.45/security/"
           class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.45/security/access-control-lists.html"
                   class="nav-list-link">Access Control Lists (ACLs) -Deprecated-</a></li><li class="nav-list-item "><a href="/v1.45/security/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/v1.45/security/external-principals-aws.html"
                   class="nav-list-link">Login to lakeFS with AWS IAM Roles</a></li><li class="nav-list-item "><a href="/v1.45/security/presigned-url.html"
                   class="nav-list-link">Presigned URLs</a></li><li class="nav-list-item "><a href="/v1.45/security/remote-authenticator.html"
                   class="nav-list-link">Remote Authenticator</a></li><li class="nav-list-item "><a href="/v1.45/security/rbac.html"
                   class="nav-list-link">Role-Based Access Control (RBAC)</a></li><li class="nav-list-item "><a href="/v1.45/security/sts-login.html"
                   class="nav-list-link">Short-lived token (STS like) Authentication for lakeFS</a></li><li class="nav-list-item "><a href="/v1.45/security/sso.html"
                   class="nav-list-link">Single Sign On (SSO)</a></li></ul></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a
                                href="/v1.45/reference/">Reference</a>
                    </li>
                    <li class="breadcrumb-nav-list-item"><a href="">Features</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Mount CSI Driver</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 id="mount-csi-driver-everest-on-kubernetes">
  
  
    <a href="#mount-csi-driver-everest-on-kubernetes" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mount CSI Driver (Everest on Kubernetes)
  
  
</h1>
    

<p class="d-inline-block label label-green">lakeFS Cloud</p>

<p class="label label-purple">lakeFS Enterprise</p>

<p>The lakeFS CSI (Container Storage Interface) Driver is an extension for Kubernetes that enables seamless access to data within a lakeFS repository, allowing Pods to interact with lakeFS data as if it were part of the local filesystem. This driver builds on the functionality of <a href="/v1.45/reference/mount.html">Everest</a>, which provides a read-only view of lakeFS data by virtually mounting a repository.</p>

<p class="note"><strong>Note</strong>
⚠️ The CSI Driver is in private preview. Please <a href="http://info.lakefs.io/thanks-lakefs-mounts">contact us</a> to get access.</p>

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#how-mount-is-executed-on-a-host" id="markdown-toc-how-mount-is-executed-on-a-host">How mount is executed on a Host</a></li>
  <li><a href="#status-and-limitations" id="markdown-toc-status-and-limitations">Status and Limitations</a></li>
  <li><a href="#requirements" id="markdown-toc-requirements">Requirements</a></li>
  <li><a href="#deploy-the-csi-driver" id="markdown-toc-deploy-the-csi-driver">Deploy the CSI Driver</a>    <ol>
      <li><a href="#1-update-your-helm-with-the-chart" id="markdown-toc-1-update-your-helm-with-the-chart">1. Update your helm with the chart:</a></li>
      <li><a href="#2-configure-the-values-for-the-csi-driver-in-a-valuesyaml-file" id="markdown-toc-2-configure-the-values-for-the-csi-driver-in-a-valuesyaml-file">2. Configure the values for the CSI Driver in a <code class="language-plaintext highlighter-rouge">values.yaml</code> file</a></li>
      <li><a href="#3-install-the-chart-to-k8s-cluster" id="markdown-toc-3-install-the-chart-to-k8s-cluster">3. Install the Chart to K8S cluster</a></li>
    </ol>
  </li>
  <li><a href="#use-in-pods" id="markdown-toc-use-in-pods">Use in Pods</a>    <ol>
      <li><a href="#mount-options" id="markdown-toc-mount-options">Mount Options</a></li>
      <li><a href="#examples" id="markdown-toc-examples">Examples</a></li>
    </ol>
  </li>
  <li><a href="#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a></li>
</ol>

</div>
<h2 id="how-mount-is-executed-on-a-host">
  
  
    <a href="#how-mount-is-executed-on-a-host" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How mount is executed on a Host
  
  
</h2>
    

<ul>
  <li>While the <code class="language-plaintext highlighter-rouge">csi</code> driver is responsible for mounting and unmounting the volume on the host, it does not need permissions to execute the <code class="language-plaintext highlighter-rouge">mount</code> and <code class="language-plaintext highlighter-rouge">umount</code> commands directly.</li>
  <li>The <code class="language-plaintext highlighter-rouge">everest</code> commands are executed by <code class="language-plaintext highlighter-rouge">systemd</code> service on the Host itself (i.e <code class="language-plaintext highlighter-rouge">everest mount...</code>).</li>
  <li>The <code class="language-plaintext highlighter-rouge">csi</code> driver communicates with the <code class="language-plaintext highlighter-rouge">systemd</code> service via a unix socket to execute the <code class="language-plaintext highlighter-rouge">mount</code> and <code class="language-plaintext highlighter-rouge">umount</code> commands.</li>
</ul>
<h2 id="status-and-limitations">
  
  
    <a href="#status-and-limitations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Status and Limitations
  
  
</h2>
    

<ul>
  <li>Tested OS: BottleRocket-OS, Amazon Linux 2 and RHEL 8.</li>
  <li>Minimal Kubernetes versions <code class="language-plaintext highlighter-rouge">&gt;=1.23.0</code>.</li>
  <li>Tested Cluster providers EKS, Openshift (Partially).</li>
  <li>Static provisioning only explain below.</li>
  <li>Setting Pods <code class="language-plaintext highlighter-rouge">securityContext</code> UID and GID (i.e <code class="language-plaintext highlighter-rouge">runAsUser: 1000</code>, <code class="language-plaintext highlighter-rouge">runAsGroup: 2000</code>) is very neuanced in nature and does not have wide coverage currently, not supported but might work.</li>
  <li>Pod only supports access mode <code class="language-plaintext highlighter-rouge">ReadOnlyMany</code></li>
</ul>

<p><strong>Static Provisioning only (Relevant for pods)</strong></p>

<p>When requesting a mount from the CSI driver, the driver will create a <code class="language-plaintext highlighter-rouge">PersistentVolume</code> (PV) and <code class="language-plaintext highlighter-rouge">PersistentVolumeClaim</code> (PVC) for the Pod.
The driver only supports Static Provisioning as of today, and you need an existing lakeFS repository to use.</p>

<p>To use Static Provisioning, you should set <code class="language-plaintext highlighter-rouge">storageClassName</code> field of your <code class="language-plaintext highlighter-rouge">PersistentVolume (PV)</code> and <code class="language-plaintext highlighter-rouge">PersistentVolumeClaim (PVC)</code> to <code class="language-plaintext highlighter-rouge">""</code> (empty string). Also, in order to make sure no other PVCs can claim your PV, you should define a one-to-one mapping using <code class="language-plaintext highlighter-rouge">claimRef</code>.</p>
<h2 id="requirements">
  
  
    <a href="#requirements" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Requirements
  
  
</h2>
    

<ol>
  <li>For enterprise installations: lakeFS Version <code class="language-plaintext highlighter-rouge">1.25.0</code> or higher.</li>
  <li>You have a Kubernetes cluster with version <code class="language-plaintext highlighter-rouge">&gt;=1.23.0</code> and <a href="https://helm.sh/docs/intro/install/">Helm</a> installed.</li>
  <li>lakeFS Server that can be access from pods in the cluster.</li>
  <li>Access to download <em>treeverse/everest-lakefs-csi-driver</em> from <a href="https://hub.docker.com/u/treeverse">Docker Hub</a>. <a href="https://lakefs.io/contact-sales/">Contact us</a> to gain access to lakeFS Enterprise features.</li>
</ol>
<h2 id="deploy-the-csi-driver">
  
  
    <a href="#deploy-the-csi-driver" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deploy the CSI Driver
  
  
</h2>
    

<p>The CSI Driver is deployed to K8S cluster using a dedicated Helm chart <a href="https://github.com/treeverse/charts/releases">everest-lakefs-csi-driver</a>.</p>
<h3 id="1-update-your-helm-with-the-chart">
  
  
    <a href="#1-update-your-helm-with-the-chart" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Update your helm with the chart:
  
  
</h3>
    

<p>Add lakeFS Helm repository if not already added:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm repo add lakefs https://charts.lakefs.io
</code></pre></div></div>

<p>Fetch the chart from lakeFS repository:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm repo update lakefs
</code></pre></div></div>

<p>Verify the chart is available and updated:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm show chart lakefs/everest-lakefs-csi-driver 
</code></pre></div></div>

<p>List all available chart versions:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm search repo lakefs/everest-lakefs-csi-driver <span class="nt">-l</span>
</code></pre></div></div>
<h3 id="2-configure-the-values-for-the-csi-driver-in-a-valuesyaml-file">
  
  
    <a href="#2-configure-the-values-for-the-csi-driver-in-a-valuesyaml-file" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Configure the values for the CSI Driver in a <code class="language-plaintext highlighter-rouge">values.yaml</code> file
  
  
</h3>
    

<p><strong>Helm Chart default values:</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm show values lakefs/everest-lakefs-csi-driver <span class="nt">--version</span> &lt;version&gt;
</code></pre></div></div>

<p><strong>CSI driver config:</strong></p>

<p>All the driver CLI flags can be configured via environment variables (prefiedx <code class="language-plaintext highlighter-rouge">CSI_DRIVER_</code>) and can be passed to the driver.</p>

<p><strong>Example <code class="language-plaintext highlighter-rouge">values.yaml</code> file - Minimal required arguments not commented:</strong></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># image:  </span>
<span class="c1">#   repository: treeverse/everest-lakefs-csi-driver</span>
<span class="c1"># # Optional CSI Driver override version (default .Chart.AppVersion)</span>
<span class="c1">#   tag: 1.2.3</span>

<span class="c1"># Same as fluffy https://github.com/treeverse/fluffy?tab=readme-ov-file#1-dockerhub-token-for-fluffy</span>
<span class="na">imagePullSecret</span><span class="pi">:</span>
  <span class="na">token</span><span class="pi">:</span> <span class="s">&lt;dockerhub-token&gt;</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">&lt;dockerhub-user&gt;</span>

<span class="c1"># Credentials that will be used by everest as a default to access lakeFS mount paths</span>
<span class="na">lakeFSAccessSecret</span><span class="pi">:</span>
  <span class="na">keyId</span><span class="pi">:</span> <span class="s">&lt;lakefs-key-id&gt;</span>
  <span class="na">accessKey</span><span class="pi">:</span> <span class="s">&lt;lakefs-access-key&gt;</span>
  <span class="na">endpoint</span><span class="pi">:</span> <span class="s">&lt;lakefs-endpoint&gt;</span>

<span class="na">node</span><span class="pi">:</span>
  <span class="c1"># verbosity level of the driver (normal values are 0-4, 5 would be most verbose)</span>
  <span class="na">logLevel</span><span class="pi">:</span> <span class="m">4</span>
  <span class="c1"># Only set if having issues with running or installing the everest binary </span>
  <span class="c1"># Path directory where the everest binary accessed by the underlying K8S Nodes (${everestInstallPath}/everest)</span>
  <span class="c1"># The binary will copied from the CSI pod into that location by the init container job in the node.yaml</span>
  <span class="c1"># This path will be a host path on the K8S Nodes</span>
  <span class="c1"># depending on the underlying OS and the SELinux policy the binary will be executed by systemd on the Host.</span>
  <span class="c1"># Known issue when using Bottlerocket OS https://github.com/bottlerocket-os/bottlerocket/pull/3779 </span>
  <span class="c1"># everestInstallPath: /opt/everest-mount/bin/  # should end with "/"</span>

<span class="c1"># Additional environment variables that will be passed to the driver can be used to configure the csi driver</span>
<span class="c1"># extraEnvVars:</span>
<span class="c1">#   - name: CSI_DRIVER_MOUNT_TIMEOUT</span>
<span class="c1">#     value: "30s"</span>
<span class="c1">#   - name: CSI_DRIVER_EVEREST_DEFAULT_CACHE_SIZE</span>
<span class="c1">#     value: "10000000000"</span>
<span class="c1">#   - name: VALUE_FROM_SECRET</span>
<span class="c1">#     valueFrom:</span>
<span class="c1">#       secretKeyRef:</span>
<span class="c1">#         name: secret_name</span>
<span class="c1">#         key: secret_key</span>
</code></pre></div></div>
<h3 id="3-install-the-chart-to-k8s-cluster">
  
  
    <a href="#3-install-the-chart-to-k8s-cluster" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Install the Chart to K8S cluster
  
  
</h3>
    

<p>Install the chart with the values file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm <span class="nb">install</span> <span class="nt">-f</span> values.yaml lakefs lakefs/everest-lakefs-csi-driver <span class="nt">--version</span> &lt;version&gt;
</code></pre></div></div>
<h2 id="use-in-pods">
  
  
    <a href="#use-in-pods" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use in Pods
  
  
</h2>
    

<p>Once the CSI Driver is installed, we can start using it similarly to how all <code class="language-plaintext highlighter-rouge">PersistentVolume</code> (PV) and <code class="language-plaintext highlighter-rouge">PersistentVolumeClaim</code> (PVC) are used in Kubernetes.</p>

<p>The only required argument to set is <code class="language-plaintext highlighter-rouge">lakeFSMountUri</code> in the <code class="language-plaintext highlighter-rouge">PV</code> (See examples below).</p>
<h3 id="mount-options">
  
  
    <a href="#mount-options" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mount Options
  
  
</h3>
    

<p>Most of the options are optional and can be omitted, but each mount request can be configured with <a href="https://docs.lakefs.io/reference/mount.html#mount-command">everest mount cli options</a>, they are passed as <code class="language-plaintext highlighter-rouge">mountOptions</code> in the <code class="language-plaintext highlighter-rouge">PVC</code> spec.</p>
<h3 id="examples">
  
  
    <a href="#examples" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
  
  
</h3>
    

<p>The examples demonstrates different mount sncenarios with the CSI Driver.
All of them are essentially running <code class="language-plaintext highlighter-rouge">ls &lt;mount-dir&gt;</code> and <code class="language-plaintext highlighter-rouge">tail -f /dev/null</code> in a centos container.
If the mount succeeded you will see the contents of your mount directory.</p>

<ol>
  <li>Set <code class="language-plaintext highlighter-rouge">lakeFSMountUri</code> (i.e <code class="language-plaintext highlighter-rouge">lakefs://&lt;repo&gt;/&lt;repo&gt;/[prefix/]</code>) to the lakeFS mount URI you want to mount.</li>
  <li>Run <code class="language-plaintext highlighter-rouge">kubectl apply -f values.yaml</code></li>
  <li>View the example pod logs to see the mount output <code class="language-plaintext highlighter-rouge">kubectl logs -f &lt;pod-name&gt;</code></li>
</ol>

<div class="tabs">
  <ul>
    <li><a href="#k8s-simple-pod">Single Pod and mount</a></li>
    <li><a href="#k8s-deployment-multiple-pods-one-pv">Multiple Pods, one mount (Deployment)</a></li>
    <li><a href="#k8s-multiple-mounts-one-pod">Multiple mounts, single Pod</a></li>
    <li><a href="#k8s-simple-stateful-set">StatefulSet (Advanced)</a></li>
    <li><a href="#k8s-mount-options">Mount Options</a></li>
  </ul>

  <div id="k8s-simple-pod">

    <p>Configure <code class="language-plaintext highlighter-rouge">lakeFSMountUri</code> to the target URI.</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">everest-pv</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">100Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="c1"># everest mount options goes under mountOptions and forwarded to the everest mount command </span>
  <span class="c1"># mountOptions:</span>
    <span class="c1"># set cache size in bytes </span>
    <span class="c1"># - cache-size 1000000000</span>
  <span class="na">csi</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">csi.everest.lakefs.io</span> <span class="c1"># required</span>
    <span class="na">volumeHandle</span><span class="pi">:</span> <span class="s">everest-csi-driver-volume</span>
    <span class="na">volumeAttributes</span><span class="pi">:</span>
      <span class="c1"># mount target, replace with your lakeFS mount URI</span>
      <span class="na">lakeFSMountUri</span><span class="pi">:</span> <span class="s">&lt;LAKEFS_MOUNT_URI&gt;</span>

<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolumeClaim</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">everest-claim</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="na">storageClassName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># required for static provisioning</span>
  <span class="na">resources</span><span class="pi">:</span>
    <span class="na">requests</span><span class="pi">:</span>
      <span class="na">storage</span><span class="pi">:</span> <span class="s">5Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">volumeName</span><span class="pi">:</span> <span class="s">everest-pv</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">everest-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">app</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">centos</span>
      <span class="na">command</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/bin/sh"</span><span class="pi">]</span>
      <span class="na">args</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-c"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">ls</span><span class="nv"> </span><span class="s">/data/;</span><span class="nv"> </span><span class="s">tail</span><span class="nv"> </span><span class="s">-f</span><span class="nv"> </span><span class="s">/dev/null"</span><span class="pi">]</span>
      <span class="na">volumeMounts</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage-isan</span>
          <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/data</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage-isan</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">everest-claim</span>

</code></pre></div>    </div>

  </div>
  <div id="k8s-deployment-multiple-pods-one-pv">

    <p>Configure <code class="language-plaintext highlighter-rouge">lakeFSMountUri</code> to the target URI.
In this example a deployment is created with 3 replicas, all sharing a single <code class="language-plaintext highlighter-rouge">PersistentVolume</code> and PVC 
Behind the scenes each pod get’s their own mount, even if on the same k8s node, each pod will get their own mount directory.
Unlike in StatefulSet, this can scale-up-down with no additional interference and deleted easily the same way.</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multiple-pods-one-pv</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">1200Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="c1"># everest mount options goes under mountOptions and forwarded to the everest mount command </span>
  <span class="c1"># mountOptions:</span>
  <span class="c1">#   - cache-size 1000000555</span>
  <span class="na">csi</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">csi.everest.lakefs.io</span> <span class="c1"># required</span>
    <span class="na">volumeHandle</span><span class="pi">:</span> <span class="s">everest-csi-driver-volume</span>
    <span class="na">volumeAttributes</span><span class="pi">:</span>
      <span class="c1"># mount target, replace with your lakeFS mount URI</span>
      <span class="na">lakeFSMountUri</span><span class="pi">:</span> <span class="s">&lt;LAKEFS_MOUNT_URI&gt;</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolumeClaim</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multiple-pods-one-claim</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="na">storageClassName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># required for static provisioning</span>
  <span class="na">resources</span><span class="pi">:</span>
    <span class="na">requests</span><span class="pi">:</span>
      <span class="na">storage</span><span class="pi">:</span> <span class="s">1200Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">volumeName</span><span class="pi">:</span> <span class="s">multiple-pods-one-pv</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multiple-pods-one-pv-app</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">multiple-pods-one-pv-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">multiple-pods-one-pv-app</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">multiple-pods-one-pv-app</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">multiple-pods-one-pv-app</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">centos</span>
        <span class="na">command</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/bin/sh"</span><span class="pi">]</span>
        <span class="na">args</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-c"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">ls</span><span class="nv"> </span><span class="s">/data/;</span><span class="nv"> </span><span class="s">tail</span><span class="nv"> </span><span class="s">-f</span><span class="nv"> </span><span class="s">/dev/null"</span><span class="pi">]</span>
        <span class="na">volumeMounts</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage</span>
          <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/data</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">80</span>
      <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage</span>
        <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
          <span class="na">claimName</span><span class="pi">:</span> <span class="s">multiple-pods-one-claim</span>

</code></pre></div>    </div>
  </div>
  <div id="k8s-multiple-mounts-one-pod">

    <p>Deploy a pod with two mounts to different mount points.
Configure <code class="language-plaintext highlighter-rouge">lakeFSMountUri</code> for each <code class="language-plaintext highlighter-rouge">PersistentVolume</code>.</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multiple-mounts-one-pod-pv</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">1200Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="na">mountOptions</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">cache-size </span><span class="m">1000000111</span>
  <span class="na">csi</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">csi.everest.lakefs.io</span> <span class="c1"># required</span>
    <span class="na">volumeHandle</span><span class="pi">:</span> <span class="s">everest-csi-driver-volume</span> <span class="c1"># must be unique</span>
    <span class="na">volumeAttributes</span><span class="pi">:</span>
      <span class="c1"># mount target local-lakefs dir, replace with your lakeFS mount URI</span>
      <span class="na">lakeFSMountUri</span><span class="pi">:</span> <span class="s">&lt;LAKEFS_URI_1&gt;</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolumeClaim</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multple-mounts-one-pod-claim</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="na">storageClassName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># required for static provisioning</span>
  <span class="na">resources</span><span class="pi">:</span>
    <span class="na">requests</span><span class="pi">:</span>
      <span class="na">storage</span><span class="pi">:</span> <span class="s">1200Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">volumeName</span><span class="pi">:</span> <span class="s">multiple-mounts-one-pod-pv</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multiple-mounts-one-pod-pv-2</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">1200Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># ReadOnlyMany</span>
  <span class="na">mountOptions</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">cache-size </span><span class="m">1000000555</span>
  <span class="na">csi</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">csi.everest.lakefs.io</span> <span class="c1"># required</span>
    <span class="na">volumeHandle</span><span class="pi">:</span> <span class="s">everest-csi-driver-volume-2</span> <span class="c1"># must be unique</span>
    <span class="na">volumeAttributes</span><span class="pi">:</span>
      <span class="c1"># mount target images dir, replace with your lakeFS mount URI</span>
      <span class="na">lakeFSMountUri</span><span class="pi">:</span> <span class="s">&lt;LAKEFS_URI_2&gt;</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolumeClaim</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">multple-mounts-one-pod-claim-2</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="na">storageClassName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># required for static provisioning</span>
  <span class="na">resources</span><span class="pi">:</span>
    <span class="na">requests</span><span class="pi">:</span>
      <span class="na">storage</span><span class="pi">:</span> <span class="s">1200Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">volumeName</span><span class="pi">:</span> <span class="s">multiple-mounts-one-pod-pv-2</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">everest-multi-mounts-one-pod</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">app</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">centos</span>
      <span class="na">command</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/bin/sh"</span><span class="pi">]</span>
      <span class="na">args</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-c"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">ls</span><span class="nv"> </span><span class="s">/data/;</span><span class="nv"> </span><span class="s">ls</span><span class="nv"> </span><span class="s">/data2/;</span><span class="nv"> </span><span class="s">tail</span><span class="nv"> </span><span class="s">-f</span><span class="nv"> </span><span class="s">/dev/null"</span><span class="pi">]</span>
      <span class="na">volumeMounts</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage</span>
          <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/data</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage-2</span>
          <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/data2</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">multple-mounts-one-pod-claim</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">persistent-storage-2</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">multple-mounts-one-pod-claim-2</span>

</code></pre></div>    </div>

  </div>
  <div id="k8s-simple-stateful-set">

    <p>Configure <code class="language-plaintext highlighter-rouge">lakeFSMountUri</code> to the target URI.
Because of the neuances described below, if not required it is best to avoid using a <code class="language-plaintext highlighter-rouge">StatefulSet</code>.</p>

    <p><strong>Deletion:</strong></p>

    <p>It’s <a href="https://kubernetes.io/docs/tasks/run-application/delete-stateful-set/#complete-deletion-of-a-statefulset">intended behavior</a> for StatefulSet in K8S that the PVC is not deleted automatically when the pod is deleted since the StatefulSet controller does not manage the PVC.
To completley delete use k delete with –force flag or first delete the PVC: ‘kubectl delete pvc -l app=sts-app-simple-everest’</p>

    <p><strong>Scale Down:</strong></p>

    <p>replicas: 0 can be set to scale down the StatefulSet and bring back up with replicas: 1.</p>

    <p><strong>Replicas &gt; 1:</strong></p>

    <p>not supported in this example, since the driver only supports static provisoning. 
to use Statefulset with replica &gt; 1 we need to add PersistentVolume(s) manually.</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">sts-simple-mount</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">sts-app-simple-everest</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">100Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="na">mountOptions</span><span class="pi">:</span>
    <span class="c1"># override default cache size for the mount (in bytes)</span>
    <span class="pi">-</span> <span class="s">cache-size </span><span class="m">1000000555</span>
    <span class="pi">-</span> <span class="s">log-level debug</span>
  <span class="na">csi</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">csi.everest.lakefs.io</span> <span class="c1"># required</span>
    <span class="na">volumeHandle</span><span class="pi">:</span> <span class="s">everest-csi-driver-volume</span>
    <span class="na">volumeAttributes</span><span class="pi">:</span>
      <span class="c1"># mount target, replace with your lakeFS mount URI</span>
      <span class="na">lakeFSMountUri</span><span class="pi">:</span> <span class="s">&lt;LAKEFS_MOUNT_URI&gt;</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">StatefulSet</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">sts-app-simple-everest</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">sts-app-simple-everest</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">sts-app-simple-everest</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">app</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">centos</span>
          <span class="na">command</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/bin/sh"</span><span class="pi">]</span>
          <span class="na">args</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-c"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">ls</span><span class="nv"> </span><span class="s">/data/;</span><span class="nv"> </span><span class="s">tail</span><span class="nv"> </span><span class="s">-f</span><span class="nv"> </span><span class="s">/dev/null"</span><span class="pi">]</span>
          <span class="na">volumeMounts</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">sts-simple-mount</span>
              <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/data</span>
  <span class="na">volumeClaimTemplates</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">name</span><span class="pi">:</span> <span class="s">sts-simple-mount</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">selector</span><span class="pi">:</span>
        <span class="na">matchLabels</span><span class="pi">:</span>
          <span class="na">app</span><span class="pi">:</span> <span class="s">sts-app-simple-everest</span>
      <span class="na">storageClassName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># required for static provisioning</span>
      <span class="na">accessModes</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">ReadOnlyMany"</span> <span class="pi">]</span>
      <span class="na">resources</span><span class="pi">:</span>
        <span class="na">requests</span><span class="pi">:</span>
          <span class="na">storage</span><span class="pi">:</span> <span class="s">5Gi</span> <span class="c1"># ignored, required</span>

</code></pre></div>    </div>
  </div>

  <div id="k8s-mount-options">

    <p>This demonstrates common flags and uncommon flags that can be used for a mount.
In general, the flags are set in <code class="language-plaintext highlighter-rouge">mountOptions</code> and are passed to the everest <a href="https://docs.lakefs.io/reference/mount.html#mount-command">mount command</a>.</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">options-demo-pv</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">100Gi</span> <span class="c1"># ignored, required</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadOnlyMany</span> <span class="c1"># supported options: ReadOnlyMany</span>
  <span class="c1"># everest mount options goes under mountOptions and forwarded to the everest mount command </span>
  <span class="na">mountOptions</span><span class="pi">:</span>
    <span class="c1"># set cache size in bytes </span>
    <span class="pi">-</span> <span class="s">cache-size </span><span class="m">10000000</span>
    <span class="c1"># set log level to debug when inspecting mount logs (very noisy!)</span>
    <span class="pi">-</span> <span class="s">log-level trace</span>
    <span class="c1"># WARN: lakeFS credentials / endpoint should be managed securely by the CSI-driver, this is an advanced flag use-case</span>
    <span class="c1"># override default lakeFS credentials (for use-cases where the default csi-driver credentials are not sufficient)</span>
    <span class="pi">-</span> <span class="s">lakectl-access-key-id &lt;LAKEFS_ACCESS_KEY_ID&gt;</span>
    <span class="pi">-</span> <span class="s">lakectl-secret-access-key &lt;LAKEFS_SECRET_ACCESS_KEY&gt;</span>
    <span class="pi">-</span> <span class="s">lakectl-server-url &lt;LAKEFS_ENDPOINT&gt;</span>
    <span class="c1"># WARN: an advanced flag and rarelly needed if at all, performs mount directly using fuser relying on it to exist on the host server without using FUSE syscalls</span>
    <span class="c1"># be default fuse-direct-mount is true</span>
    <span class="c1"># - fuse-direct-mount false</span>
    <span class="c1"># - mount-gid 2000</span>
    <span class="c1"># - mount-uid 1000</span>
    <span class="c1"># - presign false</span>
    <span class="c1"># - log-enable-syslog false</span>

  <span class="na">csi</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">csi.everest.lakefs.io</span> <span class="c1"># required</span>
    <span class="na">volumeHandle</span><span class="pi">:</span> <span class="s">everest-csi-driver-volume</span>
    <span class="na">volumeAttributes</span><span class="pi">:</span>
      <span class="c1"># mount target, staging org (non default credentials on csi), replace with your lakeFS mount URI</span>
      <span class="na">lakeFSMountUri</span><span class="pi">:</span> <span class="s">&lt;LAKEFS_MOUNT_URI&gt;</span>

<span class="c1"># REST OF THE RESOURCES</span>
<span class="c1"># ... </span>
</code></pre></div>    </div>
  </div>

</div>
<h2 id="troubleshooting">
  
  
    <a href="#troubleshooting" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Troubleshooting
  
  
</h2>
    

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">kubectl</code> and check the CSI driver pod and failed Pod for logs and events.</li>
  <li>If a specific mount request failed, specifically inspect csi-node that the failed mount pod was deployed on.</li>
  <li>Check the events and status of the <code class="language-plaintext highlighter-rouge">PVC</code> and <code class="language-plaintext highlighter-rouge">PV</code> of the failing pod <code class="language-plaintext highlighter-rouge">kubectl get pv &amp;&amp; kubectl get pvc</code></li>
</ul>

<p><strong>Advanced: SSH into the underlying K8S node:</strong></p>

<p>Find the failed mount service <code class="language-plaintext highlighter-rouge">systemctl list-units --type=service</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>everest-lakefs-mount-0.0.8-everest-123.service loaded active running CSI driver FUSE daemon
</code></pre></div></div>
<p>Get systemd service status:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># service name example: everest-lakefs-mount-0.0.8-everest-123.service</span>
systemctl status &lt;service&gt;

<span class="c"># output contains many things including the exec command to run, example:</span>
<span class="c"># ExecStart=/opt/bin/everest mount lakefs://test-mount/main/local-lakefs/ /var/lib/kubelet/pods/123/volumes/kubernetes.io~csi/everest-pv/mount --log-level=trace --cache-dir=/var/lib/kubelet/pods/123/volumes/kubernetes.io~csi/everest-pv/.everest --lakectl-config=/opt/mountpoint-s3-csi/bin/lakectl.yaml</span>
</code></pre></div></div>

<p>See systemd logs of a service:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>journalctl <span class="nt">-f</span> <span class="nt">-u</span> &lt;service&gt;

<span class="c"># example:</span>
journalctl <span class="nt">-f</span> <span class="nt">-u</span> everest-lakefs-mount-0.0.8-everest-123.service
</code></pre></div></div>

<!-- END EXCLUDE FROM TOC -->

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button" >
                            <img src="/v1.45/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/v1.45/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/v1.45/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/v1.45/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/v1.45/assets/icons/github.svg" class="no-hover" />
                            <img src="/v1.45/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/v1.45/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/v1.45/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://data-folks.masto.host/@lakeFS" class="site-button" >
                            <img src="/v1.45/assets/icons/mastodon.svg" class="no-hover" />
                            <img src="/v1.45/assets/icons/mastodon-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/v1.45/assets/icons/slack.svg" class="no-hover" />
                            <img src="/v1.45/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>


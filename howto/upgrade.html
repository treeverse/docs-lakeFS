

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Upgrade lakeFS | lakeFS</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Upgrade lakeFS" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A guide to upgrading lakeFS to the latest version." />
<meta property="og:description" content="A guide to upgrading lakeFS to the latest version." />
<meta property="og:site_name" content="lakeFS" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Upgrade lakeFS" />
<script type="application/ld+json">
{"description":"A guide to upgrading lakeFS to the latest version.","@type":"WebPage","headline":"Upgrade lakeFS","url":"/howto/upgrade.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/logo.svg"}},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->
<meta property="og:image" content="/assets/img/shared-image.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script src="/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/assets/js/feedback.js"></script>
<link href="https://data-folks.masto.host/@lakeFS" rel="me">

</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS" aria-label="Search lakeFS"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/"
           class="nav-list-link">What is lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/quickstart/"
           class="nav-list-link">‚≠ê Quickstart ‚≠ê</a><ul class="nav-list "><li class="nav-list-item "><a href="/quickstart/launch.html"
                   class="nav-list-link">1Ô∏è‚É£ Run lakeFS</a></li><li class="nav-list-item "><a href="/quickstart/query.html"
                   class="nav-list-link">2Ô∏è‚É£ Query the data</a></li><li class="nav-list-item "><a href="/quickstart/branch.html"
                   class="nav-list-link">3Ô∏è‚É£ Create a branch</a></li><li class="nav-list-item "><a href="/quickstart/commit-and-merge.html"
                   class="nav-list-link">4Ô∏è‚É£ Commit and Merge</a></li><li class="nav-list-item "><a href="/quickstart/rollback.html"
                   class="nav-list-link">5Ô∏è‚É£ Roll back Changes</a></li><li class="nav-list-item "><a href="/quickstart/learning-more-lakefs.html"
                   class="nav-list-link">üßëüèª‚Äçüéì Learn more about lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/deploy/"
           class="nav-list-link">Deploy and Setup lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/deploy/aws.html"
                   class="nav-list-link">AWS</a></li><li class="nav-list-item "><a href="/deploy/azure.html"
                   class="nav-list-link">Azure</a></li><li class="nav-list-item "><a href="/deploy/gcp.html"
                   class="nav-list-link">GCP</a></li><li class="nav-list-item "><a href="/deploy/onprem.html"
                   class="nav-list-link">On-Premises Deployment of lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/integrations/spark.html"
                   class="nav-list-link">Spark</a></li><li class="nav-list-item "><a href="/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/integrations/airflow.html"
                   class="nav-list-link">Airflow</a></li><li class="nav-list-item "><a href="/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/integrations/presto_trino.html"
                   class="nav-list-link">Presto/Trino</a></li><li class="nav-list-item "><a href="/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/integrations/dbt.html"
                   class="nav-list-link">dbt</a></li><li class="nav-list-item "><a href="/integrations/kakfa.html"
                   class="nav-list-link">Kafka</a></li><li class="nav-list-item "><a href="/integrations/sagemaker.html"
                   class="nav-list-link">SageMaker</a></li><li class="nav-list-item "><a href="/integrations/hive.html"
                   class="nav-list-link">Hive</a></li><li class="nav-list-item "><a href="/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/integrations/iceberg.html"
                   class="nav-list-link">Iceberg</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/hooks/"
           class="nav-list-link">Hooks</a><ul class="nav-list "><li class="nav-list-item "><a href="/hooks/overview.html"
                   class="nav-list-link">Overview</a></li><li class="nav-list-item "><a href="/hooks/lua.html"
                   class="nav-list-link">Lua</a></li><li class="nav-list-item "><a href="/hooks/webhooks.html"
                   class="nav-list-link">Webhooks</a></li><li class="nav-list-item "><a href="/hooks/airflow.html"
                   class="nav-list-link">Airflow</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/use_cases/"
           class="nav-list-link">Use Cases</a><ul class="nav-list "><li class="nav-list-item "><a href="/use_cases/etl_testing.html"
                   class="nav-list-link">ETL Testing Environment</a></li><li class="nav-list-item "><a href="/use_cases/rollback.html"
                   class="nav-list-link">Rollback</a></li><li class="nav-list-item "><a href="/use_cases/reproducibility.html"
                   class="nav-list-link">Reproducibility</a></li><li class="nav-list-item "><a href="/use_cases/cicd_for_data.html"
                   class="nav-list-link">CI/CD for data lakes</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="/howto/import.html"
                   class="nav-list-link">Import data into lakeFS</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/howto/garbage-collection-index.html"
                   class="nav-list-link">Garbage Collection</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/howto/garbage-collection-committed.html"
                           class="nav-list-link">Committed Objects</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/garbage-collection-uncommitted.html"
                           class="nav-list-link">Uncommitted Objects</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/gc-internals.html"
                           class="nav-list-link">Committed GC Internals</a>
                    </li></ul></li><li class="nav-list-item  active"><a href="/howto/upgrade.html"
                   class="nav-list-link active">Upgrade lakeFS</a></li><li class="nav-list-item "><a href="/howto/export.html"
                   class="nav-list-link">Exporting Data</a></li><li class="nav-list-item "><a href="/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/howto/protect-branches.html"
                   class="nav-list-link">Protect Branches</a></li><li class="nav-list-item "><a href="/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/reference/configuration.html"
                   class="nav-list-link">Server Configuration</a></li><li class="nav-list-item "><a href="/reference/cli.html"
                   class="nav-list-link">lakectl (lakeFS command-line tool)</a></li><li class="nav-list-item "><a href="/reference/api.html"
                   class="nav-list-link">API Reference</a></li><li class="nav-list-item "><a href="/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/reference/s3.html"
                   class="nav-list-link">S3 Supported API</a></li><li class="nav-list-item "><a href="/reference/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/reference/saml-authentication-integration.html"
                   class="nav-list-link">SAML Authentication Integration</a></li><li class="nav-list-item "><a href="/reference/remote-authenticator.html"
                   class="nav-list-link">Remote Authenticator</a></li><li class="nav-list-item "><a href="/reference/rbac.html"
                   class="nav-list-link">Role-Based Access Control (RBAC)</a></li><li class="nav-list-item "><a href="/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/reference/access-control-lists.html"
                   class="nav-list-link">Access Control Lists (ACL)</a></li><li class="nav-list-item "><a href="/reference/audit.html"
                   class="nav-list-link">Audit Logs</a></li><li class="nav-list-item "><a href="/reference/presigned-url.html"
                   class="nav-list-link">Presigned URL</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/understand/model.html"
                   class="nav-list-link">Model</a></li><li class="nav-list-item "><a href="/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/how/"
                   class="nav-list-link">How it Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li></ul></li><li class="nav-list-item "><a href="/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li></ul></li><li
            class="nav-list-item"><a href="/roadmap.html"
           class="nav-list-link">Roadmap</a></li><li
            class="nav-list-item"><a href="/commitment.html"
           class="nav-list-link">Commitment to OSS</a></li><li
            class="nav-list-item"><a href="/contributing.html"
           class="nav-list-link">Contributing</a></li><li
            class="nav-list-item"><a href="/faq.html"
           class="nav-list-link">FAQ</a></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="/quickstart" class="site-button" >
                Get Started
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="/quickstart" class="site-button" >
                Get Started
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/howto/">How-To</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Upgrade lakeFS</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 class="no_toc" id="upgrading-lakefs">
  
  
    <a href="#upgrading-lakefs" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Upgrading lakeFS
  
  
</h1>
    

<p class="note">Note: For a fully managed lakeFS service with guaranteed SLAs, try <a href="https://lakefs.cloud">lakeFS cloud</a></p>

<p>Upgrading lakeFS from a previous version usually just requires re-deploying with the latest image (or downloading the latest version if you‚Äôre using the binary).
If you‚Äôre upgrading, check whether the <a href="https://github.com/treeverse/lakeFS/releases">release</a> requires a migration.</p>
<h2 id="when-db-migrations-are-required">
  
  
    <a href="#when-db-migrations-are-required" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> When DB migrations are required
  
  
</h2>
    
<h3 id="lakefs-0800-or-greater-kv-migration">
  
  
    <a href="#lakefs-0800-or-greater-kv-migration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> lakeFS 0.80.0 or greater (KV Migration)
  
  
</h3>
    

<p>Starting with version 0.80.2, lakeFS has transitioned from using a PostgreSQL based database implementation to a Key-Value datastore interface supporting
multiple database implementations. More information can be found <a href="https://github.com/treeverse/lakeFS/blob/master/design/accepted/metadata_kv/index.md">here</a>.<br />
Users upgrading from a previous version of lakeFS must pass through the KV migration version (0.80.2) before upgrading to newer versions of lakeFS.</p>

<blockquote class="note">
  <p><strong>IMPORTANT: Pre Migrate Requirements</strong></p>
  <ul>
    <li><strong>Users using OS environment variables for database configuration must define the <code class="language-plaintext highlighter-rouge">connection_string</code> explicitly or as environment variable before proceeding with the migration.</strong></li>
    <li><strong>Database storage free capacity of at least twice the amount of the currently used capacity</strong></li>
    <li>It is strongly recommended to perform these additional steps:
      <ul>
        <li>Commit all uncommitted data on branches</li>
        <li>Create a snapshot of your database</li>
      </ul>
    </li>
    <li>By default, old database tables are not being deleted by the migration process, and should be removed manually after a successful migration.
To enable table drop as part of the migration, set the <code class="language-plaintext highlighter-rouge">database.drop_tables</code> configuration param to <code class="language-plaintext highlighter-rouge">true</code></li>
  </ul>
</blockquote>
<h4 id="migration-steps">
  
  
    <a href="#migration-steps" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Migration Steps
  
  
</h4>
    
<p>For each lakeFS instance currently running with the database</p>
<ol>
  <li>Modify the <code class="language-plaintext highlighter-rouge">database</code> section under lakeFS configuration yaml:
    <ol>
      <li>Add <code class="language-plaintext highlighter-rouge">type</code> field with <code class="language-plaintext highlighter-rouge">"postgres"</code> as value</li>
      <li>Copy the current configuration parameters to a new section called <code class="language-plaintext highlighter-rouge">postgres</code></li>
    </ol>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">database</span><span class="pi">:</span>
 <span class="na">type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres"</span>
 <span class="na">connection_string</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres://localhost:5432/postgres?sslmode=disable"</span>
 <span class="na">max_open_connections</span><span class="pi">:</span> <span class="m">20</span>
   
 <span class="na">postgres</span><span class="pi">:</span>
   <span class="na">connection_string</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres://localhost:5432/postgres?sslmode=disable"</span>
   <span class="na">max_open_connections</span><span class="pi">:</span> <span class="m">20</span>
</code></pre></div>    </div>
  </li>
  <li>Stop all lakeFS instances</li>
  <li>
    <p>Using the <code class="language-plaintext highlighter-rouge">lakefs</code> binary for the new version (0.80.2), run the following:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs migrate up
</code></pre></div>    </div>
  </li>
  <li>
    <p>lakeFS will run the migration process, which in the end should display the following message with no errors:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">time</span><span class="o">=</span><span class="s2">"2022-08-10T14:46:25Z"</span> <span class="nv">level</span><span class="o">=</span>info <span class="nv">msg</span><span class="o">=</span><span class="s2">"KV Migration took 717.629563ms"</span> <span class="nv">func</span><span class="o">=</span><span class="s2">"pkg/logging.(*logrusEntryWrapper).Infof"</span> <span class="nv">file</span><span class="o">=</span><span class="s2">"build/pkg/logging/logger.go:246"</span> <span class="nv">TempDir</span><span class="o">=</span>/tmp/kv_migrate_2913402680
</code></pre></div>    </div>
  </li>
  <li>
    <p>It is now possible to remove the old database configuration. The updated configuration should look as such:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">database</span><span class="pi">:</span>
 <span class="na">type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres"</span>
   
 <span class="na">postgres</span><span class="pi">:</span>
   <span class="na">connection_string</span><span class="pi">:</span> <span class="s2">"</span><span class="s">postgres://localhost:5432/postgres?sslmode=disable"</span>
   <span class="na">max_open_connections</span><span class="pi">:</span> <span class="m">20</span>
</code></pre></div>    </div>
  </li>
  <li>Deploy (or run) the new version of lakeFS.</li>
</ol>
<h3 id="lakefs-0300-or-greater">
  
  
    <a href="#lakefs-0300-or-greater" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> lakeFS 0.30.0 or greater
  
  
</h3>
    

<p>In case migration is required, you first need to stop the running lakeFS service.
Using the <code class="language-plaintext highlighter-rouge">lakefs</code> binary for the new version, run the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs migrate up
</code></pre></div></div>

<p>Deploy (or run) the new version of lakeFS.</p>

<p>Note that an older version of lakeFS cannot run on a migrated database.</p>
<h3 id="prior-to-lakefs-0300">
  
  
    <a href="#prior-to-lakefs-0300" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prior to lakeFS 0.30.0
  
  
</h3>
    

<p class="note pb-3"><strong>Note:</strong> with lakeFS &lt; 0.30.0, you should first upgrade to 0.30.0 following this guide. Then, proceed to upgrade to the newest version.</p>

<p>Starting version 0.30.0, lakeFS handles your committed metadata in a <a href="https://docs.google.com/document/d/1jzD7-jun-tdU5BGapmnMBe9ovSzBvTNjXCcVztV07A4/edit?usp=sharing" target="_blank">new way</a>, which is more robust and has better performance.
To move your existing data, you will need to run the following upgrade commands.</p>

<p>Verify lakeFS version == 0.30.0 (can skip if using Docker)</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs <span class="nt">--version</span>
</code></pre></div></div>

<p>Migrate data from the previous format:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs migrate db
</code></pre></div></div>

<p>Or migrate using Docker image:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--rm</span> <span class="nt">-it</span> <span class="nt">-e</span> <span class="nv">LAKEFS_DATABASE_CONNECTION_STRING</span><span class="o">=</span>&lt;database connection string&gt; treeverse/lakefs:rocks-migrate migrate db
</code></pre></div></div>

<p>Once migrated, it is possible to now use more recent lakeFS versions. Please refer to their release notes for more information on ugrading and usage).</p>

<p>If you want to start over, discarding your existing data, you need to explicitly state this in your lakeFS configuration file.
To do so, add the following to your configuration (relevant <strong>only</strong> for 0.30.0):</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">cataloger</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">rocks</span>
</code></pre></div></div>
<h2 id="data-migration-for-version-v0500">
  
  
    <a href="#data-migration-for-version-v0500" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Data Migration for Version v0.50.0
  
  
</h2>
    

<p>We discovered a bug in the way lakeFS is storing objects in the underlying object store.
It affects only repositories on Azure and GCP, and not all of them.
<a href="https://github.com/treeverse/lakeFS/issues/2397#issuecomment-908397229">Issue #2397</a> describes the repository storage namespaces patterns 
that are affected by this bug.</p>

<p>When first upgrading to a version greater or equal to v0.50.0, you must follow these steps:</p>
<ol>
  <li>Stop lakeFS.</li>
  <li>Perform a data migration (details below)</li>
  <li>Start lakeFS with the new version.</li>
  <li>After a successful run of the new version and validation that the objects are accessible, you can delete the old data prefix.</li>
</ol>

<p class="note pb-3">Note: Migrating data is a delicate procedure. The lakeFS team is here to help, reach out to us on Slack.
We‚Äôll be happy to walk you through the process.</p>
<h3 id="data-migration">
  
  
    <a href="#data-migration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Data migration
  
  
</h3>
    

<p>The following patterns have been impacted by the bug:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Storage Namespace pattern</th>
      <th>Copy From</th>
      <th>Copy To</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>gs</td>
      <td>gs://bucket/prefix</td>
      <td>gs://bucket//prefix/*</td>
      <td>gs://bucket/prefix/*</td>
    </tr>
    <tr>
      <td>gs</td>
      <td>gs://bucket/prefix/</td>
      <td>gs://bucket//prefix/*</td>
      <td>gs://bucket/prefix/*</td>
    </tr>
    <tr>
      <td>azure</td>
      <td>https://account.blob.core.windows.net/containerid</td>
      <td>https://account.blob.core.windows.net/containerid//*</td>
      <td>https://account.blob.core.windows.net/containerid/*</td>
    </tr>
    <tr>
      <td>azure</td>
      <td>https://account.blob.core.windows.net/containerid/</td>
      <td>https://account.blob.core.windows.net/containerid//*</td>
      <td>https://account.blob.core.windows.net/containerid/*</td>
    </tr>
    <tr>
      <td>azure</td>
      <td>https://account.blob.core.windows.net/containerid/prefix/</td>
      <td>https://account.blob.core.windows.net/containerid/prefix//</td>
      <td>https://account.blob.core.windows.net/containerid/prefix/*</td>
    </tr>
  </tbody>
</table></div>

<p>You can find the repositories storage namespaces with:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakectl repo list
</code></pre></div></div>

<p>Or the settings tab in the UI.</p>
<h4 id="migrating-google-storage-data-with-gsutil">
  
  
    <a href="#migrating-google-storage-data-with-gsutil" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Migrating Google Storage data with gsutil
  
  
</h4>
    

<p><a href="https://cloud.google.com/storage/docs/gsutil">gsutil</a> is a Python application that lets you access Cloud Storage from the command line.
We can use it for copying the data between the prefixes in the Google bucket, and later on removing it.</p>

<p>For every affected repository, copy its data with:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gsutil <span class="nt">-m</span> <span class="nb">cp</span> <span class="nt">-r</span> gs://&lt;BUCKET&gt;//&lt;PREFIX&gt;/ gs://&lt;BUCKET&gt;/
</code></pre></div></div>

<p>Note the double slash after the bucket name.</p>
<h4 id="migrating-azure-blob-storage-data-with-azcopy">
  
  
    <a href="#migrating-azure-blob-storage-data-with-azcopy" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Migrating Azure Blob Storage data with AzCopy
  
  
</h4>
    

<p><a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-use-azcopy-v10">AzCopy</a> is a command-line utility that you can use to copy blobs or files to or from a storage account.
We can use it for copying the data between the prefixes in the Azure storage account container, and later on removing it.</p>

<p>First, you need to acquire an <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview#account-sas">Account SAS</a>.
Using the Azure CLI:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az storage container generate-sas <span class="se">\</span>
    <span class="nt">--account-name</span> &lt;ACCOUNT&gt; <span class="se">\</span>
    <span class="nt">--name</span> &lt;CONTAINER&gt; <span class="se">\</span>
    <span class="nt">--permissions</span> cdrw <span class="se">\</span>
    <span class="nt">--auth-mode</span> key <span class="se">\</span>
    <span class="nt">--expiry</span> 2021-12-31
</code></pre></div></div>

<p>With the resulted SAS, use AzCopy to copy the files.
If a prefix exists after the container:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>azcopy copy <span class="se">\</span>
<span class="s2">"https://&lt;ACCOUNT&gt;.blob.core.windows.net/&lt;CONTAINER&gt;/&lt;PREFIX&gt;//?&lt;SAS_TOKEN&gt;"</span> <span class="se">\</span>
<span class="s2">"https://&lt;ACCOUNT&gt;.blob.core.windows.net/&lt;CONTAINER&gt;?&lt;SAS_TOKEN&gt;"</span> <span class="se">\</span>
<span class="nt">--recursive</span><span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<p>Or when using the container without a prefix:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>azcopy copy <span class="se">\</span>
<span class="s2">"https://&lt;ACCOUNT&gt;.blob.core.windows.net/&lt;CONTAINER&gt;//?&lt;SAS_TOKEN&gt;"</span> <span class="se">\</span>
<span class="s2">"https://&lt;ACCOUNT&gt;.blob.core.windows.net/&lt;CONTAINER&gt;/./?&lt;SAS_TOKEN&gt;"</span> <span class="se">\</span>
<span class="nt">--recursive</span><span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button" >
                            <img src="/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/assets/icons/github.svg" class="no-hover" />
                            <img src="/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://data-folks.masto.host/@lakeFS" class="site-button" >
                            <img src="/assets/icons/mastodon.svg" class="no-hover" />
                            <img src="/assets/icons/mastodon-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/assets/icons/slack.svg" class="no-hover" />
                            <img src="/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>




<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  

  <link rel="shortcut icon" href="/v0.70/favicon.ico" type="image/x-icon">


  <link rel="stylesheet" href="/v0.70/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/v0.70/assets/js/vendor/lunr.min.js"></script>
  

  

  <script type="text/javascript" src="/v0.70/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>S3 Virtual-host addressing (advanced) | lakeFS</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="S3 Virtual-host addressing (advanced)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Configure the lakeFS S3 API to use virtual-host addressing." />
<meta property="og:description" content="Configure the lakeFS S3 API to use virtual-host addressing." />
<meta property="og:site_name" content="lakeFS" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="S3 Virtual-host addressing (advanced)" />
<script type="application/ld+json">
{"description":"Configure the lakeFS S3 API to use virtual-host addressing.","headline":"S3 Virtual-host addressing (advanced)","@type":"WebPage","url":"/v0.70/setup/virtual-host-addressing.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/v0.70/assets/logo.svg"}},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->
<meta property="og:image" content="/v0.70/assets/img/shared-image.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/js/fontawesome.min.js" integrity="sha512-i3N2a3sMtKOQHXCJF3qEpce5twcGN9mRsWQe6PUTf9WS/eG5XkivI97uxit7B2nRGz5XuoszBaqndSqxdeVfag==" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<script src="/v0.70/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>


</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS" aria-label="Search lakeFS"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/v0.70/"
           class="nav-list-link">What is lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/quickstart/"
           class="nav-list-link">Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.70/quickstart/try.html"
                   class="nav-list-link">Try without installing</a></li><li class="nav-list-item "><a href="/v0.70/quickstart/installing.html"
                   class="nav-list-link">Install lakeFS</a></li><li class="nav-list-item "><a href="/v0.70/quickstart/repository.html"
                   class="nav-list-link">Create a Repository</a></li><li class="nav-list-item "><a href="/v0.70/quickstart/add_data.html"
                   class="nav-list-link">Add Data</a></li><li class="nav-list-item "><a href="/v0.70/quickstart/first_commit.html"
                   class="nav-list-link">Commit the Changes</a></li><li class="nav-list-item "><a href="/v0.70/quickstart/more_quickstart_options.html"
                   class="nav-list-link">More Quickstart Options</a></li></ul></li><li
            class="nav-list-item"><a href="/v0.70/spark/"
           class="nav-list-link">Spark</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/deploy/"
           class="nav-list-link">Deploy lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.70/deploy/aws.html"
                   class="nav-list-link">On AWS</a></li><li class="nav-list-item "><a href="/v0.70/deploy/azure.html"
                   class="nav-list-link">On Azure</a></li><li class="nav-list-item "><a href="/v0.70/deploy/gcp.html"
                   class="nav-list-link">On GCP</a></li><li class="nav-list-item "><a href="/v0.70/deploy/k8s.html"
                   class="nav-list-link">With Kubernetes</a></li><li class="nav-list-item "><a href="/v0.70/deploy/docker.html"
                   class="nav-list-link">With Docker</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/setup/"
           class="nav-list-link">Set up lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v0.70/setup/storage/"
                   class="nav-list-link">Prepare Your Storage</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v0.70/setup/storage/s3.html"
                           class="nav-list-link">AWS S3</a>
                    </li><li class="nav-list-item ">
                        <a href="/v0.70/setup/storage/gcs.html"
                           class="nav-list-link">Google Cloud Storage</a>
                    </li><li class="nav-list-item ">
                        <a href="/v0.70/setup/storage/blob.html"
                           class="nav-list-link">Azure Blob Storage</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v0.70/setup/create-repo.html"
                   class="nav-list-link">Create a Repository</a></li><li class="nav-list-item "><a href="/v0.70/setup/import.html"
                   class="nav-list-link">Import data into lakeFS</a></li><li class="nav-list-item "><a href="/v0.70/setup/hooks.html"
                   class="nav-list-link">Hooks</a></li><li class="nav-list-item  active"><a href="/v0.70/setup/virtual-host-addressing.html"
                   class="nav-list-link active">S3 Virtual-host addressing (advanced)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/using_lakefs/"
           class="nav-list-link">Using lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.70/using_lakefs/data-devenv.html"
                   class="nav-list-link">In Development</a></li><li class="nav-list-item "><a href="/v0.70/using_lakefs/ci.html"
                   class="nav-list-link">During Deployment</a></li><li class="nav-list-item "><a href="/v0.70/using_lakefs/production.html"
                   class="nav-list-link">In Production</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/use_cases/"
           class="nav-list-link">Use Cases</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.70/use_cases/iso_env.html"
                   class="nav-list-link">Isolated Environment</a></li><li class="nav-list-item "><a href="/v0.70/use_cases/rollback.html"
                   class="nav-list-link">Rollback</a></li><li class="nav-list-item "><a href="/v0.70/use_cases/reproducibility.html"
                   class="nav-list-link">Reproducibility</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.70/reference/api.html"
                   class="nav-list-link">API Reference</a></li><li class="nav-list-item "><a href="/v0.70/reference/s3.html"
                   class="nav-list-link">S3 Supported API</a></li><li class="nav-list-item "><a href="/v0.70/reference/configuration.html"
                   class="nav-list-link">Configuration Reference</a></li><li class="nav-list-item "><a href="/v0.70/reference/commands.html"
                   class="nav-list-link">Command (CLI) Reference</a></li><li class="nav-list-item "><a href="/v0.70/reference/protected_branches.html"
                   class="nav-list-link">Protected Branches</a></li><li class="nav-list-item "><a href="/v0.70/reference/export.html"
                   class="nav-list-link">Exporting Data</a></li><li class="nav-list-item "><a href="/v0.70/reference/garbage-collection.html"
                   class="nav-list-link">Garbage Collection</a></li><li class="nav-list-item "><a href="/v0.70/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/v0.70/reference/offboarding.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/v0.70/reference/upgrade.html"
                   class="nav-list-link">Upgrade lakeFS</a></li><li class="nav-list-item "><a href="/v0.70/reference/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/v0.70/reference/authorization.html"
                   class="nav-list-link">Authorization</a></li><li class="nav-list-item "><a href="/v0.70/reference/oidc.html"
                   class="nav-list-link">OIDC support</a></li><li class="nav-list-item "><a href="/v0.70/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.70/integrations/distcp.html"
                   class="nav-list-link">Copying Data with DistCp</a></li><li class="nav-list-item "><a href="/v0.70/integrations/rclone.html"
                   class="nav-list-link">Copying data with Rclone</a></li><li class="nav-list-item "><a href="/v0.70/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/v0.70/integrations/spark.html"
                   class="nav-list-link">Spark</a></li><li class="nav-list-item "><a href="/v0.70/integrations/hive.html"
                   class="nav-list-link">Hive</a></li><li class="nav-list-item "><a href="/v0.70/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/v0.70/integrations/emr.html"
                   class="nav-list-link">EMR</a></li><li class="nav-list-item "><a href="/v0.70/integrations/presto_trino.html"
                   class="nav-list-link">Presto/Trino</a></li><li class="nav-list-item "><a href="/v0.70/integrations/boto.html"
                   class="nav-list-link">Boto (Python)</a></li><li class="nav-list-item "><a href="/v0.70/integrations/minio.html"
                   class="nav-list-link">MinIO</a></li><li class="nav-list-item "><a href="/v0.70/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/v0.70/integrations/airflow.html"
                   class="nav-list-link">Airflow</a></li><li class="nav-list-item "><a href="/v0.70/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/v0.70/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/v0.70/integrations/databricks.html"
                   class="nav-list-link">Databricks</a></li><li class="nav-list-item "><a href="/v0.70/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/v0.70/integrations/dbt.html"
                   class="nav-list-link">dbt</a></li><li class="nav-list-item "><a href="/v0.70/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/v0.70/integrations/glue_etl.html"
                   class="nav-list-link">Glue ETL</a></li><li class="nav-list-item "><a href="/v0.70/integrations/kakfa.html"
                   class="nav-list-link">Kafka</a></li><li class="nav-list-item "><a href="/v0.70/integrations/mapreduce.html"
                   class="nav-list-link">MapReduce</a></li><li class="nav-list-item "><a href="/v0.70/integrations/sagemaker.html"
                   class="nav-list-link">SageMaker</a></li><li class="nav-list-item "><a href="/v0.70/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.70/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.70/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/v0.70/understand/model.html"
                   class="nav-list-link">Model</a></li><li class="nav-list-item "><a href="/v0.70/understand/versioning-internals.html"
                   class="nav-list-link">Versioning Internals</a></li><li class="nav-list-item "><a href="/v0.70/understand/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li><li class="nav-list-item "><a href="/v0.70/understand/roadmap.html"
                   class="nav-list-link">Roadmap</a></li></ul></li><li
            class="nav-list-item"><a href="/v0.70/glossary.html"
           class="nav-list-link">lakeFS Glossary</a></li><li
            class="nav-list-item"><a href="/v0.70/commitment.html"
           class="nav-list-link">Our commitment to open source</a></li><li
            class="nav-list-item"><a href="/v0.70/contributing.html"
           class="nav-list-link">Contributing</a></li><li
            class="nav-list-item"><a href="/v0.70/faq.html"
           class="nav-list-link">FAQ</a></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/cloud-registration/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                lakeFS Cloud
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/cloud-registration/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                lakeFS Cloud
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/v0.70/setup/">Set up lakeFS</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>S3 Virtual-host addressing (advanced)</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                <h1 id="configuring-lakefs-to-use-s3-virtual-host-addressing">
        
        
          <a href="#configuring-lakefs-to-use-s3-virtual-host-addressing" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring lakeFS to use S3 Virtual-Host addressing
        
        
      </h1>
    
      <h2 id="understanding-virtual-host-addressing">
        
        
          <a href="#understanding-virtual-host-addressing" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding virtual-host addressing
        
        
      </h2>
    

<p>Some systems require S3 endpoints (such as lakeFS’ <a href="/v0.70/understand/architecture.html#s3-gateway">S3 Gateway</a>) to support <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/VirtualHosting.html" target="_blank">virtual-host style addressing</a>.</p>

<p>lakeFS supports this, but requires some configuration in order to extract the bucket name (used as the lakeFS repository ID) from the host address.</p>

<p>For example:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET http://foo.example.com/some/location
</code></pre></div></div>

<p>In this case, there’s no way for lakeFS to determine whether this is a virtual-host request where the endpoint url is <code class="language-plaintext highlighter-rouge">example.com</code>, the bucket name is <code class="language-plaintext highlighter-rouge">foo</code> and the path is <code class="language-plaintext highlighter-rouge">/some/location</code>,
or a path-based request where the endpoint is <code class="language-plaintext highlighter-rouge">foo.example.com</code>, the bucket name is <code class="language-plaintext highlighter-rouge">some</code> and the path is <code class="language-plaintext highlighter-rouge">location</code>.</p>

<p>This requires an extra step: defining an explicit set of DNS record for lakeFS S3 gateway.</p>
      <h2 id="adding-an-explicit-s3-domain-name-to-the-s3-gateway-configuration">
        
        
          <a href="#adding-an-explicit-s3-domain-name-to-the-s3-gateway-configuration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adding an explicit S3 domain name to the S3 Gateway configuration
        
        
      </h2>
    

<p>The first step would be to tell the lakeFS installation which hostnames are used for the S3 Gateway. This should be a different DNS record from the one used for e.g. the UI or API.</p>

<p>Typically, if the lakeFS installation is served under <code class="language-plaintext highlighter-rouge">lakefs.example.com</code>, a good choice would be <code class="language-plaintext highlighter-rouge">s3.lakefs.example.com</code>.</p>

<p>This could be done using either an environment variable:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">LAKEFS_GATEWAYS_S3_DOMAIN_NAME</span><span class="o">=</span><span class="s2">"s3.lakefs.example.com"</span>
</code></pre></div></div>

<p>Or by adding the <code class="language-plaintext highlighter-rouge">gateways.s3.domain_name</code> setting to the lakeFS <code class="language-plaintext highlighter-rouge">config.yaml</code> file:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">database</span><span class="pi">:</span>
  <span class="na">connection_string</span><span class="pi">:</span> <span class="s2">"</span><span class="s">..."</span>

<span class="nn">...</span>

<span class="c1"># This section defines an explict S3 gateway address that supports virtual-host addressing</span>
<span class="na">gateways</span><span class="pi">:</span>
  <span class="na">s3</span><span class="pi">:</span>
    <span class="na">domain_name</span><span class="pi">:</span> <span class="s">s3.lakefs.example.com</span>
</code></pre></div></div>

<p class="note">For more information on how to configure lakeFS, check out the <a href="/v0.70/reference/configuration.html">configuration reference</a></p>
      <h2 id="setting-up-the-appropriate-dns-records">
        
        
          <a href="#setting-up-the-appropriate-dns-records" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting up the appropriate DNS records
        
        
      </h2>
    

<p>Once your lakeFS installation is configured with an explicit S3 gateway endpoint address, you need to define two DNS records and have them point at your lakeFS installation.
This requires two CNAME records:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">s3.lakefs.example.com</code> - CNAME to <code class="language-plaintext highlighter-rouge">lakefs.example.com</code>. This will be used as the S3 endpoint when configuring clients and serve as our bare domain.</li>
  <li><code class="language-plaintext highlighter-rouge">*.s3.lakefs.example.com</code> - Also a CNAME to <code class="language-plaintext highlighter-rouge">lakefs.example.com</code>. This will resolve virtual-host requests such as <code class="language-plaintext highlighter-rouge">example-repo.s3.lakefs.example.com</code> that lakeFS would now know how to parse.</li>
</ol>

<div class="note">
  <p>For more information on how to configure these, see the official documentation of your DNS provider.</p>
  <p>On AWS, This could also be done <a href="https://aws.amazon.com/premiumsupport/knowledge-center/route-53-create-alias-records/">using ALIAS records</a> for a load balancer.</p>
</div>

                

                


            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <a href="https://lakefs.io" class="site-title lh-tight">
                <div class="site-logo"></div>
            </a>
        </div>
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.70/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/v0.70/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.70/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/v0.70/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.70/assets/icons/github.svg" class="no-hover" />
                            <img src="/v0.70/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.70/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/v0.70/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.70/assets/icons/slack.svg" class="no-hover" />
                            <img src="/v0.70/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left"><a href="/v0.70https://www.treeverse.io/">
                    <div class="other-logo"><img src="/v0.70/assets/by-treeverse.png" /></div>
                </a></div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>




<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Lua | lakeFS</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Lua" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Lua Hooks reference" />
<meta property="og:description" content="Lua Hooks reference" />
<meta property="og:site_name" content="lakeFS" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Lua" />
<script type="application/ld+json">
{"description":"Lua Hooks reference","@type":"WebPage","headline":"Lua","url":"/hooks/lua.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/logo.svg"}},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->
<meta property="og:image" content="/assets/img/shared-image.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script src="/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/assets/js/feedback.js"></script>
<link href="https://data-folks.masto.host/@lakeFS" rel="me">

</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS" aria-label="Search lakeFS"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/"
           class="nav-list-link">lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/quickstart/"
           class="nav-list-link">‚≠ê Quickstart ‚≠ê</a><ul class="nav-list "><li class="nav-list-item "><a href="/quickstart/launch.html"
                   class="nav-list-link">1Ô∏è‚É£ Run lakeFS</a></li><li class="nav-list-item "><a href="/quickstart/query.html"
                   class="nav-list-link">2Ô∏è‚É£ Query the data</a></li><li class="nav-list-item "><a href="/quickstart/branch.html"
                   class="nav-list-link">3Ô∏è‚É£ Create a branch</a></li><li class="nav-list-item "><a href="/quickstart/commit-and-merge.html"
                   class="nav-list-link">4Ô∏è‚É£ Commit and Merge</a></li><li class="nav-list-item "><a href="/quickstart/rollback.html"
                   class="nav-list-link">5Ô∏è‚É£ Roll back Changes</a></li><li class="nav-list-item "><a href="/quickstart/learning-more-lakefs.html"
                   class="nav-list-link">üßëüèª‚Äçüéì Learn more about lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/deploy/"
           class="nav-list-link">Deploy and Setup lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/deploy/aws.html"
                   class="nav-list-link">AWS</a></li><li class="nav-list-item "><a href="/deploy/azure.html"
                   class="nav-list-link">Azure</a></li><li class="nav-list-item "><a href="/deploy/gcp.html"
                   class="nav-list-link">GCP</a></li><li class="nav-list-item "><a href="/deploy/onprem.html"
                   class="nav-list-link">On-Premises Deployment of lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/integrations/spark.html"
                   class="nav-list-link">Spark</a></li><li class="nav-list-item "><a href="/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/integrations/airflow.html"
                   class="nav-list-link">Airflow</a></li><li class="nav-list-item "><a href="/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/integrations/presto_trino.html"
                   class="nav-list-link">Presto/Trino</a></li><li class="nav-list-item "><a href="/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/integrations/dbt.html"
                   class="nav-list-link">dbt</a></li><li class="nav-list-item "><a href="/integrations/kafka.html"
                   class="nav-list-link">Kafka</a></li><li class="nav-list-item "><a href="/integrations/sagemaker.html"
                   class="nav-list-link">SageMaker</a></li><li class="nav-list-item "><a href="/integrations/hive.html"
                   class="nav-list-link">Hive</a></li><li class="nav-list-item "><a href="/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/integrations/cloudera.html"
                   class="nav-list-link">Cloudera</a></li><li class="nav-list-item "><a href="/integrations/iceberg.html"
                   class="nav-list-link">Iceberg</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/hooks/"
           class="nav-list-link">Hooks</a><ul class="nav-list "><li class="nav-list-item "><a href="/hooks/overview.html"
                   class="nav-list-link">Overview</a></li><li class="nav-list-item  active"><a href="/hooks/lua.html"
                   class="nav-list-link active">Lua</a></li><li class="nav-list-item "><a href="/hooks/webhooks.html"
                   class="nav-list-link">Webhooks</a></li><li class="nav-list-item "><a href="/hooks/airflow.html"
                   class="nav-list-link">Airflow</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/use_cases/"
           class="nav-list-link">Use Cases</a><ul class="nav-list "><li class="nav-list-item "><a href="/use_cases/etl_testing.html"
                   class="nav-list-link">ETL Testing Environment</a></li><li class="nav-list-item "><a href="/use_cases/rollback.html"
                   class="nav-list-link">Rollback</a></li><li class="nav-list-item "><a href="/use_cases/reproducibility.html"
                   class="nav-list-link">Reproducibility</a></li><li class="nav-list-item "><a href="/use_cases/cicd_for_data.html"
                   class="nav-list-link">CI/CD for data lakes</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="/howto/import.html"
                   class="nav-list-link">Import data into lakeFS</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/howto/garbage-collection-index.html"
                   class="nav-list-link">Garbage Collection</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/howto/garbage-collection-committed.html"
                           class="nav-list-link">Committed Objects</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/garbage-collection-uncommitted.html"
                           class="nav-list-link">Uncommitted Objects</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/gc-internals.html"
                           class="nav-list-link">Committed GC Internals</a>
                    </li></ul></li><li class="nav-list-item "><a href="/howto/upgrade.html"
                   class="nav-list-link">Upgrade lakeFS</a></li><li class="nav-list-item "><a href="/howto/export.html"
                   class="nav-list-link">Exporting Data</a></li><li class="nav-list-item "><a href="/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/howto/protect-branches.html"
                   class="nav-list-link">Protect Branches</a></li><li class="nav-list-item "><a href="/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/cloud/"
           class="nav-list-link">lakeFS Cloud</a><ul class="nav-list "><li class="nav-list-item "><a href="/cloud/auditing.html"
                   class="nav-list-link">Auditing</a></li><li class="nav-list-item "><a href="/cloud/managed-gc.html"
                   class="nav-list-link">Managed Garbage Collection</a></li><li class="nav-list-item "><a href="/cloud/setup-azure.html"
                   class="nav-list-link">On Azure</a></li><li class="nav-list-item "><a href="/cloud/private-link.html"
                   class="nav-list-link">Private Link</a></li><li class="nav-list-item "><a href="/cloud/sso.html"
                   class="nav-list-link">Single Sign On (SSO)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/enterprise/"
           class="nav-list-link">lakeFS Enterprise</a><ul class="nav-list "><li class="nav-list-item "><a href="/enterprise/sso.html"
                   class="nav-list-link">Single Sign On (SSO) in lakeFS Enterprise</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/reference/configuration.html"
                   class="nav-list-link">Configuration</a></li><li class="nav-list-item "><a href="/reference/cli.html"
                   class="nav-list-link">lakectl (lakeFS command-line tool)</a></li><li class="nav-list-item "><a href="/reference/api.html"
                   class="nav-list-link">API Reference</a></li><li class="nav-list-item "><a href="/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/reference/s3.html"
                   class="nav-list-link">S3 Supported API</a></li><li class="nav-list-item "><a href="/reference/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/reference/saml-authentication-integration.html"
                   class="nav-list-link">SAML Authentication Integration</a></li><li class="nav-list-item "><a href="/reference/remote-authenticator.html"
                   class="nav-list-link">Remote Authenticator</a></li><li class="nav-list-item "><a href="/reference/rbac.html"
                   class="nav-list-link">Role-Based Access Control (RBAC)</a></li><li class="nav-list-item "><a href="/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/reference/access-control-lists.html"
                   class="nav-list-link">Access Control Lists (ACLs)</a></li><li class="nav-list-item "><a href="/reference/presigned-url.html"
                   class="nav-list-link">Presigned URL</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/understand/model.html"
                   class="nav-list-link">Model</a></li><li class="nav-list-item "><a href="/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/how/"
                   class="nav-list-link">How it Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li></ul></li><li class="nav-list-item "><a href="/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li></ul></li><li
            class="nav-list-item"><a href="/roadmap.html"
           class="nav-list-link">Roadmap</a></li><li
            class="nav-list-item"><a href="/commitment.html"
           class="nav-list-link">Commitment to OSS</a></li><li
            class="nav-list-item"><a href="/contributing.html"
           class="nav-list-link">Contributing</a></li><li
            class="nav-list-item"><a href="/faq.html"
           class="nav-list-link">FAQ</a></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="/quickstart" class="site-button" >
                Get Started
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="/quickstart" class="site-button" >
                Get Started
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a
                                href="/reference/">Reference</a>
                    </li>
                    <li class="breadcrumb-nav-list-item"><a href="/hooks/lua.html">Hooks</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Lua</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 class="no_toc" id="lua-hooks-experimental">
  
  
    <a href="#lua-hooks-experimental" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lua Hooks <span class="label">Experimental</span>
  
  
</h1>
    

<p>As of version 0.86.0, lakeFS supports running hooks without relying on external components using an <a href="https://github.com/Shopify/go-lua">embedded Lua VM</a></p>

<p>Using Lua hooks, it is possible to pass a Lua script to be executed directly by the lakeFS server when an action occurs.</p>

<p>The Lua runtime embedded in lakeFS is limited for security reasons. It provides a narrow set of APIs and functions that by default do not allow:</p>

<ol>
  <li>Accessing any of the running lakeFS server‚Äôs environment</li>
  <li>Accessing the local filesystem available the lakeFS process</li>
</ol>

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#lua-library-reference" id="markdown-toc-lua-library-reference">Lua Library reference</a>    <ol>
      <li><a href="#awss3get_objectbucket-key" id="markdown-toc-awss3get_objectbucket-key"><code class="language-plaintext highlighter-rouge">aws/s3.get_object(bucket, key)</code></a></li>
      <li><a href="#awss3put_objectbucket-key-value" id="markdown-toc-awss3put_objectbucket-key-value"><code class="language-plaintext highlighter-rouge">aws/s3.put_object(bucket, key, value)</code></a></li>
      <li><a href="#awss3delete_objectbucket--key" id="markdown-toc-awss3delete_objectbucket--key"><code class="language-plaintext highlighter-rouge">aws/s3.delete_object(bucket [, key])</code></a></li>
      <li><a href="#awss3list_objectsbucket--prefix-continuation_token-delimiter" id="markdown-toc-awss3list_objectsbucket--prefix-continuation_token-delimiter"><code class="language-plaintext highlighter-rouge">aws/s3.list_objects(bucket [, prefix, continuation_token, delimiter])</code></a></li>
      <li><a href="#awss3delete_recursivebucket-prefix" id="markdown-toc-awss3delete_recursivebucket-prefix"><code class="language-plaintext highlighter-rouge">aws/s3.delete_recursive(bucket, prefix)</code></a></li>
      <li><a href="#cryptoaesencryptcbckey-plaintext" id="markdown-toc-cryptoaesencryptcbckey-plaintext"><code class="language-plaintext highlighter-rouge">crypto/aes/encryptCBC(key, plaintext)</code></a></li>
      <li><a href="#cryptoaesdecryptcbckey-ciphertext" id="markdown-toc-cryptoaesdecryptcbckey-ciphertext"><code class="language-plaintext highlighter-rouge">crypto/aes/decryptCBC(key, ciphertext)</code></a></li>
      <li><a href="#cryptohmacsign_sha256message-key" id="markdown-toc-cryptohmacsign_sha256message-key"><code class="language-plaintext highlighter-rouge">crypto/hmac/sign_sha256(message, key)</code></a></li>
      <li><a href="#cryptohmacsign_sha1message-key" id="markdown-toc-cryptohmacsign_sha1message-key"><code class="language-plaintext highlighter-rouge">crypto/hmac/sign_sha1(message, key)</code></a></li>
      <li><a href="#cryptomd5digestdata" id="markdown-toc-cryptomd5digestdata"><code class="language-plaintext highlighter-rouge">crypto/md5/digest(data)</code></a></li>
      <li><a href="#cryptosha256digestdata" id="markdown-toc-cryptosha256digestdata"><code class="language-plaintext highlighter-rouge">crypto/sha256/digest(data)</code></a></li>
      <li><a href="#encodingbase64encodedata" id="markdown-toc-encodingbase64encodedata"><code class="language-plaintext highlighter-rouge">encoding/base64/encode(data)</code></a></li>
      <li><a href="#encodingbase64decodedata" id="markdown-toc-encodingbase64decodedata"><code class="language-plaintext highlighter-rouge">encoding/base64/decode(data)</code></a></li>
      <li><a href="#encodingbase64url_encodedata" id="markdown-toc-encodingbase64url_encodedata"><code class="language-plaintext highlighter-rouge">encoding/base64/url_encode(data)</code></a></li>
      <li><a href="#encodingbase64url_decodedata" id="markdown-toc-encodingbase64url_decodedata"><code class="language-plaintext highlighter-rouge">encoding/base64/url_decode(data)</code></a></li>
      <li><a href="#encodinghexencodevalue" id="markdown-toc-encodinghexencodevalue"><code class="language-plaintext highlighter-rouge">encoding/hex/encode(value)</code></a></li>
      <li><a href="#encodinghexdecodevalue" id="markdown-toc-encodinghexdecodevalue"><code class="language-plaintext highlighter-rouge">encoding/hex/decode(value)</code></a></li>
      <li><a href="#encodingjsonmarshaltable" id="markdown-toc-encodingjsonmarshaltable"><code class="language-plaintext highlighter-rouge">encoding/json/marshal(table)</code></a></li>
      <li><a href="#encodingjsonunmarshalstring" id="markdown-toc-encodingjsonunmarshalstring"><code class="language-plaintext highlighter-rouge">encoding/json/unmarshal(string)</code></a></li>
      <li><a href="#encodingparquetget_schemapayload" id="markdown-toc-encodingparquetget_schemapayload"><code class="language-plaintext highlighter-rouge">encoding/parquet/get_schema(payload)</code></a></li>
      <li><a href="#lakefs" id="markdown-toc-lakefs"><code class="language-plaintext highlighter-rouge">lakefs</code></a></li>
      <li><a href="#lakefscreate_tagrepository_id-reference_id-tag_id" id="markdown-toc-lakefscreate_tagrepository_id-reference_id-tag_id"><code class="language-plaintext highlighter-rouge">lakefs/create_tag(repository_id, reference_id, tag_id)</code></a></li>
      <li><a href="#lakefsdiff_refsrepository_id-lef_reference_id-right_reference_id--after-prefix-delimiter-amount" id="markdown-toc-lakefsdiff_refsrepository_id-lef_reference_id-right_reference_id--after-prefix-delimiter-amount"><code class="language-plaintext highlighter-rouge">lakefs/diff_refs(repository_id, lef_reference_id, right_reference_id [, after, prefix, delimiter, amount])</code></a></li>
      <li><a href="#lakefslist_objectsrepository_id-reference_id--after-prefix-delimiter-amount" id="markdown-toc-lakefslist_objectsrepository_id-reference_id--after-prefix-delimiter-amount"><code class="language-plaintext highlighter-rouge">lakefs/list_objects(repository_id, reference_id [, after, prefix, delimiter, amount])</code></a></li>
      <li><a href="#lakefsget_objectrepository_id-reference_id-path" id="markdown-toc-lakefsget_objectrepository_id-reference_id-path"><code class="language-plaintext highlighter-rouge">lakefs/get_object(repository_id, reference_id, path)</code></a></li>
      <li><a href="#pathparsepath_string" id="markdown-toc-pathparsepath_string"><code class="language-plaintext highlighter-rouge">path/parse(path_string)</code></a></li>
      <li><a href="#pathjoinpath_parts" id="markdown-toc-pathjoinpath_parts"><code class="language-plaintext highlighter-rouge">path/join(*path_parts)</code></a></li>
      <li><a href="#pathis_hiddenpath_string--seperator-prefix" id="markdown-toc-pathis_hiddenpath_string--seperator-prefix"><code class="language-plaintext highlighter-rouge">path/is_hidden(path_string [, seperator, prefix])</code></a></li>
      <li><a href="#pathdefault_separator" id="markdown-toc-pathdefault_separator"><code class="language-plaintext highlighter-rouge">path/default_separator()</code></a></li>
      <li><a href="#regexpmatchpattern-s" id="markdown-toc-regexpmatchpattern-s"><code class="language-plaintext highlighter-rouge">regexp/match(pattern, s)</code></a></li>
      <li><a href="#regexpquote_metas" id="markdown-toc-regexpquote_metas"><code class="language-plaintext highlighter-rouge">regexp/quote_meta(s)</code></a></li>
      <li><a href="#regexpcompilepattern" id="markdown-toc-regexpcompilepattern"><code class="language-plaintext highlighter-rouge">regexp/compile(pattern)</code></a></li>
      <li><a href="#regexpcompiled_patternfind_alls-n" id="markdown-toc-regexpcompiled_patternfind_alls-n"><code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find_all(s, n)</code></a></li>
      <li><a href="#regexpcompiled_patternfind_all_submatchs-n" id="markdown-toc-regexpcompiled_patternfind_all_submatchs-n"><code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find_all_submatch(s, n)</code></a></li>
      <li><a href="#regexpcompiled_patternfinds" id="markdown-toc-regexpcompiled_patternfinds"><code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find(s)</code></a></li>
      <li><a href="#regexpcompiled_patternfind_submatchs" id="markdown-toc-regexpcompiled_patternfind_submatchs"><code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find_submatch(s)</code></a></li>
      <li><a href="#stringssplits-sep" id="markdown-toc-stringssplits-sep"><code class="language-plaintext highlighter-rouge">strings/split(s, sep)</code></a></li>
      <li><a href="#stringstrims" id="markdown-toc-stringstrims"><code class="language-plaintext highlighter-rouge">strings/trim(s)</code></a></li>
      <li><a href="#stringsreplaces-old-new-n" id="markdown-toc-stringsreplaces-old-new-n"><code class="language-plaintext highlighter-rouge">strings/replace(s, old, new, n)</code></a></li>
      <li><a href="#stringshas_prefixs-prefix" id="markdown-toc-stringshas_prefixs-prefix"><code class="language-plaintext highlighter-rouge">strings/has_prefix(s, prefix)</code></a></li>
      <li><a href="#stringshas_suffixs-suffix" id="markdown-toc-stringshas_suffixs-suffix"><code class="language-plaintext highlighter-rouge">strings/has_suffix(s, suffix)</code></a></li>
      <li><a href="#stringscontainss-substr" id="markdown-toc-stringscontainss-substr"><code class="language-plaintext highlighter-rouge">strings/contains(s, substr)</code></a></li>
      <li><a href="#timenow" id="markdown-toc-timenow"><code class="language-plaintext highlighter-rouge">time/now()</code></a></li>
      <li><a href="#timeformatepoch_nano-layout-zone" id="markdown-toc-timeformatepoch_nano-layout-zone"><code class="language-plaintext highlighter-rouge">time/format(epoch_nano, layout, zone)</code></a></li>
      <li><a href="#timeformat_isoepoch_nano-zone" id="markdown-toc-timeformat_isoepoch_nano-zone"><code class="language-plaintext highlighter-rouge">time/format_iso(epoch_nano, zone)</code></a></li>
      <li><a href="#timesleepduration_ns" id="markdown-toc-timesleepduration_ns"><code class="language-plaintext highlighter-rouge">time/sleep(duration_ns)</code></a></li>
      <li><a href="#timesinceepoch_nano" id="markdown-toc-timesinceepoch_nano"><code class="language-plaintext highlighter-rouge">time/since(epoch_nano)</code></a></li>
      <li><a href="#timeaddepoch_time-duration_table" id="markdown-toc-timeaddepoch_time-duration_table"><code class="language-plaintext highlighter-rouge">time/add(epoch_time, duration_table)</code></a></li>
      <li><a href="#timeparselayout-value" id="markdown-toc-timeparselayout-value"><code class="language-plaintext highlighter-rouge">time/parse(layout, value)</code></a></li>
      <li><a href="#timeparse_isovalue" id="markdown-toc-timeparse_isovalue"><code class="language-plaintext highlighter-rouge">time/parse_iso(value)</code></a></li>
      <li><a href="#uuidnew" id="markdown-toc-uuidnew"><code class="language-plaintext highlighter-rouge">uuid/new()</code></a></li>
      <li><a href="#nethttp-optional" id="markdown-toc-nethttp-optional"><code class="language-plaintext highlighter-rouge">net/http</code> (optional)</a></li>
    </ol>
  </li>
  <li><a href="#example-hooks" id="markdown-toc-example-hooks">Example Hooks</a></li>
</ol>

</div>
<h2 id="lua-library-reference">
  
  
    <a href="#lua-library-reference" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lua Library reference
  
  
</h2>
    
<h3 id="awss3get_objectbucket-key">
  
  
    <a href="#awss3get_objectbucket-key" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">aws/s3.get_object(bucket, key)</code>
  
  
</h3>
    

<p>Returns the body (as a Lua string) of the requested object and a boolean value that is true if the requested object exists</p>
<h3 id="awss3put_objectbucket-key-value">
  
  
    <a href="#awss3put_objectbucket-key-value" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">aws/s3.put_object(bucket, key, value)</code>
  
  
</h3>
    

<p>Sets the object at the given bucket and key to the value of the supplied value string</p>
<h3 id="awss3delete_objectbucket--key">
  
  
    <a href="#awss3delete_objectbucket--key" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">aws/s3.delete_object(bucket [, key])</code>
  
  
</h3>
    

<p>Deletes the object at the given key</p>
<h3 id="awss3list_objectsbucket--prefix-continuation_token-delimiter">
  
  
    <a href="#awss3list_objectsbucket--prefix-continuation_token-delimiter" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">aws/s3.list_objects(bucket [, prefix, continuation_token, delimiter])</code>
  
  
</h3>
    

<p>Returns a table of results containing the following structure:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">is_truncated</code>: (boolean) whether there are more results to paginate through using the continuation token</li>
  <li><code class="language-plaintext highlighter-rouge">next_continuation_token</code>: (string) to pass in the next request to get the next page of results</li>
  <li><code class="language-plaintext highlighter-rouge">results</code> (table of tables) information about the objects (and prefixes if a delimiter is used)</li>
</ul>

<p>a result could in one of the following structures</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="p">[</span><span class="s2">"key"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"a/common/prefix/"</span><span class="p">,</span>
   <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"prefix"</span>
<span class="p">}</span>
</code></pre></div></div>

<p>or:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="p">[</span><span class="s2">"key"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"path/to/object"</span><span class="p">,</span>
   <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"object"</span><span class="p">,</span>
   <span class="p">[</span><span class="s2">"etag"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"etagString"</span><span class="p">,</span>
   <span class="p">[</span><span class="s2">"size"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
   <span class="p">[</span><span class="s2">"last_modified"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"2023-12-31T23:10:00Z"</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="awss3delete_recursivebucket-prefix">
  
  
    <a href="#awss3delete_recursivebucket-prefix" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">aws/s3.delete_recursive(bucket, prefix)</code>
  
  
</h3>
    

<p>Deletes all objects under the given prefix</p>
<h3 id="cryptoaesencryptcbckey-plaintext">
  
  
    <a href="#cryptoaesencryptcbckey-plaintext" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">crypto/aes/encryptCBC(key, plaintext)</code>
  
  
</h3>
    

<p>Returns a ciphertext for the aes encrypted text</p>
<h3 id="cryptoaesdecryptcbckey-ciphertext">
  
  
    <a href="#cryptoaesdecryptcbckey-ciphertext" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">crypto/aes/decryptCBC(key, ciphertext)</code>
  
  
</h3>
    

<p>Returns the decrypted (plaintext) string for the encrypted ciphertext</p>
<h3 id="cryptohmacsign_sha256message-key">
  
  
    <a href="#cryptohmacsign_sha256message-key" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">crypto/hmac/sign_sha256(message, key)</code>
  
  
</h3>
    

<p>Returns a SHA256 hmac signature for the given message with the supplied key (using the SHA256 hashing algorithm)</p>
<h3 id="cryptohmacsign_sha1message-key">
  
  
    <a href="#cryptohmacsign_sha1message-key" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">crypto/hmac/sign_sha1(message, key)</code>
  
  
</h3>
    

<p>Returns a SHA1 hmac signature for the given message with the supplied key (using the SHA1 hashing algorithm)</p>
<h3 id="cryptomd5digestdata">
  
  
    <a href="#cryptomd5digestdata" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">crypto/md5/digest(data)</code>
  
  
</h3>
    

<p>Returns the MD5 digest (string) of the given data</p>
<h3 id="cryptosha256digestdata">
  
  
    <a href="#cryptosha256digestdata" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">crypto/sha256/digest(data)</code>
  
  
</h3>
    

<p>Returns the SHA256 digest (string) of the given data</p>
<h3 id="encodingbase64encodedata">
  
  
    <a href="#encodingbase64encodedata" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/base64/encode(data)</code>
  
  
</h3>
    

<p>Encodes the given data to a base64 string</p>
<h3 id="encodingbase64decodedata">
  
  
    <a href="#encodingbase64decodedata" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/base64/decode(data)</code>
  
  
</h3>
    

<p>Decodes the given base64 encoded data and return it as a string</p>
<h3 id="encodingbase64url_encodedata">
  
  
    <a href="#encodingbase64url_encodedata" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/base64/url_encode(data)</code>
  
  
</h3>
    

<p>Encodes the given data to an unpadded alternate base64 encoding defined in RFC 4648.</p>
<h3 id="encodingbase64url_decodedata">
  
  
    <a href="#encodingbase64url_decodedata" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/base64/url_decode(data)</code>
  
  
</h3>
    

<p>Decodes the given unpadded alternate base64 encoding defined in RFC 4648 and return it as a string</p>
<h3 id="encodinghexencodevalue">
  
  
    <a href="#encodinghexencodevalue" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/hex/encode(value)</code>
  
  
</h3>
    

<p>Encode the given value string to hexadecimal values (string)</p>
<h3 id="encodinghexdecodevalue">
  
  
    <a href="#encodinghexdecodevalue" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/hex/decode(value)</code>
  
  
</h3>
    

<p>Decode the given hexadecimal string back to the string it represents (UTF-8)</p>
<h3 id="encodingjsonmarshaltable">
  
  
    <a href="#encodingjsonmarshaltable" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/json/marshal(table)</code>
  
  
</h3>
    

<p>Encodes the given table into a JSON string</p>
<h3 id="encodingjsonunmarshalstring">
  
  
    <a href="#encodingjsonunmarshalstring" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/json/unmarshal(string)</code>
  
  
</h3>
    

<p>Decodes the given string into the equivalent Lua structure</p>
<h3 id="encodingparquetget_schemapayload">
  
  
    <a href="#encodingparquetget_schemapayload" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">encoding/parquet/get_schema(payload)</code>
  
  
</h3>
    

<p>Read the payload (string) as the contents of a Parquet file and return its schema in the following table structure:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="p">{</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"column_a"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"INT32"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"column_b"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"BYTE_ARRAY"</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="lakefs">
  
  
    <a href="#lakefs" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">lakefs</code>
  
  
</h3>
    

<p>The Lua Hook library allows calling back to the lakeFS API using the identity of the user that triggered the action.
For example, if user A tries to commit and triggers a <code class="language-plaintext highlighter-rouge">pre-commit</code> hook - any call made inside that hook to the lakeFS
API, will automatically use user A‚Äôs identity for authorization and auditing purposes.</p>
<h3 id="lakefscreate_tagrepository_id-reference_id-tag_id">
  
  
    <a href="#lakefscreate_tagrepository_id-reference_id-tag_id" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">lakefs/create_tag(repository_id, reference_id, tag_id)</code>
  
  
</h3>
    

<p>Create a new tag for the given reference</p>
<h3 id="lakefsdiff_refsrepository_id-lef_reference_id-right_reference_id--after-prefix-delimiter-amount">
  
  
    <a href="#lakefsdiff_refsrepository_id-lef_reference_id-right_reference_id--after-prefix-delimiter-amount" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">lakefs/diff_refs(repository_id, lef_reference_id, right_reference_id [, after, prefix, delimiter, amount])</code>
  
  
</h3>
    

<p>Returns an object-wise diff between <code class="language-plaintext highlighter-rouge">left_reference_id</code> and <code class="language-plaintext highlighter-rouge">right_reference_id</code>.</p>
<h3 id="lakefslist_objectsrepository_id-reference_id--after-prefix-delimiter-amount">
  
  
    <a href="#lakefslist_objectsrepository_id-reference_id--after-prefix-delimiter-amount" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">lakefs/list_objects(repository_id, reference_id [, after, prefix, delimiter, amount])</code>
  
  
</h3>
    

<p>List objects in the specified repository and reference (branch, tag, commit ID, etc.).
If delimiter is empty, will default to a recursive listing. Otherwise, common prefixes up to <code class="language-plaintext highlighter-rouge">delimiter</code> will be shown as a single entry.</p>
<h3 id="lakefsget_objectrepository_id-reference_id-path">
  
  
    <a href="#lakefsget_objectrepository_id-reference_id-path" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">lakefs/get_object(repository_id, reference_id, path)</code>
  
  
</h3>
    

<p>Returns 2 values:</p>

<ol>
  <li>The HTTP status code returned by the lakeFS API</li>
  <li>The content of the specified object as a lua string</li>
</ol>
<h3 id="pathparsepath_string">
  
  
    <a href="#pathparsepath_string" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">path/parse(path_string)</code>
  
  
</h3>
    

<p>Returns a table for the given path string with the following structure:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"path"</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">path</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"a/b/c.csv"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">[</span><span class="s2">"parent"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"a/b/"</span>
    <span class="p">[</span><span class="s2">"base_name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"c.csv"</span>
<span class="p">}</span> 
</code></pre></div></div>
<h3 id="pathjoinpath_parts">
  
  
    <a href="#pathjoinpath_parts" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">path/join(*path_parts)</code>
  
  
</h3>
    

<p>Receives a variable number of strings and returns a joined string that represents a path:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"path"</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s2">"path/"</span><span class="p">,</span> <span class="s2">"to"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"file.data"</span><span class="p">)</span>
<span class="n">path</span><span class="o">/</span><span class="n">o</span><span class="o">/</span><span class="n">a</span><span class="o">/</span><span class="n">file</span><span class="p">.</span><span class="n">data</span>
</code></pre></div></div>
<h3 id="pathis_hiddenpath_string--seperator-prefix">
  
  
    <a href="#pathis_hiddenpath_string--seperator-prefix" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">path/is_hidden(path_string [, seperator, prefix])</code>
  
  
</h3>
    

<p>returns a boolean - <code class="language-plaintext highlighter-rouge">true</code> if the given path string is hidden (meaning it starts with <code class="language-plaintext highlighter-rouge">prefix</code>) - or if any of its parents start with <code class="language-plaintext highlighter-rouge">prefix</code>.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"path"</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">path</span><span class="p">.</span><span class="n">is_hidden</span><span class="p">(</span><span class="s2">"a/b/c"</span><span class="p">)</span> <span class="c1">-- false</span>
<span class="o">&gt;</span> <span class="n">path</span><span class="p">.</span><span class="n">is_hidden</span><span class="p">(</span><span class="s2">"a/b/_c"</span><span class="p">)</span> <span class="c1">-- true</span>
<span class="o">&gt;</span> <span class="n">path</span><span class="p">.</span><span class="n">is_hidden</span><span class="p">(</span><span class="s2">"a/_b/c"</span><span class="p">)</span> <span class="c1">-- true</span>
<span class="o">&gt;</span> <span class="n">path</span><span class="p">.</span><span class="n">is_hidden</span><span class="p">(</span><span class="s2">"a/b/_c/"</span><span class="p">)</span> <span class="c1">-- true</span>
</code></pre></div></div>
<h3 id="pathdefault_separator">
  
  
    <a href="#pathdefault_separator" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">path/default_separator()</code>
  
  
</h3>
    

<p>Returns a constant string (<code class="language-plaintext highlighter-rouge">/</code>)</p>
<h3 id="regexpmatchpattern-s">
  
  
    <a href="#regexpmatchpattern-s" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">regexp/match(pattern, s)</code>
  
  
</h3>
    

<p>Returns true if the string <code class="language-plaintext highlighter-rouge">s</code> matches <code class="language-plaintext highlighter-rouge">pattern</code>.
This is a thin wrapper over Go‚Äôs <a href="https://pkg.go.dev/regexp#MatchString" target="_blank">regexp.MatchString</a>.</p>
<h3 id="regexpquote_metas">
  
  
    <a href="#regexpquote_metas" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">regexp/quote_meta(s)</code>
  
  
</h3>
    

<p>Escapes any meta-characters in string <code class="language-plaintext highlighter-rouge">s</code> and returns a new string</p>
<h3 id="regexpcompilepattern">
  
  
    <a href="#regexpcompilepattern" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">regexp/compile(pattern)</code>
  
  
</h3>
    

<p>Returns a regexp match object for the given pattern</p>
<h3 id="regexpcompiled_patternfind_alls-n">
  
  
    <a href="#regexpcompiled_patternfind_alls-n" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find_all(s, n)</code>
  
  
</h3>
    

<p>Returns a table list of all matches for the pattern, (up to <code class="language-plaintext highlighter-rouge">n</code> matches, unless <code class="language-plaintext highlighter-rouge">n == -1</code> in which case all possible matches will be returned)</p>
<h3 id="regexpcompiled_patternfind_all_submatchs-n">
  
  
    <a href="#regexpcompiled_patternfind_all_submatchs-n" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find_all_submatch(s, n)</code>
  
  
</h3>
    

<p>Returns a table list of all sub-matches for the pattern, (up to <code class="language-plaintext highlighter-rouge">n</code> matches, unless <code class="language-plaintext highlighter-rouge">n == -1</code> in which case all possible matches will be returned).
Submatches are matches of parenthesized subexpressions (also known as capturing groups) within the regular expression,
numbered from left to right in order of opening parenthesis.
Submatch 0 is the match of the entire expression, submatch 1 is the match of the first parenthesized subexpression, and so on</p>
<h3 id="regexpcompiled_patternfinds">
  
  
    <a href="#regexpcompiled_patternfinds" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find(s)</code>
  
  
</h3>
    

<p>Returns a string representing the left-most match for the given pattern in string <code class="language-plaintext highlighter-rouge">s</code></p>
<h3 id="regexpcompiled_patternfind_submatchs">
  
  
    <a href="#regexpcompiled_patternfind_submatchs" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">regexp/compiled_pattern.find_submatch(s)</code>
  
  
</h3>
    

<p>find_submatch returns a table of strings holding the text of the leftmost match of the regular expression in <code class="language-plaintext highlighter-rouge">s</code> and the matches, if any, of its submatches</p>
<h3 id="stringssplits-sep">
  
  
    <a href="#stringssplits-sep" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">strings/split(s, sep)</code>
  
  
</h3>
    

<p>returns a table of strings, the result of splitting <code class="language-plaintext highlighter-rouge">s</code> with <code class="language-plaintext highlighter-rouge">sep</code>.</p>
<h3 id="stringstrims">
  
  
    <a href="#stringstrims" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">strings/trim(s)</code>
  
  
</h3>
    

<p>Returns a string with all leading and trailing white space removed, as defined by Unicode</p>
<h3 id="stringsreplaces-old-new-n">
  
  
    <a href="#stringsreplaces-old-new-n" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">strings/replace(s, old, new, n)</code>
  
  
</h3>
    

<p>Returns a copy of the string s with the first n non-overlapping instances of <code class="language-plaintext highlighter-rouge">old</code> replaced by <code class="language-plaintext highlighter-rouge">new</code>.
If <code class="language-plaintext highlighter-rouge">old</code> is empty, it matches at the beginning of the string and after each UTF-8 sequence, yielding up to k+1 replacements for a k-rune string.</p>

<p>If n &lt; 0, there is no limit on the number of replacements</p>
<h3 id="stringshas_prefixs-prefix">
  
  
    <a href="#stringshas_prefixs-prefix" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">strings/has_prefix(s, prefix)</code>
  
  
</h3>
    

<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">s</code> begins with <code class="language-plaintext highlighter-rouge">prefix</code></p>
<h3 id="stringshas_suffixs-suffix">
  
  
    <a href="#stringshas_suffixs-suffix" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">strings/has_suffix(s, suffix)</code>
  
  
</h3>
    

<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">s</code> ends with <code class="language-plaintext highlighter-rouge">suffix</code></p>
<h3 id="stringscontainss-substr">
  
  
    <a href="#stringscontainss-substr" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">strings/contains(s, substr)</code>
  
  
</h3>
    

<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">substr</code> is contained anywhere in <code class="language-plaintext highlighter-rouge">s</code></p>
<h3 id="timenow">
  
  
    <a href="#timenow" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/now()</code>
  
  
</h3>
    

<p>Returns a <code class="language-plaintext highlighter-rouge">float64</code> representing the amount of nanoseconds since the unix epoch (01/01/1970 00:00:00).</p>
<h3 id="timeformatepoch_nano-layout-zone">
  
  
    <a href="#timeformatepoch_nano-layout-zone" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/format(epoch_nano, layout, zone)</code>
  
  
</h3>
    

<p>Returns a string representation of the given epoch_nano timestamp for the given Timezone (e.g. <code class="language-plaintext highlighter-rouge">"UTC"</code>, <code class="language-plaintext highlighter-rouge">"America/Los_Angeles"</code>, ‚Ä¶)
The <code class="language-plaintext highlighter-rouge">layout</code> parameter should follow <a href="https://pkg.go.dev/time#pkg-constants" target="_blank">Go‚Äôs time layout format</a>.</p>
<h3 id="timeformat_isoepoch_nano-zone">
  
  
    <a href="#timeformat_isoepoch_nano-zone" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/format_iso(epoch_nano, zone)</code>
  
  
</h3>
    

<p>Returns a string representation of the given <code class="language-plaintext highlighter-rouge">epoch_nano</code> timestamp for the given Timezone (e.g. <code class="language-plaintext highlighter-rouge">"UTC"</code>, <code class="language-plaintext highlighter-rouge">"America/Los_Angeles"</code>, ‚Ä¶)
The returned string will be in <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank">ISO8601</a> format.</p>
<h3 id="timesleepduration_ns">
  
  
    <a href="#timesleepduration_ns" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/sleep(duration_ns)</code>
  
  
</h3>
    

<p>Sleep for <code class="language-plaintext highlighter-rouge">duration_ns</code> nanoseconds</p>
<h3 id="timesinceepoch_nano">
  
  
    <a href="#timesinceepoch_nano" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/since(epoch_nano)</code>
  
  
</h3>
    

<p>Returns the amount of nanoseconds elapsed since <code class="language-plaintext highlighter-rouge">epoch_nano</code></p>
<h3 id="timeaddepoch_time-duration_table">
  
  
    <a href="#timeaddepoch_time-duration_table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/add(epoch_time, duration_table)</code>
  
  
</h3>
    

<p>Returns a new timestamp (in nanoseconds passed since 01/01/1970 00:00:00) for the given <code class="language-plaintext highlighter-rouge">duration</code>.
The <code class="language-plaintext highlighter-rouge">duration</code> should be a table with the following structure:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"time"</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">time</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span> <span class="p">{</span>
    <span class="p">[</span><span class="s2">"hour"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"minute"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"second"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="p">})</span>
</code></pre></div></div>
<p>You may omit any of the fields from the table, resulting in a default value of <code class="language-plaintext highlighter-rouge">0</code> for omitted fields</p>
<h3 id="timeparselayout-value">
  
  
    <a href="#timeparselayout-value" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/parse(layout, value)</code>
  
  
</h3>
    

<p>Returns a <code class="language-plaintext highlighter-rouge">float64</code> representing the amount of nanoseconds since the unix epoch (01/01/1970 00:00:00).
This timestamp will represent date <code class="language-plaintext highlighter-rouge">value</code> parsed using the <code class="language-plaintext highlighter-rouge">layout</code> format.</p>

<p>The <code class="language-plaintext highlighter-rouge">layout</code> parameter should follow <a href="https://pkg.go.dev/time#pkg-constants" target="_blank">Go‚Äôs time layout format</a></p>
<h3 id="timeparse_isovalue">
  
  
    <a href="#timeparse_isovalue" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">time/parse_iso(value)</code>
  
  
</h3>
    

<p>Returns a <code class="language-plaintext highlighter-rouge">float64</code> representing the amount of nanoseconds since the unix epoch (01/01/1970 00:00:00 for <code class="language-plaintext highlighter-rouge">value</code>.
The <code class="language-plaintext highlighter-rouge">value</code> string should be in <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank">ISO8601</a> format</p>
<h3 id="uuidnew">
  
  
    <a href="#uuidnew" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">uuid/new()</code>
  
  
</h3>
    

<p>Returns a new 128-bit <a href="https://www.rfc-editor.org/rfc/rfc4122" target="_blank">RFC 4122 UUID</a> in string representation.</p>
<h3 id="nethttp-optional">
  
  
    <a href="#nethttp-optional" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">net/http</code> (optional)
  
  
</h3>
    

<p>Provides a <code class="language-plaintext highlighter-rouge">request</code> function that performs an HTTP request.
For security reasons, this package is not available by default as it enables http requests to be sent out from the lakeFS instance network. The feature should be enabled under <code class="language-plaintext highlighter-rouge">actions.lua.net_http_enabled</code> <a href="/reference/configuration.html">configuration</a>.
Request will time out after 30 seconds.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">http</span><span class="p">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span> <span class="p">[,</span> <span class="n">body</span><span class="p">])</span>
<span class="n">http</span><span class="p">.</span><span class="n">request</span><span class="p">{</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">string</span><span class="p">,</span>
  <span class="p">[</span><span class="n">method</span> <span class="o">=</span> <span class="n">string</span><span class="p">,]</span>
  <span class="p">[</span><span class="n">headers</span> <span class="o">=</span> <span class="n">header</span><span class="o">-</span><span class="n">table</span><span class="p">,]</span>
  <span class="p">[</span><span class="n">body</span> <span class="o">=</span> <span class="n">string</span><span class="p">,]</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Returns a code (number), body (string), headers (table) and status (string).</p>

<ul>
  <li>code - status code number</li>
  <li>body - string with the response body</li>
  <li>headers - table with the response request headers (key/value or table of values)</li>
  <li>status - status code text</li>
</ul>

<p>The first form of the call will perform GET requests or POST requests if the body parameter is passed.</p>

<p>The second form accepts a table and allows you to customize the request method and headers.</p>

<p>Example of a GET request</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">http</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"net/http"</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">code</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">request</span><span class="p">(</span><span class="s2">"https://example.com"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">200</span> <span class="k">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
<span class="k">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Failed to get example.com - status code: "</span> <span class="o">..</span> <span class="n">code</span><span class="p">)</span>
<span class="k">end</span>

</code></pre></div></div>

<p>Example of a POST request</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">http</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"net/http"</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">code</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">request</span><span class="p">{</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">"https://httpbin.org/post"</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">"POST"</span><span class="p">,</span>
    <span class="n">body</span><span class="o">=</span><span class="s2">"custname=tester"</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{[</span><span class="s2">"Content-Type"</span><span class="p">]</span><span class="o">=</span><span class="s2">"application/x-www-form-urlencoded"</span><span class="p">},</span>
<span class="p">}</span>
<span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">200</span> <span class="k">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
<span class="k">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Failed to post data - status code: "</span> <span class="o">..</span> <span class="n">code</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>
<h2 id="example-hooks">
  
  
    <a href="#example-hooks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example Hooks
  
  
</h2>
    

<p>This example will simply print out a JSON representation of the event that occurred:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">dump_all</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">post-commit</span><span class="pi">:</span>
  <span class="na">post-merge</span><span class="pi">:</span>
  <span class="na">post-create-tag</span><span class="pi">:</span>
  <span class="na">post-create-branch</span><span class="pi">:</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">dump_event</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">json = require("encoding/json")</span>
        <span class="s">print(json.marshal(action))</span>
</code></pre></div></div>

<p>A more useful example: ensure every commit contains a required metadata field:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">pre commit metadata field check</span>
<span class="na">on</span><span class="pi">:</span>
<span class="na">pre-commit</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">main</span>
    <span class="pi">-</span> <span class="s">dev</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">ensure_commit_metadata</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">args</span><span class="pi">:</span>
        <span class="na">notebook_url</span><span class="pi">:</span> <span class="pi">{</span><span class="s2">"</span><span class="s">pattern"</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my-jupyter.example.com/.*"</span><span class="pi">}</span>
        <span class="na">spark_version</span><span class="pi">:</span>  <span class="pi">{}</span>
      <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">regexp = require("regexp")</span>
        <span class="s">for k, props in pairs(args) do</span>
          <span class="s">current_value = action.commit.metadata[k]</span>
          <span class="s">if current_value == nil then</span>
            <span class="s">error("missing mandatory metadata field: " .. k)</span>
          <span class="s">end</span>
          <span class="s">if props.pattern and not regexp.match(props.pattern, current_value) then</span>
            <span class="s">error("current value for commit metadata field " .. k .. " does not match pattern: " .. props.pattern .. " - got: " .. current_value)</span>
          <span class="s">end</span>
        <span class="s">end</span>
</code></pre></div></div>

<p>For more examples and configuration samples, check out the <a href="https://github.com/treeverse/lakeFS/tree/master/examples/hooks">examples/hooks/</a> directory in the lakeFS repository.</p>

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button" >
                            <img src="/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/assets/icons/github.svg" class="no-hover" />
                            <img src="/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://data-folks.masto.host/@lakeFS" class="site-button" >
                            <img src="/assets/icons/mastodon.svg" class="no-hover" />
                            <img src="/assets/icons/mastodon-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/assets/icons/slack.svg" class="no-hover" />
                            <img src="/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>




<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  

  <link rel="shortcut icon" href="/v0.48/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="/v0.48/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/v0.48/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="/v0.48/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Exporting Data | lakeFS</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Exporting Data" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Use lakeFS Spark client to export lakeFS commit to the object store." />
<meta property="og:description" content="Use lakeFS Spark client to export lakeFS commit to the object store." />
<meta property="og:site_name" content="lakeFS" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Exporting Data" />
<script type="application/ld+json">
{"description":"Use lakeFS Spark client to export lakeFS commit to the object store.","@type":"WebPage","url":"/v0.48/reference/export.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/v0.48/assets/logo.svg"}},"headline":"Exporting Data","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->
<meta name="robots" content="noindex">
<meta property="og:image" content="/v0.48/assets/img/shared-image.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/js/fontawesome.min.js" integrity="sha512-i3N2a3sMtKOQHXCJF3qEpce5twcGN9mRsWQe6PUTf9WS/eG5XkivI97uxit7B2nRGz5XuoszBaqndSqxdeVfag==" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<script src="/v0.48/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>


</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS" aria-label="Search lakeFS"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + this.value;">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    versions.reverse();
                    for (let versionObj of versions) {
                        const el = document.createElement("option");
                        el.value = versionObj.version;
                        el.textContent = versionObj.title;
                        if (versionObj.version === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/v0.48/"
           class="nav-list-link">What is lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.48/quickstart/"
           class="nav-list-link">Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.48/quickstart/installing.html"
                   class="nav-list-link">Install lakeFS</a></li><li class="nav-list-item "><a href="/v0.48/quickstart/repository.html"
                   class="nav-list-link">Create a Repository</a></li><li class="nav-list-item "><a href="/v0.48/quickstart/aws_cli.html"
                   class="nav-list-link">Add Data</a></li><li class="nav-list-item "><a href="/v0.48/quickstart/lakefs_cli.html"
                   class="nav-list-link">Install lakeFS CLI</a></li><li class="nav-list-item "><a href="/v0.48/quickstart/more_quickstart_options.html"
                   class="nav-list-link">More Quickstart Options</a></li><li class="nav-list-item "><a href="/v0.48/quickstart/try.html"
                   class="nav-list-link">Try without installing</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.48/deploy/"
           class="nav-list-link">Deploy lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.48/deploy/aws.html"
                   class="nav-list-link">On AWS</a></li><li class="nav-list-item "><a href="/v0.48/deploy/azure.html"
                   class="nav-list-link">On Azure</a></li><li class="nav-list-item "><a href="/v0.48/deploy/gcp.html"
                   class="nav-list-link">On GCP</a></li><li class="nav-list-item "><a href="/v0.48/deploy/k8s.html"
                   class="nav-list-link">With Kubernetes</a></li><li class="nav-list-item "><a href="/v0.48/deploy/docker.html"
                   class="nav-list-link">With Docker</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.48/setup/"
           class="nav-list-link">Setup lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v0.48/setup/storage/"
                   class="nav-list-link">Prepare Your Storage</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v0.48/setup/storage/s3.html"
                           class="nav-list-link">AWS S3</a>
                    </li><li class="nav-list-item ">
                        <a href="/v0.48/setup/storage/gcs.html"
                           class="nav-list-link">Google Cloud Storage</a>
                    </li><li class="nav-list-item ">
                        <a href="/v0.48/setup/storage/blob.html"
                           class="nav-list-link">Azure Blob Storage</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v0.48/setup/create-repo.html"
                   class="nav-list-link">Create a Repository</a></li><li class="nav-list-item "><a href="/v0.48/setup/import.html"
                   class="nav-list-link">Import data into lakeFS</a></li><li class="nav-list-item "><a href="/v0.48/setup/hooks.html"
                   class="nav-list-link">Hooks</a></li><li class="nav-list-item "><a href="/v0.48/setup/virtual-host-addressing.html"
                   class="nav-list-link">S3 Virtual-host addressing (advanced)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.48/usecases/"
           class="nav-list-link">Using lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.48/usecases/data-devenv.html"
                   class="nav-list-link">In Development</a></li><li class="nav-list-item "><a href="/v0.48/usecases/ci.html"
                   class="nav-list-link">During Deployment</a></li><li class="nav-list-item "><a href="/v0.48/usecases/production.html"
                   class="nav-list-link">In Production</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.48/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.48/reference/api.html"
                   class="nav-list-link">API Reference</a></li><li class="nav-list-item "><a href="/v0.48/reference/s3.html"
                   class="nav-list-link">S3 Supported API</a></li><li class="nav-list-item "><a href="/v0.48/reference/configuration.html"
                   class="nav-list-link">Configuration Reference</a></li><li class="nav-list-item "><a href="/v0.48/reference/commands.html"
                   class="nav-list-link">Command (CLI) Reference</a></li><li class="nav-list-item  active"><a href="/v0.48/reference/export.html"
                   class="nav-list-link active">Exporting Data</a></li><li class="nav-list-item "><a href="/v0.48/reference/garbage-collection.html"
                   class="nav-list-link">Garbage Collection</a></li><li class="nav-list-item "><a href="/v0.48/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/v0.48/reference/offboarding.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/v0.48/reference/upgrade.html"
                   class="nav-list-link">Upgrade lakeFS</a></li><li class="nav-list-item "><a href="/v0.48/reference/authorization.html"
                   class="nav-list-link">Authentication & Authorization</a></li><li class="nav-list-item "><a href="/v0.48/reference/object-model.html"
                   class="nav-list-link">Object Model</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.48/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.48/integrations/distcp.html"
                   class="nav-list-link">Copying Data with DistCp</a></li><li class="nav-list-item "><a href="/v0.48/integrations/rclone.html"
                   class="nav-list-link">Copying data with Rclone</a></li><li class="nav-list-item "><a href="/v0.48/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/v0.48/integrations/spark.html"
                   class="nav-list-link">Spark</a></li><li class="nav-list-item "><a href="/v0.48/integrations/hive.html"
                   class="nav-list-link">Hive</a></li><li class="nav-list-item "><a href="/v0.48/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/v0.48/integrations/emr.html"
                   class="nav-list-link">EMR</a></li><li class="nav-list-item "><a href="/v0.48/integrations/presto_trino.html"
                   class="nav-list-link">Presto/Trino</a></li><li class="nav-list-item "><a href="/v0.48/integrations/boto.html"
                   class="nav-list-link">Boto (Python)</a></li><li class="nav-list-item "><a href="/v0.48/integrations/minio.html"
                   class="nav-list-link">MinIO</a></li><li class="nav-list-item "><a href="/v0.48/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/v0.48/integrations/airflow.html"
                   class="nav-list-link">Airflow</a></li><li class="nav-list-item "><a href="/v0.48/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/v0.48/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/v0.48/integrations/databricks.html"
                   class="nav-list-link">Databricks</a></li><li class="nav-list-item "><a href="/v0.48/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/v0.48/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/v0.48/integrations/glue_etl.html"
                   class="nav-list-link">Glue ETL</a></li><li class="nav-list-item "><a href="/v0.48/integrations/kakfa.html"
                   class="nav-list-link">Kafka</a></li><li class="nav-list-item "><a href="/v0.48/integrations/mapreduce.html"
                   class="nav-list-link">MapReduce</a></li><li class="nav-list-item "><a href="/v0.48/integrations/sagemaker.html"
                   class="nav-list-link">SageMaker</a></li><li class="nav-list-item "><a href="/v0.48/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v0.48/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v0.48/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/v0.48/understand/data-model.html"
                   class="nav-list-link">Data Model</a></li><li class="nav-list-item "><a href="/v0.48/understand/branching-model.html"
                   class="nav-list-link">Branching Model</a></li><li class="nav-list-item "><a href="/v0.48/understand/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li><li class="nav-list-item "><a href="/v0.48/understand/roadmap.html"
                   class="nav-list-link">Roadmap</a></li><li class="nav-list-item "><a href="/v0.48/understand/licensing.html"
                   class="nav-list-link">Licensing</a></li></ul></li><li
            class="nav-list-item"><a href="/v0.48/contributing.html"
           class="nav-list-link">Contributing</a></li><li
            class="nav-list-item"><a href="/v0.48/faq.html"
           class="nav-list-link">FAQ</a></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                GitHub
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Blog
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Get Started
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                GitHub
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Blog
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
               rel="noopener noreferrer" >
                Get Started
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/v0.48/reference/">Reference</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Exporting Data</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                <h1 class="no_toc" id="exporting-data">
        
        
          <a href="#exporting-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exporting Data
        
        
      </h1>
    
<p>The export operation copies all data from a given lakeFS commit to
a designated object store location.</p>

<p>For instance, the contents <code class="language-plaintext highlighter-rouge">lakefs://example/main</code> might be exported on
<code class="language-plaintext highlighter-rouge">s3://company-bucket/example/latest</code>.  Clients entirely unaware of lakeFS could use that
base URL to access latest files on <code class="language-plaintext highlighter-rouge">main</code>.  Clients aware of lakeFS can continue to use
the lakeFS S3 endpoint to access repository files on <code class="language-plaintext highlighter-rouge">s3://example/main</code>, as well as
other versions and uncommitted versions.</p>

<p>Possible use-cases:</p>
<ol>
  <li>External consumers of data don’t have access to your lakeFS installation.</li>
  <li>Some data pipelines in the organization are not fully migrated to lakeFS.</li>
  <li>You want to experiment with lakeFS as a side-by-side installation first.</li>
  <li>Create copies of your data lake in other regions (taking into account read pricing).</li>
</ol>

<div class="toc-block">
      <h2 class="no_toc text-delta" id="table-of-contents">
        
        
          <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
        
        
      </h2>
    

<ol id="markdown-toc">
  <li><a href="#how-to-use" id="markdown-toc-how-to-use">How to use</a>    <ol>
      <li><a href="#using-spark-submit" id="markdown-toc-using-spark-submit">Using spark-submit</a></li>
      <li><a href="#using-custom-code-notebookspark" id="markdown-toc-using-custom-code-notebookspark">Using custom code (notebook/spark)</a></li>
    </ol>
  </li>
  <li><a href="#successfailure-indications" id="markdown-toc-successfailure-indications">Success/Failure Indications</a></li>
  <li><a href="#export-rounds-spark-success-files" id="markdown-toc-export-rounds-spark-success-files">Export Rounds (Spark success files)</a></li>
  <li><a href="#example" id="markdown-toc-example">Example</a></li>
</ol>

</div>
      <h2 id="how-to-use">
        
        
          <a href="#how-to-use" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How to use
        
        
      </h2>
    
      <h3 id="using-spark-submit">
        
        
          <a href="#using-spark-submit" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using spark-submit
        
        
      </h3>
    
<p>You can use the export main in 3 different modes:</p>

<ol>
  <li>
    <p>Export all objects from branch <code class="language-plaintext highlighter-rouge">example-branch</code> on <code class="language-plaintext highlighter-rouge">example-repo</code> repository to s3 location <code class="language-plaintext highlighter-rouge">s3://example-bucket/prefix/</code>:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.... example-repo s3://example-bucket/prefix/ <span class="nt">--branch</span><span class="o">=</span>example-branch
</code></pre></div>    </div>
  </li>
  <li>
    <p>Export all objects from a commit <code class="language-plaintext highlighter-rouge">c805e49bafb841a0875f49cd555b397340bbd9b8</code> on <code class="language-plaintext highlighter-rouge">example-repo</code> repository to s3 location <code class="language-plaintext highlighter-rouge">s3://example-bucket/prefix/</code>:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.... example-repo s3://example-bucket/prefix/ <span class="nt">--commit_id</span><span class="o">=</span>c805e49bafb841a0875f49cd555b397340bbd9b8
</code></pre></div>    </div>
  </li>
  <li>
    <p>Export only the diff between branch <code class="language-plaintext highlighter-rouge">example-branch</code> and commit <code class="language-plaintext highlighter-rouge">c805e49bafb841a0875f49cd555b397340bbd9b8</code>
on <code class="language-plaintext highlighter-rouge">example-repo</code> repository to s3 location <code class="language-plaintext highlighter-rouge">s3://example-bucket/prefix/</code>:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.... example-repo s3://example-bucket/prefix/ <span class="nt">--branch</span><span class="o">=</span>example-branch <span class="nt">--prev_commit_id</span><span class="o">=</span>c805e49bafb841a0875f49cd555b397340bbd9b8
</code></pre></div>    </div>
  </li>
</ol>

<p>The complete <code class="language-plaintext highlighter-rouge">spark-submit</code> command would look like:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spark-submit <span class="nt">--conf</span> spark.hadoop.lakefs.api.url<span class="o">=</span>https://&lt;LAKEFS_ENDPOINT&gt;/api/v1 <span class="se">\</span>
  <span class="nt">--conf</span> spark.hadoop.lakefs.api.access_key<span class="o">=</span>&lt;LAKEFS_ACCESS_KEY_ID&gt; <span class="se">\</span>
  <span class="nt">--conf</span> spark.hadoop.lakefs.api.secret_key<span class="o">=</span>&lt;LAKEFS_SECRET_ACCESS_KEY&gt; <span class="se">\</span>
  <span class="nt">--packages</span> io.lakefs:lakefs-spark-client-301_2.12:0.1.0 <span class="se">\</span>
  <span class="nt">--class</span> io.treeverse.clients.Main export-app example-repo s3://example-bucket/prefix <span class="se">\</span>
  <span class="nt">--branch</span><span class="o">=</span>example-branch
</code></pre></div></div>

<p class="note">The command assumes the spark cluster has permissions to write to <code class="language-plaintext highlighter-rouge">s3://example-bucket/prefix</code>.
Otherwise, add <code class="language-plaintext highlighter-rouge">spark.hadoop.fs.s3a.access.key</code> and <code class="language-plaintext highlighter-rouge">spark.hadoop.fs.s3a.secret.key</code> with the proper credentials.</p>
      <h3 id="using-custom-code-notebookspark">
        
        
          <a href="#using-custom-code-notebookspark" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using custom code (notebook/spark)
        
        
      </h3>
    
<p>Set up lakeFS Spark metadata client with the endpoint and credentials as instructed in the previous <a href="/v0.48/reference/spark-client.html">page</a>.</p>

<p>The client exposes the <code class="language-plaintext highlighter-rouge">Exporter</code> object with 3 export options:</p>

<ol>
  <li>Export <em>all</em> objects at the HEAD of a given branch. Does not include
files that were added to that branch, but were not committed.</li>
</ol>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">exportAllFromBranch</span><span class="o">(</span><span class="n">branch</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
</code></pre></div></div>

<ol>
  <li>Export ALL objects from a commit:</li>
</ol>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">exportAllFromCommit</span><span class="o">(</span><span class="n">commitID</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
</code></pre></div></div>

<ol>
  <li>
    <p>Export just the diff between a commit and the HEAD of a branch.
This is the ideal option for continuous exports of a branch, as it will change only the files
that have been changed since the previous commit.</p>

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">exportFrom</span><span class="o">(</span><span class="n">branch</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">prevCommitID</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
</code></pre></div>    </div>
  </li>
</ol>
      <h2 id="successfailure-indications">
        
        
          <a href="#successfailure-indications" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Success/Failure Indications
        
        
      </h2>
    

<p>When the Spark export operation ends, an additional status file will be added to the root
object storage destination.
If all files were exported successfully the file path will be of form: <code class="language-plaintext highlighter-rouge">EXPORT_&lt;commitID&gt;_&lt;ISO-8601-time-UTC&gt;_SUCCESS</code>.
For failures: the form will be<code class="language-plaintext highlighter-rouge">EXPORT_&lt;commitID&gt;_&lt;ISO-8601-time-UTC&gt;_FAILURE</code>, and the file will include a log of the failed files operations.</p>
      <h2 id="export-rounds-spark-success-files">
        
        
          <a href="#export-rounds-spark-success-files" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Export Rounds (Spark success files)
        
        
      </h2>
    
<p>Some files should be exported before others, e.g. a Spark <code class="language-plaintext highlighter-rouge">_SUCCESS</code> file exported before other files under
the same prefix might send the wrong indication.</p>

<p>The export operation may contain several <em>rounds</em> within the same export.
A failing round will stop the export of all the files of the next <code class="language-plaintext highlighter-rouge">rounds</code>.</p>

<p>By default, lakeFS will use the <code class="language-plaintext highlighter-rouge">SparkFilter</code> and have 2 <code class="language-plaintext highlighter-rouge">rounds</code> for each export.
The first round will export any non Spark <code class="language-plaintext highlighter-rouge">_SUCCESS</code> files. Second round will export all Spark’s <code class="language-plaintext highlighter-rouge">_SUCCESS</code> files.
You may override the default behaviour by passing a custom <code class="language-plaintext highlighter-rouge">filter</code> to the <code class="language-plaintext highlighter-rouge">Exporter</code>.</p>
      <h2 id="example">
        
        
          <a href="#example" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example
        
        
      </h2>
    

<ol>
  <li>
    <p>First configure the <code class="language-plaintext highlighter-rouge">Exporter</code> instance:</p>

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">io.treeverse.clients.</span><span class="o">{</span><span class="nc">ApiClient</span><span class="o">,</span> <span class="nc">Exporter</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.SparkSession</span>

<span class="k">val</span> <span class="nv">endpoint</span> <span class="k">=</span> <span class="s">"http://&lt;LAKEFS_ENDPOINT&gt;/api/v1"</span>
<span class="k">val</span> <span class="nv">accessKey</span> <span class="k">=</span> <span class="s">"&lt;LAKEFS_ACCESS_KEY_ID&gt;"</span>
<span class="k">val</span> <span class="nv">secretKey</span> <span class="k">=</span> <span class="s">"&lt;LAKEFS_SECRET_ACCESS_KEY&gt;"</span>

<span class="k">val</span> <span class="nv">repo</span> <span class="k">=</span> <span class="s">"example-repo"</span>

<span class="k">val</span> <span class="nv">spark</span> <span class="k">=</span> <span class="nv">SparkSession</span><span class="o">.</span><span class="py">builder</span><span class="o">().</span><span class="py">appName</span><span class="o">(</span><span class="s">"I can export"</span><span class="o">).</span><span class="py">master</span><span class="o">(</span><span class="s">"local"</span><span class="o">).</span><span class="py">getOrCreate</span><span class="o">()</span>
<span class="k">val</span> <span class="nv">sc</span> <span class="k">=</span> <span class="nv">spark</span><span class="o">.</span><span class="py">sparkContext</span>
<span class="nv">sc</span><span class="o">.</span><span class="py">hadoopConfiguration</span><span class="o">.</span><span class="py">set</span><span class="o">(</span><span class="s">"lakefs.api.url"</span><span class="o">,</span> <span class="n">endpoint</span><span class="o">)</span>
<span class="nv">sc</span><span class="o">.</span><span class="py">hadoopConfiguration</span><span class="o">.</span><span class="py">set</span><span class="o">(</span><span class="s">"lakefs.api.access_key"</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">)</span>
<span class="nv">sc</span><span class="o">.</span><span class="py">hadoopConfiguration</span><span class="o">.</span><span class="py">set</span><span class="o">(</span><span class="s">"lakefs.api.secret_key"</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">)</span>

<span class="c1">// Add any required spark context configuration for s3</span>
<span class="k">val</span> <span class="nv">rootLocation</span> <span class="k">=</span> <span class="s">"s3://company-bucket/example/latest"</span>

<span class="k">val</span> <span class="nv">apiClient</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ApiClient</span><span class="o">(</span><span class="n">endpoint</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">exporter</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Exporter</span><span class="o">(</span><span class="n">spark</span><span class="o">,</span> <span class="n">apiClient</span><span class="o">,</span> <span class="n">repo</span><span class="o">,</span> <span class="n">rootLocation</span><span class="o">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Now you can export all objects from <code class="language-plaintext highlighter-rouge">main</code> branch to <code class="language-plaintext highlighter-rouge">s3://company-bucket/example/latest</code>:</p>

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">branch</span> <span class="k">=</span> <span class="s">"main"</span>
<span class="nv">exporter</span><span class="o">.</span><span class="py">exportAllFromBranch</span><span class="o">(</span><span class="n">branch</span><span class="o">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Assuming a previous successful export on commit <code class="language-plaintext highlighter-rouge">f3c450d8cd0e84ac67e7bc1c5dcde9bef82d8ba7</code>,
you can alternatively export just the difference between <code class="language-plaintext highlighter-rouge">main</code> branch and the commit:</p>

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">branch</span> <span class="k">=</span> <span class="s">"main"</span>
<span class="k">val</span> <span class="nv">commit</span> <span class="k">=</span> <span class="s">"f3c450d8cd0e84ac67e7bc1c5dcde9bef82d8ba7"</span>
<span class="nv">exporter</span><span class="o">.</span><span class="py">exportFrom</span><span class="o">(</span><span class="n">branch</span><span class="o">,</span> <span class="n">commit</span><span class="o">)</span>
</code></pre></div>    </div>
  </li>
</ol>

                

                


            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <a href="https://lakefs.io" class="site-title lh-tight">
                <div class="site-logo"></div>
            </a>
        </div>
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.48/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/v0.48/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.48/assets/icons/github.svg" class="no-hover" />
                            <img src="/v0.48/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.48/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/v0.48/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            <img src="/v0.48/assets/icons/slack.svg" class="no-hover" />
                            <img src="/v0.48/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left"><a href="/v0.48https://www.treeverse.io/">
                    <div class="other-logo"><img src="/v0.48/assets/by-treeverse.png" /></div>
                </a></div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button"  target="_blank"
                            rel="noopener noreferrer" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>


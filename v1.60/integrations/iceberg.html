

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/v1.60/assets/css/just-the-docs-default.css">
  
  <style type="text/css">
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(4) > .nav-list > .nav-list-item:nth-child(7) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #ebedf5 0%, rgba(235, 237, 245, 0.8) 80%, rgba(235, 237, 245, 0) 100%); }

.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list-expander svg, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list > .nav-list-item:not(.passive):nth-child(7) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list > .nav-list-item:not(.passive):nth-child(7) > .nav-list { display: block; }

.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list { display: block; }

</style>


  

  
    <script src="/v1.60/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/v1.60/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/v1.60/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Apache Iceberg | lakeFS Documentation</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Apache Iceberg" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to integrate lakeFS with Apache Iceberg" />
<meta property="og:description" content="How to integrate lakeFS with Apache Iceberg" />
<meta property="og:site_name" content="lakeFS Documentation" />
<meta property="og:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="twitter:title" content="Apache Iceberg" />
<meta name="twitter:site" content="@lakeFS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"How to integrate lakeFS with Apache Iceberg","headline":"Apache Iceberg","image":"https://docs.lakefs.io/assets/img/docs_logo.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/v1.60/assets/logo.svg"}},"url":"/v1.60/integrations/iceberg.html"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<!-- type="text/plain" is intentional for cookie consent support -->
<script type="text/plain" data-category="analytics">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->

<meta name="robots" content="noindex">

<meta property="og:image" content="/v1.60/assets/img/lakefs-logo-with-text.png">
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<link rel="stylesheet" href="/v1.60/assets/css/cookieconsent.css" />
<script type="module" src="/v1.60/assets/js/cookieconsent-init.js"></script>
<script src="/v1.60/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/v1.60/assets/js/feedback.js"></script>


</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<img src="/assets/img/cookies.png" style="display: none;">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="lakeFS Documentation"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS Documentation" aria-label="Search lakeFS Documentation"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/v1.60/"
           class="nav-list-link">Welcome to lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/quickstart/"
           class="nav-list-link">⭐ Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.60/quickstart/launch.html"
                   class="nav-list-link">1️⃣ Run lakeFS</a></li><li class="nav-list-item "><a href="/v1.60/quickstart/query.html"
                   class="nav-list-link">2️⃣ Query the data</a></li><li class="nav-list-item "><a href="/v1.60/quickstart/branch.html"
                   class="nav-list-link">3️⃣ Create a branch</a></li><li class="nav-list-item "><a href="/v1.60/quickstart/commit-and-merge.html"
                   class="nav-list-link">4️⃣ Commit and Merge</a></li><li class="nav-list-item "><a href="/v1.60/quickstart/rollback.html"
                   class="nav-list-link">5️⃣ Roll back Changes</a></li><li class="nav-list-item "><a href="/v1.60/quickstart/actions-and-hooks.html"
                   class="nav-list-link">6️⃣ Using Actions and Hooks in lakeFS</a></li><li class="nav-list-item "><a href="/v1.60/quickstart/work-with-data-locally.html"
                   class="nav-list-link">7️⃣ Work with lakeFS data locally</a></li><li class="nav-list-item "><a href="/v1.60/quickstart/learning-more-lakefs.html"
                   class="nav-list-link">Learn more about lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/howto/deploy/"
                   class="nav-list-link">Install lakeFS</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/howto/deploy/aws.html"
                           class="nav-list-link">AWS</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/deploy/azure.html"
                           class="nav-list-link">Azure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/deploy/gcp.html"
                           class="nav-list-link">GCP</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/deploy/onprem.html"
                           class="nav-list-link">On-Premises</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/deploy/upgrade.html"
                           class="nav-list-link">Upgrade lakeFS</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/howto/hooks/"
                   class="nav-list-link">Actions and Hooks</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/howto/hooks/airflow.html"
                           class="nav-list-link">Airflow Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/hooks/lua.html"
                           class="nav-list-link">Lua Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/hooks/webhooks.html"
                           class="nav-list-link">Webhooks</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.60/howto/backup-and-restore.html"
                   class="nav-list-link">Backup and Restore Repository</a></li><li class="nav-list-item "><a href="/v1.60/howto/protect-branches.html"
                   class="nav-list-link">Branch Protection</a></li><li class="nav-list-item "><a href="/v1.60/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/v1.60/howto/catalog_exports.html"
                   class="nav-list-link">Data Catalogs Exports</a></li><li class="nav-list-item "><a href="/v1.60/howto/export.html"
                   class="nav-list-link">Export Data</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/howto/garbage-collection/"
                   class="nav-list-link">Garbage Collection</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/howto/garbage-collection/gc.html"
                           class="nav-list-link">Garbage Collection</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/garbage-collection/managed-gc.html"
                           class="nav-list-link">Managed Garbage Collection<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/howto/garbage-collection/standalone-gc.html"
                           class="nav-list-link">Standalone Garbage Collection<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.60/howto/import.html"
                   class="nav-list-link">Import Data</a></li><li class="nav-list-item "><a href="/v1.60/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/v1.60/howto/mirroring.html"
                   class="nav-list-link">Mirroring<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/howto/multiple-storage-backends.html"
                   class="nav-list-link">Multiple Storage Backend<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/howto/private-link.html"
                   class="nav-list-link">Private Link</a></li><li class="nav-list-item "><a href="/v1.60/howto/pull-requests.html"
                   class="nav-list-link">Pull Requests</a></li><li class="nav-list-item "><a href="/v1.60/howto/virtual-host-addressing.html"
                   class="nav-list-link">S3 Virtual-host addressing (advanced)</a></li><li class="nav-list-item "><a href="/v1.60/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li><li class="nav-list-item "><a href="/v1.60/howto/scim.html"
                   class="nav-list-link">System for Cross-domain Identity Management (SCIM)<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/howto/local-checkouts.html"
                   class="nav-list-link">Work with lakeFS data locally</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.60/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/v1.60/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/v1.60/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/v1.60/integrations/sagemaker.html"
                   class="nav-list-link">Amazon SageMaker</a></li><li class="nav-list-item "><a href="/v1.60/integrations/airflow.html"
                   class="nav-list-link">Apache Airflow</a></li><li class="nav-list-item "><a href="/v1.60/integrations/hive.html"
                   class="nav-list-link">Apache Hive</a></li><li class="nav-list-item  active"><a href="/v1.60/integrations/iceberg.html"
                   class="nav-list-link active">Apache Iceberg<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/integrations/kafka.html"
                   class="nav-list-link">Apache Kafka</a></li><li class="nav-list-item "><a href="/v1.60/integrations/spark.html"
                   class="nav-list-link">Apache Spark</a></li><li class="nav-list-item "><a href="/v1.60/integrations/cloudera.html"
                   class="nav-list-link">Cloudera</a></li><li class="nav-list-item "><a href="/v1.60/integrations/databricks.html"
                   class="nav-list-link">Databricks</a></li><li class="nav-list-item "><a href="/v1.60/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/v1.60/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/v1.60/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/v1.60/integrations/git.html"
                   class="nav-list-link">Git</a></li><li class="nav-list-item "><a href="/v1.60/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item "><a href="/v1.60/integrations/glue_metastore.html"
                   class="nav-list-link">Glue Data Catalog</a></li><li class="nav-list-item "><a href="/v1.60/integrations/huggingface_datasets.html"
                   class="nav-list-link">HuggingFace Datasets</a></li><li class="nav-list-item "><a href="/v1.60/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/v1.60/integrations/mlflow.html"
                   class="nav-list-link">MLflow</a></li><li class="nav-list-item "><a href="/v1.60/integrations/presto_trino.html"
                   class="nav-list-link">Presto / Trino</a></li><li class="nav-list-item "><a href="/v1.60/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/v1.60/integrations/r.html"
                   class="nav-list-link">R</a></li><li class="nav-list-item "><a href="/v1.60/integrations/red_hat_openshift_ai.html"
                   class="nav-list-link">Red Hat OpenShift AI</a></li><li class="nav-list-item "><a href="/v1.60/integrations/unity-catalog.html"
                   class="nav-list-link">Unity Catalog</a></li><li class="nav-list-item "><a href="/v1.60/integrations/vertex_ai.html"
                   class="nav-list-link">Vertex AI</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.60/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/v1.60/understand/model.html"
                   class="nav-list-link">Concepts and  Model</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.60/understand/data-structure.html"
                   class="nav-list-link">Data Structure</a></li><li class="nav-list-item "><a href="/v1.60/understand/faq.html"
                   class="nav-list-link">FAQ</a></li><li class="nav-list-item "><a href="/v1.60/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/understand/how/"
                   class="nav-list-link">How lakeFS Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.60/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/understand/use_cases/"
                   class="nav-list-link">Use Cases</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/understand/use_cases/cicd_for_data.html"
                           class="nav-list-link">CI/CD for Data Lakes</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/understand/use_cases/etl_testing.html"
                           class="nav-list-link">ETL Testing Environment</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/understand/use_cases/reproducibility.html"
                           class="nav-list-link">Reproducibility</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/understand/use_cases/rollback.html"
                           class="nav-list-link">Rollback</a>
                    </li></ul></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/reference/mount.html"
                   class="nav-list-link">Mount<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/reference/mount-csi-driver.html"
                           class="nav-list-link">Mount CSI Driver</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/reference/mount-write-mode-semantics.html"
                           class="nav-list-link">Mount Write Mode Semantics</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.60/reference/auditing.html"
                   class="nav-list-link">Auditing<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/v1.60/reference/s3.html"
                   class="nav-list-link">S3 Gateway API</a></li><li class="nav-list-item "><a href="/v1.60/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/v1.60/reference/api.html"
                   class="nav-list-link">lakeFS API</a></li><li class="nav-list-item "><a href="/v1.60/reference/configuration.html"
                   class="nav-list-link">lakeFS Server Configuration</a></li><li class="nav-list-item "><a href="/v1.60/reference/cli.html"
                   class="nav-list-link">lakectl (lakeFS command-line tool)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/project/"
           class="nav-list-link">The lakeFS Project</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.60/project/contributing.html"
                   class="nav-list-link">Contributing to lakeFS</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/project/docs/"
                   class="nav-list-link">Documentation</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/project/docs/callouts.html"
                           class="nav-list-link">Callouts</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.60/project/code-migrate-1.0-sdk.html"
                   class="nav-list-link">Migrating to 1.0</a></li></ul></li><li
            class="nav-list-item"><a href="/v1.60/cloud/"
           class="nav-list-link">lakeFS Cloud</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/enterprise/"
           class="nav-list-link">lakeFS Enterprise</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/v1.60/enterprise/getstarted/"
                   class="nav-list-link">Get Started</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/v1.60/enterprise/getstarted/quickstart.html"
                           class="nav-list-link">Quickstart</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/enterprise/getstarted/install.html"
                           class="nav-list-link">Install</a>
                    </li><li class="nav-list-item ">
                        <a href="/v1.60/enterprise/getstarted/migrate-from-oss.html"
                           class="nav-list-link">Migrate from lakeFS OSS</a>
                    </li></ul></li><li class="nav-list-item "><a href="/v1.60/enterprise/upgrade.html"
                   class="nav-list-link">Upgrade</a></li><li class="nav-list-item "><a href="/v1.60/enterprise/troubleshooting.html"
                   class="nav-list-link">Troubleshooting lakeFS Enterprise</a></li><li class="nav-list-item "><a href="/v1.60/enterprise/configuration.html"
                   class="nav-list-link">Configuration Reference</a></li><li class="nav-list-item "><a href="/v1.60/enterprise/architecture.html"
                   class="nav-list-link">Architecture</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/v1.60/security/"
           class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.60/security/ACL-server-implementation.html"
                   class="nav-list-link">ACL Server Implementation</a></li><li class="nav-list-item "><a href="/v1.60/security/access-control-lists.html"
                   class="nav-list-link">Access Control Lists (ACLs) -Deprecated-</a></li><li class="nav-list-item "><a href="/v1.60/security/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/v1.60/security/authorization-yaml.html"
                   class="nav-list-link">Authorization API</a></li><li class="nav-list-item "><a href="/v1.60/security/external-principals-aws.html"
                   class="nav-list-link">Login to lakeFS with AWS IAM Roles<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/security/presigned-url.html"
                   class="nav-list-link">Presigned URLs</a></li><li class="nav-list-item "><a href="/v1.60/security/remote-authenticator.html"
                   class="nav-list-link">Remote Authenticator</a></li><li class="nav-list-item "><a href="/v1.60/security/rbac.html"
                   class="nav-list-link">Role-Based Access Control (RBAC)<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/security/sts-login.html"
                   class="nav-list-link">Short-lived token (STS like) Authentication for lakeFS<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li><li class="nav-list-item "><a href="/v1.60/security/sso.html"
                   class="nav-list-link">Single Sign On (SSO)<span class="badge badge-enterprise" title="Enterprise">Enterprise</span></a></li></ul></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/v1.60/integrations/">Integrations</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Apache Iceberg</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 id="using-lakefs-with-apache-iceberg">
  
  
    <a href="#using-lakefs-with-apache-iceberg" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using lakeFS with Apache Iceberg
  
  
</h1>
    

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#lakefs-iceberg-rest-catalog" id="markdown-toc-lakefs-iceberg-rest-catalog">lakeFS Iceberg REST Catalog</a>    <ol>
      <li><a href="#what-is-lakefs-iceberg-rest-catalog" id="markdown-toc-what-is-lakefs-iceberg-rest-catalog">What is lakeFS Iceberg REST Catalog?</a></li>
      <li><a href="#use-cases" id="markdown-toc-use-cases">Use Cases</a></li>
      <li><a href="#configuration" id="markdown-toc-configuration">Configuration</a></li>
      <li><a href="#namespaces-and-tables" id="markdown-toc-namespaces-and-tables">Namespaces and Tables</a></li>
      <li><a href="#table-operations" id="markdown-toc-table-operations">Table Operations</a></li>
      <li><a href="#version-control-features" id="markdown-toc-version-control-features">Version Control Features</a></li>
      <li><a href="#authentication" id="markdown-toc-authentication">Authentication</a></li>
      <li><a href="#limitations" id="markdown-toc-limitations">Limitations</a></li>
      <li><a href="#table-maintenance" id="markdown-toc-table-maintenance">Table Maintenance</a></li>
      <li><a href="#roadmap" id="markdown-toc-roadmap">Roadmap</a></li>
      <li><a href="#related-resources" id="markdown-toc-related-resources">Related Resources</a></li>
    </ol>
  </li>
  <li><a href="#deprecated-iceberg-hadoopcatalog" id="markdown-toc-deprecated-iceberg-hadoopcatalog">Deprecated: Iceberg HadoopCatalog</a></li>
</ol>

</div>
<h2 id="lakefs-iceberg-rest-catalog">
  
  
    <a href="#lakefs-iceberg-rest-catalog" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> lakeFS Iceberg REST Catalog
  
  
</h2>
    

<p class="label label-purple">lakeFS Enterprise</p>

<blockquote class="note">
  <p>💡 lakeFS Iceberg REST Catalog is currently in private preview for <a href="/enterprise/">lakeFS Enterprise</a> customers.
<a href="https://lakefs.io/book-a-demo/">Contact us</a> to get started!</p>
</blockquote>
<h3 id="what-is-lakefs-iceberg-rest-catalog">
  
  
    <a href="#what-is-lakefs-iceberg-rest-catalog" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is lakeFS Iceberg REST Catalog?
  
  
</h3>
    

<p>lakeFS Iceberg REST Catalog allow you to use lakeFS as a <a href="https://github.com/apache/iceberg/blob/main/open-api/rest-catalog-open-api.yaml">spec-compliant</a> Apache <a href="https://editor-next.swagger.io/?url=https://raw.githubusercontent.com/apache/iceberg/main/open-api/rest-catalog-open-api.yaml">Iceberg REST catalog</a>, 
allowing Iceberg clients to manage and access tables using a standard REST API.</p>

<p>Using lakeFS Iceberg REST Catalog, you can use lakeFS a drop-in replacement for other Iceberg catalogs like AWS Glue, Nessie, Hive Metastore - or the lakeFS HadoopCatalog (see <a href="#deprecated-iceberg-hadoopcatalog">below</a>)</p>

<p>With lakeFS Iceberg REST Catalog, you can:</p>

<ul>
  <li>Manage Iceberg tables with full version control capabilities.</li>
  <li>Use standard Iceberg clients and tools without modification.</li>
  <li>Leverage lakeFS’s branching and merging features for managing table’s lifecycle.</li>
  <li>Maintain data consistency across different environments.</li>
</ul>
<h3 id="use-cases">
  
  
    <a href="#use-cases" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use Cases
  
  
</h3>
    

<ol>
  <li><strong>Version-Controlled Data Development</strong>:
    <ul>
      <li>Create feature branches for table schema changes or data migrations</li>
      <li>Test modifications in isolation, across multiple tables</li>
      <li>Merge changes safely with conflict detection</li>
    </ul>
  </li>
  <li><strong>Multi-Environment Management</strong>:
    <ul>
      <li>Use branches to represent different environments (dev, staging, prod)</li>
      <li>Promote changes between environments through merges, with automated testing</li>
      <li>Maintain consistent table schemas across environments</li>
    </ul>
  </li>
  <li><strong>Collaborative Data Development</strong>:
    <ul>
      <li>Multiple teams can work on different table features simultaneously</li>
      <li>Maintain data quality through pre-merge validations</li>
      <li>Collaborate using <a href="/v1.60/howto/pull-requests.html">pull requests</a> on changes to data and schema</li>
    </ul>
  </li>
  <li><strong>Manage and Govern Access to data</strong>:
    <ul>
      <li>Use the detailed built-in commit log capturing who, what and how data is changed</li>
      <li>Manage access using fine grained access control to users and groups using RBAC policies</li>
      <li>Rollback changes atomically and safely to reduce time-to-recover and increase system stability</li>
    </ul>
  </li>
</ol>
<h3 id="configuration">
  
  
    <a href="#configuration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuration
  
  
</h3>
    

<p>The Iceberg REST catalog API is exposed at <code class="language-plaintext highlighter-rouge">/iceberg/api</code> in your lakeFS server.</p>

<p>To use it:</p>

<ol>
  <li>Enable the feature (<a href="https://lakefs.io/book-a-demo/">contact us</a> for details).</li>
  <li>Configure your Iceberg clients to use the lakeFS REST catalog endpoint.</li>
  <li>Use your lakeFS access key and secret for authentication.</li>
</ol>
<h4 id="catalog-initialization-example-using-pyiceberg">
  
  
    <a href="#catalog-initialization-example-using-pyiceberg" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Catalog Initialization Example (using <a href="https://py.iceberg.apache.org/"><code class="language-plaintext highlighter-rouge">pyiceberg</code></a>)
  
  
</h4>
    

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pyiceberg.catalog.rest</span> <span class="kn">import</span> <span class="n">RestCatalog</span>

<span class="n">catalog</span> <span class="o">=</span> <span class="n">RestCatalog</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"my_catalog"</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span>
    <span class="s">'prefix'</span><span class="p">:</span> <span class="s">'lakefs'</span><span class="p">,</span>
    <span class="s">'uri'</span><span class="p">:</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">lakefs_endpoint</span><span class="si">}</span><span class="s">/iceberg/api'</span><span class="p">,</span>
    <span class="s">'oauth2-server-uri'</span><span class="p">:</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">lakefs_endpoint</span><span class="si">}</span><span class="s">/iceberg/api/v1/oauth/tokens'</span><span class="p">,</span>
    <span class="s">'credential'</span><span class="p">:</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">lakefs_client_key</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">lakefs_client_secret</span><span class="si">}</span><span class="s">'</span><span class="p">,</span>
<span class="p">})</span>
</code></pre></div></div>
<h4 id="example-client-code">
  
  
    <a href="#example-client-code" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example Client code
  
  
</h4>
    

<div class="tabs">
  <ul>
    <li><a href="#python">Python</a></li>
    <li><a href="#trino">Trino</a></li>
    <li><a href="#spark">Spark</a></li>
  </ul>

  <div id="PyIceberg">

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pyiceberg.catalog.rest</span> <span class="kn">import</span> <span class="n">RestCatalog</span>

<span class="c1"># Initialize the catalog
</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">RestCatalog</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"my_catalog"</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span>
    <span class="s">'prefix'</span><span class="p">:</span> <span class="s">'lakefs'</span><span class="p">,</span>
    <span class="s">'uri'</span><span class="p">:</span> <span class="s">'https://lakefs.example.com/iceberg/api'</span><span class="p">,</span>
    <span class="s">'oauth2-server-uri'</span><span class="p">:</span> <span class="s">'https://lakefs.example.com/iceberg/api/iceberg/api/v1/oauth/tokens'</span><span class="p">,</span>
    <span class="s">'credential'</span><span class="p">:</span> <span class="sa">f</span><span class="s">'AKIAlakefs12345EXAMPLE:abc/lakefs/1234567bPxRfiCYEXAMPLEKEY'</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># List namespaces in a branch
</span><span class="n">catalog</span><span class="p">.</span><span class="n">list_namespaces</span><span class="p">((</span><span class="s">'repo'</span><span class="p">,</span> <span class="s">'main'</span><span class="p">))</span>

<span class="c1"># Query a table
</span><span class="n">catalog</span><span class="p">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s">'repo.main.inventory'</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">.</span><span class="n">load_table</span><span class="p">(</span><span class="s">'repo.main.inventory.books'</span><span class="p">)</span>
<span class="n">arrow_df</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">scan</span><span class="p">().</span><span class="n">to_arrow</span><span class="p">()</span>
</code></pre></div>    </div>

  </div>

  <div id="trino">

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- List tables in the iceberg catalog</span>
<span class="n">USE</span> <span class="nv">"repo.main.inventory"</span><span class="p">;</span> <span class="c1">-- &lt;repository&gt;.&lt;branch or reference&gt;.&lt;namespace&gt;</span>
<span class="k">SHOW</span> <span class="n">TABLES</span><span class="p">;</span>

<span class="c1">-- Query a table</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">books</span> <span class="k">LIMIT</span> <span class="mi">100</span><span class="p">;</span>

<span class="c1">-- Switch to a different branch</span>
<span class="n">USE</span> <span class="nv">"repo.new_branch.inventory"</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">books</span><span class="p">;</span>
</code></pre></div>    </div>

  </div>

  <div id="spark">

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Configure Spark to use the lakeFS REST catalog</span>
<span class="nv">spark</span><span class="o">.</span><span class="py">sql</span><span class="o">(</span><span class="s">"USE my_repo.main.inventory"</span><span class="o">)</span>

<span class="c1">// List available tables</span>
<span class="nv">spark</span><span class="o">.</span><span class="py">sql</span><span class="o">(</span><span class="s">"SHOW TABLES"</span><span class="o">).</span><span class="py">show</span><span class="o">()</span>

<span class="c1">// Query data with branch isolation</span>
<span class="nv">spark</span><span class="o">.</span><span class="py">sql</span><span class="o">(</span><span class="s">"SELECT * FROM books"</span><span class="o">).</span><span class="py">show</span><span class="o">()</span>

<span class="c1">// Switch to a feature branch</span>
<span class="nv">spark</span><span class="o">.</span><span class="py">sql</span><span class="o">(</span><span class="s">"USE my_repo.new_branch.inventory"</span><span class="o">)</span>
<span class="nv">spark</span><span class="o">.</span><span class="py">sql</span><span class="o">(</span><span class="s">"SELECT * FROM books"</span><span class="o">).</span><span class="py">show</span><span class="o">()</span>
</code></pre></div>    </div>

  </div>
</div>
<h3 id="namespaces-and-tables">
  
  
    <a href="#namespaces-and-tables" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Namespaces and Tables
  
  
</h3>
    
<h4 id="namespace-operations">
  
  
    <a href="#namespace-operations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Namespace Operations
  
  
</h4>
    

<p>The Iceberg Catalog supports Iceberg namespace operations:</p>

<ul>
  <li>Create namespaces</li>
  <li>List namespaces</li>
  <li>Drop namespaces</li>
  <li>List tables within namespaces</li>
</ul>
<h4 id="namespace-usage">
  
  
    <a href="#namespace-usage" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Namespace Usage
  
  
</h4>
    

<p>Namespaces in the Iceberg Catalog follow the pattern <code class="language-plaintext highlighter-rouge">"&lt;repository&gt;.&lt;branch&gt;.&lt;namespace&gt;(.&lt;namespace&gt;...)"</code> where:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">&lt;repository&gt;</code> must be a valid lakeFS repository name.</li>
  <li><code class="language-plaintext highlighter-rouge">&lt;branch&gt;</code> must be a valid lakeFS branch name.</li>
  <li><code class="language-plaintext highlighter-rouge">&lt;namespace&gt;</code> components can be nested using unit separator (e.g., <code class="language-plaintext highlighter-rouge">inventory.books</code>).</li>
</ul>

<p>Examples:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">my-repo.main.inventory</code></li>
  <li><code class="language-plaintext highlighter-rouge">my-repo.feature-branch.inventory.books</code></li>
</ul>

<p>The repository and branch components must already exist in lakeFS before using them in the Iceberg catalog.</p>
<h4 id="namespace-restrictions">
  
  
    <a href="#namespace-restrictions" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Namespace Restrictions
  
  
</h4>
    

<ul>
  <li>Repository and branch names must follow lakeFS naming conventions.</li>
  <li>Namespace components cannot contain special characters except dots (.) for nesting.</li>
  <li>The total namespace path length must be less than 255 characters.</li>
  <li>Namespaces are case-sensitive.</li>
  <li>Empty namespace components are not allowed.</li>
</ul>
<h3 id="table-operations">
  
  
    <a href="#table-operations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table Operations
  
  
</h3>
    

<p>The Iceberg Catalog supports all standard Iceberg table operations:</p>

<ul>
  <li>Create tables with schemas and partitioning.</li>
  <li>Update table schemas and partitioning.</li>
  <li>Commit changes to tables.</li>
  <li>Delete tables.</li>
  <li>List tables in namespaces.</li>
</ul>
<h3 id="version-control-features">
  
  
    <a href="#version-control-features" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Version Control Features
  
  
</h3>
    

<p>The Iceberg Catalog integrates with lakeFS’s version control system, treating each table change as a commit. 
This provides a complete history of table modifications and enables branching and merging workflows.</p>
<h4 id="catalog-changes-as-commits">
  
  
    <a href="#catalog-changes-as-commits" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Catalog Changes as Commits
  
  
</h4>
    

<p>Each modification to a table (schema changes, data updates, etc.) creates a new commit in lakeFS. 
Creating or deleting a namespace or a table results in a lakeFS commit on the relevant branch, as well as table data updates (“Iceberg table commit”).</p>
<h4 id="branching-and-merging">
  
  
    <a href="#branching-and-merging" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Branching and Merging
  
  
</h4>
    

<p>Create a new branch to work on table changes:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a lakeFS branch using lakeFS Python SDK
</span><span class="n">branch</span> <span class="o">=</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">repository</span><span class="p">(</span><span class="s">'repo'</span><span class="p">).</span><span class="n">branch</span><span class="p">(</span><span class="s">'new_branch'</span><span class="p">).</span><span class="n">create</span><span class="p">(</span><span class="n">source_reference</span><span class="o">=</span><span class="s">'main'</span><span class="p">)</span>

<span class="c1"># The table is now accessible in the new branch
</span><span class="n">new_table</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">.</span><span class="n">load_table</span><span class="p">(</span><span class="sa">f</span><span class="s">'repo.</span><span class="si">{</span><span class="n">branch</span><span class="p">.</span><span class="nb">id</span><span class="si">}</span><span class="s">.inventory.books'</span><span class="p">)</span>
</code></pre></div></div>

<p>Merge changes between branches:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Merge the branch using lakeFS Python SDK
</span><span class="n">branch</span><span class="p">.</span><span class="n">merge_into</span><span class="p">(</span><span class="s">'main'</span><span class="p">)</span>

<span class="c1"># Changes are now visible in main
</span><span class="n">main_table</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">.</span><span class="n">load_table</span><span class="p">(</span><span class="s">'repo.main.inventory.books'</span><span class="p">)</span>
</code></pre></div></div>

<p class="note">Currently, lakeFS handles table changes as file operations during merges. 
This means that when merging branches with table changes, lakeFS treats the table metadata files as regular files. 
No special merge logic is applied to handle conflicting table changes, and if there are conflicting changes to the same table in different branches, 
the merge will fail with a conflict that needs to be resolved manually.</p>
<h3 id="authentication">
  
  
    <a href="#authentication" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Authentication
  
  
</h3>
    

<p>lakeFS provides an OAuth2 token endpoint at <code class="language-plaintext highlighter-rouge">/catalog/iceberg/v1/oauth/tokens</code> that clients need to configure. 
To authenticate, clients must provide their lakeFS access key and secret in the format <code class="language-plaintext highlighter-rouge">access_key:secret</code> as the credential.</p>

<p>The authorization requirements are managed at the lakeFS level, meaning:</p>

<ul>
  <li>Users need appropriate lakeFS permissions to access repositories and branches</li>
  <li>Table operations require lakeFS permissions on the underlying objects</li>
  <li>The same lakeFS RBAC policies apply to Iceberg catalog operations</li>
</ul>
<h3 id="limitations">
  
  
    <a href="#limitations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Limitations
  
  
</h3>
    

<ol>
  <li><strong>Table Maintenance</strong>:
    <ul>
      <li>See <a href="#table-maintenance">Table Maintenance</a> section for details</li>
    </ul>
  </li>
  <li><strong>Advanced Features</strong>:
    <ul>
      <li>Views (all view operations are unsupported)</li>
      <li>Transactional DML (<code class="language-plaintext highlighter-rouge">stage-create</code>)</li>
      <li>Server-side query planning</li>
      <li>Table renaming</li>
      <li>Updating table’s location (using Commit)</li>
      <li>Table statistics (<code class="language-plaintext highlighter-rouge">set-statistics</code> and <code class="language-plaintext highlighter-rouge">remove-statistics</code> operations are currently a no-op)</li>
    </ul>
  </li>
  <li>
    <p>lakeFS Iceberg REST Catalog is currently tested to work with Amazon S3 and Google Cloud Storage. Other storage backends, such as Azure or Local storage are currently not supported, but will be in future releases.</p>
  </li>
  <li>Currently only <a href="https://iceberg.apache.org/spec">Iceberg <code class="language-plaintext highlighter-rouge">v2</code> table format</a> is supported</li>
</ol>
<h3 id="table-maintenance">
  
  
    <a href="#table-maintenance" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table Maintenance
  
  
</h3>
    

<p>The following table maintenance operations are not supported in the current version:</p>

<ul>
  <li><a href="https://iceberg.apache.org/docs/latest/spark-ddl/#drop-table-purge">Drop table with purge</a></li>
  <li><a href="https://iceberg.apache.org/docs/latest/maintenance/#compact-data-files">Compact data files</a></li>
  <li><a href="https://iceberg.apache.org/docs/latest/maintenance/#rewrite-manifests">Rewrite manifests</a></li>
  <li><a href="https://iceberg.apache.org/docs/latest/maintenance/#expire-snapshots">Expire snapshots</a></li>
  <li><a href="https://iceberg.apache.org/docs/latest/maintenance/#remove-old-metadata-files">Remove old metadata files</a></li>
  <li><a href="https://iceberg.apache.org/docs/latest/maintenance/#delete-orphan-files">Delete orphan files</a></li>
</ul>

<blockquote class="note">
  <p><strong>⚠️ To prevent data loss, clients should disable their own cleanup operations by:</strong></p>
  <ul>
    <li>Disabling orphan file deletion.</li>
    <li>Setting <code class="language-plaintext highlighter-rouge">remove-dangling-deletes</code> to false when rewriting.</li>
    <li>Disabling snapshot expiration.</li>
    <li>Setting a very high value for <code class="language-plaintext highlighter-rouge">min-snapshots-to-keep</code> parameter.</li>
  </ul>
</blockquote>
<h3 id="roadmap">
  
  
    <a href="#roadmap" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Roadmap
  
  
</h3>
    

<p>The following features are planned for future releases:</p>

<ol>
  <li><strong>Catalog Sync</strong>:
    <ul>
      <li>Support for pushing/pulling tables to/from other catalogs</li>
      <li>Integration with AWS Glue and other Iceberg-compatible catalogs</li>
    </ul>
  </li>
  <li><strong>Table Import</strong>:
    <ul>
      <li>Support for importing existing Iceberg tables from other catalogs</li>
      <li>Bulk import capabilities for large-scale migrations</li>
    </ul>
  </li>
  <li><strong>Advanced Features</strong>:
    <ul>
      <li>Views API support</li>
      <li>Table transactions</li>
    </ul>
  </li>
  <li><strong>Azure Storage Support</strong></li>
</ol>
<h3 id="related-resources">
  
  
    <a href="#related-resources" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Related Resources
  
  
</h3>
    

<ul>
  <li><a href="https://editor-next.swagger.io/?url=https://raw.githubusercontent.com/apache/iceberg/main/open-api/rest-catalog-open-api.yaml">Iceberg REST Catalog API Specification</a></li>
  <li><a href="https://iceberg.apache.org/docs/latest/">Iceberg Official Documentation</a></li>
  <li><a href="/enterprise/">lakeFS Enterprise Features</a></li>
</ul>
<h2 id="deprecated-iceberg-hadoopcatalog">
  
  
    <a href="#deprecated-iceberg-hadoopcatalog" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deprecated: Iceberg HadoopCatalog
  
  
</h2>
    

<blockquote class="note">
  <p>✋ <strong>HadoopCatalog and other filesystem-based catalogs are currently not recommended by the Apache Iceberg community and come with several limitations around concurrency and tooling.</strong>
<strong>As such, the <code class="language-plaintext highlighter-rouge">HadoopCatalog</code> described in this section is now deprecated and will not receive further updates</strong></p>
</blockquote>
<h3 class="no_toc" id="setup">
  
  
    <a href="#setup" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setup
  
  
</h3>
    

<div class="tabs">
  <ul>
    <li><a href="#maven">Maven</a></li>
    <li><a href="#pyspark">PySpark</a></li>
  </ul>
  <div id="maven">

    <p>Use the following Maven dependency to install the lakeFS custom catalog:</p>

    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>io.lakefs<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>lakefs-iceberg<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.1.4<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>    </div>

  </div>
  <div id="pyspark">
    <p>Include the <code class="language-plaintext highlighter-rouge">lakefs-iceberg</code> jar in your package list along with Iceberg. For example:</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.jars.packages"</span><span class="p">,</span> <span class="s">"org.apache.iceberg:iceberg-spark-runtime-3.3_2.12:1.3.0,io.lakefs:lakefs-iceberg:0.1.4"</span><span class="p">)</span>
</code></pre></div>    </div>
  </div>
</div>
<h3 class="no_toc" id="configuration-1">
  
  
    <a href="#configuration-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuration
  
  
</h3>
    

<div class="tabs">
  <ul>
    <li><a href="#conf-pyspark">PySpark</a></li>
    <li><a href="#conf-sparkshell">Spark Shell</a></li>
  </ul>
  <div id="conf-pyspark">

    <p>Set up the Spark SQL catalog:</p>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.sql.catalog.lakefs"</span><span class="p">,</span> <span class="s">"org.apache.iceberg.spark.SparkCatalog"</span><span class="p">)</span> \
<span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.sql.catalog.lakefs.catalog-impl"</span><span class="p">,</span> <span class="s">"io.lakefs.iceberg.LakeFSCatalog"</span><span class="p">)</span> \
<span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.sql.catalog.lakefs.warehouse"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"lakefs://</span><span class="si">{</span><span class="n">repo_name</span><span class="si">}</span><span class="s">"</span><span class="p">)</span> \ 
<span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.sql.catalog.lakefs.cache-enabled"</span><span class="p">,</span> <span class="s">"false"</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>Configure the S3A Hadoop FileSystem with your lakeFS connection details.
Note that these are your lakeFS endpoint and credentials, not your S3 ones.</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.hadoop.fs.s3.impl"</span><span class="p">,</span> <span class="s">"org.apache.hadoop.fs.s3a.S3AFileSystem"</span><span class="p">)</span> \
<span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.hadoop.fs.s3a.endpoint"</span><span class="p">,</span> <span class="s">"https://example-org.us-east-1.lakefscloud.io"</span><span class="p">)</span> \
<span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.hadoop.fs.s3a.access.key"</span><span class="p">,</span> <span class="s">"AKIAIO5FODNN7EXAMPLE"</span><span class="p">)</span> \
<span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.hadoop.fs.s3a.secret.key"</span><span class="p">,</span> <span class="s">"wJalrXUtnFEMI/K3MDENG/bPxRfiCYEXAMPLEKEY"</span><span class="p">)</span> \
<span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">"spark.hadoop.fs.s3a.path.style.access"</span><span class="p">,</span> <span class="s">"true"</span><span class="p">)</span>
</code></pre></div>    </div>

  </div>

  <div id="conf-sparkshell">
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spark-shell <span class="nt">--conf</span> spark.sql.catalog.lakefs<span class="o">=</span><span class="s2">"org.apache.iceberg.spark.SparkCatalog"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.sql.catalog.lakefs.catalog-impl<span class="o">=</span><span class="s2">"io.lakefs.iceberg.LakeFSCatalog"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.sql.catalog.lakefs.warehouse<span class="o">=</span><span class="s2">"lakefs://example-repo"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.sql.catalog.lakefs.cache-enabled<span class="o">=</span><span class="s2">"false"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.hadoop.fs.s3.impl<span class="o">=</span><span class="s2">"org.apache.hadoop.fs.s3a.S3AFileSystem"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.hadoop.fs.s3a.endpoint<span class="o">=</span><span class="s2">"https://example-org.us-east-1.lakefscloud.io"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.hadoop.fs.s3a.access.key<span class="o">=</span><span class="s2">"AKIAIO5FODNN7EXAMPLE"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.hadoop.fs.s3a.secret.key<span class="o">=</span><span class="s2">"wJalrXUtnFEMI/K3MDENG/bPxRfiCYEXAMPLEKEY"</span> <span class="se">\</span>
   <span class="nt">--conf</span> spark.hadoop.fs.s3a.path.style.access<span class="o">=</span><span class="s2">"true"</span>
</code></pre></div>    </div>
  </div>
</div>
<h3 class="no_toc" id="using-iceberg-tables-with-hadoopcatalog">
  
  
    <a href="#using-iceberg-tables-with-hadoopcatalog" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using Iceberg tables with HadoopCatalog
  
  
</h3>
    
<h4 class="no_toc" id="create-a-table">
  
  
    <a href="#create-a-table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create a table
  
  
</h4>
    

<p>To create a table on your main branch, use the following syntax:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">db1</span><span class="p">.</span><span class="n">table1</span> <span class="p">(</span><span class="n">id</span> <span class="nb">int</span><span class="p">,</span> <span class="k">data</span> <span class="n">string</span><span class="p">);</span>
</code></pre></div></div>
<h4 class="no_toc" id="insert-data-into-the-table">
  
  
    <a href="#insert-data-into-the-table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Insert data into the table
  
  
</h4>
    

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">db1</span><span class="p">.</span><span class="n">table1</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'data1'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">db1</span><span class="p">.</span><span class="n">table1</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'data2'</span><span class="p">);</span>
</code></pre></div></div>
<h4 class="no_toc" id="create-a-branch">
  
  
    <a href="#create-a-branch" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create a branch
  
  
</h4>
    

<p>We can now commit the creation of the table to the main branch:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakectl commit lakefs://example-repo/main <span class="nt">-m</span> <span class="s2">"my first iceberg commit"</span>
</code></pre></div></div>

<p>Then, create a branch:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakectl branch create lakefs://example-repo/dev <span class="nt">-s</span> lakefs://example-repo/main
</code></pre></div></div>
<h4 class="no_toc" id="make-changes-on-the-branch">
  
  
    <a href="#make-changes-on-the-branch" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Make changes on the branch
  
  
</h4>
    

<p>We can now make changes on the branch:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">dev</span><span class="p">.</span><span class="n">db1</span><span class="p">.</span><span class="n">table1</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">'data3'</span><span class="p">);</span>
</code></pre></div></div>
<h4 class="no_toc" id="query-the-table">
  
  
    <a href="#query-the-table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Query the table
  
  
</h4>
    

<p>If we query the table on the branch, we will see the data we inserted:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">dev</span><span class="p">.</span><span class="n">db1</span><span class="p">.</span><span class="n">table1</span><span class="p">;</span>
</code></pre></div></div>

<p>Results in:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+------+
| id | data |
+----+------+
| 1  | data1|
| 2  | data2|
| 3  | data3|
+----+------+
</code></pre></div></div>

<p>However, if we query the table on the main branch, we will not see the new changes:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">lakefs</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">db1</span><span class="p">.</span><span class="n">table1</span><span class="p">;</span>
</code></pre></div></div>

<p>Results in:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+------+
| id | data |
+----+------+
| 1  | data1|
| 2  | data2|
+----+------+
</code></pre></div></div>
<h3 class="no_toc" id="migrating-an-existing-iceberg-table-to-the-hadoop-catalog">
  
  
    <a href="#migrating-an-existing-iceberg-table-to-the-hadoop-catalog" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Migrating an existing Iceberg table to the Hadoop Catalog
  
  
</h3>
    

<p>This is done through an incremental copy from the original table into lakeFS.</p>

<ol>
  <li>Create a new lakeFS repository <code class="language-plaintext highlighter-rouge">lakectl repo create lakefs://example-repo &lt;base storage path&gt;</code></li>
  <li>
    <p>Initiate a spark session that can interact with the source iceberg table and the target lakeFS catalog.</p>

    <p>Here’s an example of Hadoop and S3 session and lakeFS catalog with <a href="https://docs.cloudera.com/HDPDocuments/HDP3/HDP-3.1.4/bk_cloud-data-access/content/s3-per-bucket-configs.html">per-bucket config</a>:</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">SparkConf</span> <span class="n">conf</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SparkConf</span><span class="o">();</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.hadoop.fs.s3a.path.style.access"</span><span class="o">,</span> <span class="s">"true"</span><span class="o">);</span>

 <span class="c1">// set hadoop on S3 config (source tables we want to copy) for spark</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.catalog.hadoop_prod"</span><span class="o">,</span> <span class="s">"org.apache.iceberg.spark.SparkCatalog"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.catalog.hadoop_prod.type"</span><span class="o">,</span> <span class="s">"hadoop"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.catalog.hadoop_prod.warehouse"</span><span class="o">,</span> <span class="s">"s3a://my-bucket/warehouse/hadoop/"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.extensions"</span><span class="o">,</span> <span class="s">"org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.hadoop.fs.s3a.bucket.my-bucket.access.key"</span><span class="o">,</span> <span class="s">"&lt;AWS_ACCESS_KEY&gt;"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.hadoop.fs.s3a.bucket.my-bucket.secret.key"</span><span class="o">,</span> <span class="s">"&lt;AWS_SECRET_KEY&gt;"</span><span class="o">);</span>

 <span class="c1">// set lakeFS config (target catalog and repository)</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.catalog.lakefs"</span><span class="o">,</span> <span class="s">"org.apache.iceberg.spark.SparkCatalog"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.catalog.lakefs.catalog-impl"</span><span class="o">,</span> <span class="s">"io.lakefs.iceberg.LakeFSCatalog"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.catalog.lakefs.warehouse"</span><span class="o">,</span> <span class="s">"lakefs://example-repo"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.sql.extensions"</span><span class="o">,</span> <span class="s">"org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.hadoop.fs.s3a.bucket.example-repo.access.key"</span><span class="o">,</span> <span class="s">"&lt;LAKEFS_ACCESS_KEY&gt;"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.hadoop.fs.s3a.bucket.example-repo.secret.key"</span><span class="o">,</span> <span class="s">"&lt;LAKEFS_SECRET_KEY&gt;"</span><span class="o">);</span>
 <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"spark.hadoop.fs.s3a.bucket.example-repo.endpoint"</span>  <span class="o">,</span> <span class="s">"&lt;LAKEFS_ENDPOINT&gt;"</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create Schema in lakeFS and copy the data</p>

    <p>Example of copy with spark-sql:</p>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">-- Create Iceberg Schema in lakeFS</span>
 <span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">&lt;</span><span class="n">lakefs</span><span class="o">-</span><span class="k">catalog</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="n">branch</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span>
 <span class="c1">-- Create new iceberg table in lakeFS from the source table (pre-lakeFS)</span>
 <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">&lt;</span><span class="n">lakefs</span><span class="o">-</span><span class="k">catalog</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="n">branch</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span> <span class="k">USING</span> <span class="n">iceberg</span> <span class="k">AS</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">iceberg</span><span class="o">-</span><span class="n">original</span><span class="o">-</span><span class="k">table</span><span class="o">&gt;</span>
</code></pre></div>    </div>
  </li>
</ol>

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button" >
                            <img src="/v1.60/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/v1.60/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/v1.60/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/v1.60/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/v1.60/assets/icons/github.svg" class="no-hover" />
                            <img src="/v1.60/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/v1.60/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/v1.60/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/v1.60/assets/icons/slack.svg" class="no-hover" />
                            <img src="/v1.60/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>


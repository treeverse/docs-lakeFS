

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">
  
  <style type="text/css">
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(4) > .nav-list > .nav-list-item:nth-child(16) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #ebedf5 0%, rgba(235, 237, 245, 0.8) 80%, rgba(235, 237, 245, 0) 100%); }

.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list-expander svg, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list > .nav-list-item:not(.passive):nth-child(16) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(4) > .nav-list > .nav-list-item:not(.passive):nth-child(16) > .nav-list { display: block; }

.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list { display: block; }

</style>


  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Glue Data Catalog | lakeFS Documentation</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Glue Data Catalog" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Query data from lakeFS branches in AWS Athena or other services backed by Glue Data Catalog." />
<meta property="og:description" content="Query data from lakeFS branches in AWS Athena or other services backed by Glue Data Catalog." />
<meta property="og:site_name" content="lakeFS Documentation" />
<meta property="og:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://docs.lakefs.io/assets/img/docs_logo.png" />
<meta property="twitter:title" content="Glue Data Catalog" />
<meta name="twitter:site" content="@lakeFS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Query data from lakeFS branches in AWS Athena or other services backed by Glue Data Catalog.","headline":"Glue Data Catalog","image":"https://docs.lakefs.io/assets/img/docs_logo.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/logo.svg"}},"url":"/integrations/glue_metastore.html"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<!-- type="text/plain" is intentional for cookie consent support -->
<script type="text/plain" data-category="analytics">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->

<meta property="og:image" content="/assets/img/lakefs-logo-with-text.png">
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<link rel="stylesheet" href="/assets/css/cookieconsent.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script type="module" src="/assets/js/cookieconsent-init.js"></script>
<script src="/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/assets/js/feedback.js"></script>
<link href="https://data-folks.masto.host/@lakeFS" rel="me">

</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<img src="/assets/img/cookies.png" style="display: none;">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://lakefs.io" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="lakeFS Documentation"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search lakeFS Documentation" aria-label="Search lakeFS Documentation"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/"
           class="nav-list-link">Welcome to lakeFS</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/quickstart/"
           class="nav-list-link">⭐ Quickstart</a><ul class="nav-list "><li class="nav-list-item "><a href="/quickstart/launch.html"
                   class="nav-list-link">1️⃣ Run lakeFS</a></li><li class="nav-list-item "><a href="/quickstart/query.html"
                   class="nav-list-link">2️⃣ Query the data</a></li><li class="nav-list-item "><a href="/quickstart/branch.html"
                   class="nav-list-link">3️⃣ Create a branch</a></li><li class="nav-list-item "><a href="/quickstart/commit-and-merge.html"
                   class="nav-list-link">4️⃣ Commit and Merge</a></li><li class="nav-list-item "><a href="/quickstart/rollback.html"
                   class="nav-list-link">5️⃣ Roll back Changes</a></li><li class="nav-list-item "><a href="/quickstart/actions-and-hooks.html"
                   class="nav-list-link">6️⃣ Using Actions and Hooks in lakeFS</a></li><li class="nav-list-item "><a href="/quickstart/work-with-data-locally.html"
                   class="nav-list-link">7️⃣ Work with lakeFS data locally</a></li><li class="nav-list-item "><a href="/quickstart/learning-more-lakefs.html"
                   class="nav-list-link">Learn more about lakeFS</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/howto/"
           class="nav-list-link">How-To</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/howto/deploy/"
                   class="nav-list-link">Install lakeFS</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/howto/deploy/aws.html"
                           class="nav-list-link">AWS</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/deploy/azure.html"
                           class="nav-list-link">Azure</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/deploy/gcp.html"
                           class="nav-list-link">GCP</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/deploy/onprem.html"
                           class="nav-list-link">On-Premises</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/deploy/upgrade.html"
                           class="nav-list-link">Upgrade lakeFS</a>
                    </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/howto/hooks/"
                   class="nav-list-link">Actions and Hooks</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/howto/hooks/airflow.html"
                           class="nav-list-link">Airflow Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/hooks/lua.html"
                           class="nav-list-link">Lua Hooks</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/hooks/webhooks.html"
                           class="nav-list-link">Webhooks</a>
                    </li></ul></li><li class="nav-list-item "><a href="/howto/protect-branches.html"
                   class="nav-list-link">Branch Protection</a></li><li class="nav-list-item "><a href="/howto/copying.html"
                   class="nav-list-link">Copying data to/from lakeFS</a></li><li class="nav-list-item "><a href="/howto/catalog_exports.html"
                   class="nav-list-link">Data Catalogs Export</a></li><li class="nav-list-item "><a href="/howto/export.html"
                   class="nav-list-link">Export Data</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/howto/garbage-collection/"
                   class="nav-list-link">Garbage Collection</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/howto/garbage-collection/gc.html"
                           class="nav-list-link">Garbage Collection</a>
                    </li><li class="nav-list-item ">
                        <a href="/howto/garbage-collection/managed-gc.html"
                           class="nav-list-link">Managed Garbage Collection</a>
                    </li></ul></li><li class="nav-list-item "><a href="/howto/import.html"
                   class="nav-list-link">Import Data</a></li><li class="nav-list-item "><a href="/howto/migrate-away.html"
                   class="nav-list-link">Migrating away from lakeFS</a></li><li class="nav-list-item "><a href="/howto/mirroring.html"
                   class="nav-list-link">Mirroring</a></li><li class="nav-list-item "><a href="/howto/private-link.html"
                   class="nav-list-link">Private Link</a></li><li class="nav-list-item "><a href="/howto/virtual-host-addressing.html"
                   class="nav-list-link">S3 Virtual-host addressing (advanced)</a></li><li class="nav-list-item "><a href="/howto/sizing-guide.html"
                   class="nav-list-link">Sizing Guide</a></li><li class="nav-list-item "><a href="/howto/scim.html"
                   class="nav-list-link">System for Cross-domain Identity Management (SCIM)</a></li><li class="nav-list-item "><a href="/howto/local-checkouts.html"
                   class="nav-list-link">Work with lakeFS data locally</a></li></ul></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/integrations/"
           class="nav-list-link">Integrations</a><ul class="nav-list "><li class="nav-list-item "><a href="/integrations/aws_cli.html"
                   class="nav-list-link">AWS CLI</a></li><li class="nav-list-item "><a href="/integrations/airbyte.html"
                   class="nav-list-link">Airbyte</a></li><li class="nav-list-item "><a href="/integrations/athena.html"
                   class="nav-list-link">Amazon Athena</a></li><li class="nav-list-item "><a href="/integrations/sagemaker.html"
                   class="nav-list-link">Amazon SageMaker</a></li><li class="nav-list-item "><a href="/integrations/airflow.html"
                   class="nav-list-link">Apache Airflow</a></li><li class="nav-list-item "><a href="/integrations/hive.html"
                   class="nav-list-link">Apache Hive</a></li><li class="nav-list-item "><a href="/integrations/iceberg.html"
                   class="nav-list-link">Apache Iceberg</a></li><li class="nav-list-item "><a href="/integrations/kafka.html"
                   class="nav-list-link">Apache Kafka</a></li><li class="nav-list-item "><a href="/integrations/spark.html"
                   class="nav-list-link">Apache Spark</a></li><li class="nav-list-item "><a href="/integrations/cloudera.html"
                   class="nav-list-link">Cloudera</a></li><li class="nav-list-item "><a href="/integrations/delta.html"
                   class="nav-list-link">Delta Lake</a></li><li class="nav-list-item "><a href="/integrations/dremio.html"
                   class="nav-list-link">Dremio</a></li><li class="nav-list-item "><a href="/integrations/duckdb.html"
                   class="nav-list-link">DuckDB</a></li><li class="nav-list-item "><a href="/integrations/git.html"
                   class="nav-list-link">Git</a></li><li class="nav-list-item "><a href="/integrations/glue_hive_metastore.html"
                   class="nav-list-link">Glue / Hive metastore</a></li><li class="nav-list-item  active"><a href="/integrations/glue_metastore.html"
                   class="nav-list-link active">Glue Data Catalog</a></li><li class="nav-list-item "><a href="/integrations/huggingface_datasets.html"
                   class="nav-list-link">HuggingFace Datasets</a></li><li class="nav-list-item "><a href="/integrations/kubeflow.html"
                   class="nav-list-link">Kubeflow</a></li><li class="nav-list-item "><a href="/integrations/presto_trino.html"
                   class="nav-list-link">Presto / Trino</a></li><li class="nav-list-item "><a href="/integrations/python.html"
                   class="nav-list-link">Python</a></li><li class="nav-list-item "><a href="/integrations/r.html"
                   class="nav-list-link">R</a></li><li class="nav-list-item "><a href="/integrations/unity-catalog.html"
                   class="nav-list-link">Unity Catalog</a></li><li class="nav-list-item "><a href="/integrations/vertex_ai.html"
                   class="nav-list-link">Vertex AI</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/understand/"
           class="nav-list-link">Understanding lakeFS</a><ul class="nav-list "><li class="nav-list-item "><a href="/understand/architecture.html"
                   class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/understand/model.html"
                   class="nav-list-link">Concepts and  Model</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/data_lifecycle_management/"
                   class="nav-list-link">Data Lifecycle Management</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/ci.html"
                           class="nav-list-link">During Deployment</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/production.html"
                           class="nav-list-link">In Production</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/data_lifecycle_management/data-devenv.html"
                           class="nav-list-link">In Test</a>
                    </li></ul></li><li class="nav-list-item "><a href="/understand/data-structure.html"
                   class="nav-list-link">Data Structure</a></li><li class="nav-list-item "><a href="/understand/faq.html"
                   class="nav-list-link">FAQ</a></li><li class="nav-list-item "><a href="/understand/glossary.html"
                   class="nav-list-link">Glossary</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/how/"
                   class="nav-list-link">How lakeFS Works</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/how/kv.html"
                           class="nav-list-link">Internal database structure</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/merge.html"
                           class="nav-list-link">Merge</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/how/versioning-internals.html"
                           class="nav-list-link">Versioning Internals</a>
                    </li></ul></li><li class="nav-list-item "><a href="/understand/performance-best-practices.html"
                   class="nav-list-link">Performance Best Practices</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/understand/use_cases/"
                   class="nav-list-link">Use Cases</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/understand/use_cases/cicd_for_data.html"
                           class="nav-list-link">CI/CD for Data Lakes</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/use_cases/etl_testing.html"
                           class="nav-list-link">ETL Testing Environment</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/use_cases/reproducibility.html"
                           class="nav-list-link">Reproducibility</a>
                    </li><li class="nav-list-item ">
                        <a href="/understand/use_cases/rollback.html"
                           class="nav-list-link">Rollback</a>
                    </li></ul></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/reference/"
           class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/reference/auditing.html"
                   class="nav-list-link">Auditing</a></li><li class="nav-list-item "><a href="/reference/monitor.html"
                   class="nav-list-link">Monitoring using Prometheus</a></li><li class="nav-list-item "><a href="/reference/s3.html"
                   class="nav-list-link">S3 Gateway API</a></li><li class="nav-list-item "><a href="/reference/spark-client.html"
                   class="nav-list-link">Spark Client</a></li><li class="nav-list-item "><a href="/reference/api.html"
                   class="nav-list-link">lakeFS API</a></li><li class="nav-list-item "><a href="/reference/configuration.html"
                   class="nav-list-link">lakeFS Server Configuration</a></li><li class="nav-list-item "><a href="/reference/cli.html"
                   class="nav-list-link">lakectl (lakeFS command-line tool)</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/project/"
           class="nav-list-link">The lakeFS Project</a><ul class="nav-list "><li class="nav-list-item "><a href="/project/contributing.html"
                   class="nav-list-link">Contributing to lakeFS</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/project/docs/"
                   class="nav-list-link">Documentation</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/project/docs/callouts.html"
                           class="nav-list-link">Callouts</a>
                    </li></ul></li><li class="nav-list-item "><a href="/project/code-migrate-1.0-sdk.html"
                   class="nav-list-link">Migrating to 1.0</a></li></ul></li><li
            class="nav-list-item"><a href="/cloud/"
           class="nav-list-link">lakeFS Cloud</a></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/enterprise/"
           class="nav-list-link">lakeFS Enterprise</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/enterprise/getstarted/"
                   class="nav-list-link">Get Started</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/enterprise/getstarted/quickstart.html"
                           class="nav-list-link">Quickstart</a>
                    </li><li class="nav-list-item ">
                        <a href="/enterprise/getstarted/install.html"
                           class="nav-list-link">Install</a>
                    </li><li class="nav-list-item ">
                        <a href="/enterprise/getstarted/migrate-from-oss.html"
                           class="nav-list-link">Migrate from lakeFS OSS</a>
                    </li></ul></li><li class="nav-list-item "><a href="/enterprise/upgrade.html"
                   class="nav-list-link">Upgrade</a></li><li class="nav-list-item "><a href="/enterprise/troubleshooting.html"
                   class="nav-list-link">Troubleshooting lakeFS Enterprise</a></li><li class="nav-list-item "><a href="/enterprise/configuration.html"
                   class="nav-list-link">Configuration Reference</a></li><li class="nav-list-item "><a href="/enterprise/architecture.html"
                   class="nav-list-link">Architecture</a></li></ul></li><li
            class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/security/"
           class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="/security/access-control-lists.html"
                   class="nav-list-link">Access Control Lists (ACLs) -Deprecated-</a></li><li class="nav-list-item "><a href="/security/authentication.html"
                   class="nav-list-link">Authentication</a></li><li class="nav-list-item "><a href="/security/external-principals-aws.html"
                   class="nav-list-link">Login to lakeFS with AWS IAM Roles</a></li><li class="nav-list-item "><a href="/security/presigned-url.html"
                   class="nav-list-link">Presigned URLs</a></li><li class="nav-list-item "><a href="/security/remote-authenticator.html"
                   class="nav-list-link">Remote Authenticator</a></li><li class="nav-list-item "><a href="/security/rbac.html"
                   class="nav-list-link">Role-Based Access Control (RBAC)</a></li><li class="nav-list-item "><a href="/security/sts-login.html"
                   class="nav-list-link">Short-lived token (STS like) Authentication for lakeFS</a></li><li class="nav-list-item "><a href="/security/sso.html"
                   class="nav-list-link">Single Sign On (SSO)</a></li></ul></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                GitHub
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/integrations/">Integrations</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Glue Data Catalog</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 id="using-lakefs-with-the-glue-catalog">
  
  
    <a href="#using-lakefs-with-the-glue-catalog" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using lakeFS with the Glue Catalog
  
  
</h1>
    

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#example-using-athena-to-query-lakefs-data" id="markdown-toc-example-using-athena-to-query-lakefs-data">Example: Using Athena to query lakeFS data</a>    <ol>
      <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
      <li><a href="#add-table-descriptor" id="markdown-toc-add-table-descriptor">Add table descriptor</a></li>
      <li><a href="#write-some-table-data" id="markdown-toc-write-some-table-data">Write some table data</a></li>
      <li><a href="#the-exporter-script" id="markdown-toc-the-exporter-script">The exporter script</a></li>
      <li><a href="#configure-action-hooks" id="markdown-toc-configure-action-hooks">Configure Action Hooks</a></li>
      <li><a href="#use-athena" id="markdown-toc-use-athena">Use Athena</a></li>
      <li><a href="#cleanup" id="markdown-toc-cleanup">Cleanup</a></li>
    </ol>
  </li>
</ol>

</div>
<h2 id="overview">
  
  
    <a href="#overview" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview
  
  
</h2>
    

<p>The integration between Glue and lakeFS is based on <a href="/howto/catalog_exports.html">Data Catalog Exports</a>.</p>

<p>This guide describes how to use lakeFS with the Glue Data Catalog.
You’ll be able to query your lakeFS data by specifying the repository, branch and commit in your SQL query.
Currently, only read operations are supported on the tables.
You will set up the automation required to work with lakeFS on top of the Glue Data Catalog, including:</p>
<ol>
  <li>Create a table descriptor under <code class="language-plaintext highlighter-rouge">_lakefs_tables/&lt;your-table&gt;.yaml</code>. This will represent your table schema.</li>
  <li>Write an exporter script that will:
    <ul>
      <li>Mirror your branch’s state into <a href="https://svn.apache.org/repos/infra/websites/production/hive/content/javadocs/r2.1.1/api/org/apache/hadoop/hive/ql/io/SymlinkTextInputFormat.html">Hive Symlink</a> files readable by Athena.</li>
      <li>Export the table descriptors from your branch to the Glue Catalog.</li>
    </ul>
  </li>
  <li>Set up lakeFS <a href="/howto/catalog_exports.html#running-an-exporter">hooks</a> to trigger the above script when specific events occur.</li>
</ol>
<h2 id="example-using-athena-to-query-lakefs-data">
  
  
    <a href="#example-using-athena-to-query-lakefs-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example: Using Athena to query lakeFS data
  
  
</h2>
    
<h3 id="prerequisites">
  
  
    <a href="#prerequisites" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites
  
  
</h3>
    

<p>Before starting, make sure you have:</p>
<ol>
  <li>An active lakeFS installation with S3 as the backing storage, and a repository in this installation.</li>
  <li>A database in Glue Data Catalog (lakeFS does not create one).</li>
  <li>AWS Credentials with permission to manage Glue, Athena Query and S3 access.</li>
</ol>
<h3 id="add-table-descriptor">
  
  
    <a href="#add-table-descriptor" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Add table descriptor
  
  
</h3>
    

<p>Let’s define a table, and commit it to lakeFS. 
Save the YAML below as <code class="language-plaintext highlighter-rouge">animals.yaml</code> and upload it to lakeFS.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakectl fs upload lakefs://catalogs/main/_lakefs_tables/animals.yaml <span class="nt">-s</span> ./animals.yaml <span class="o">&amp;&amp;</span> <span class="se">\</span>
lakectl commit lakefs://catalogs/main <span class="nt">-m</span> <span class="s2">"added table"</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">animals</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">hive</span>
<span class="c1"># data location root in lakeFS</span>
<span class="na">path</span><span class="pi">:</span> <span class="s">tables/animals</span>
<span class="c1"># partitions order</span>
<span class="na">partition_columns</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">type'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">weight'</span><span class="pi">]</span>
<span class="na">schema</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">struct</span>
  <span class="c1"># all the columns spec</span>
  <span class="na">fields</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">type</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="na">nullable</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">metadata</span><span class="pi">:</span>
        <span class="na">comment</span><span class="pi">:</span> <span class="s">axolotl, cat, dog, fish etc</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">weight</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">integer</span>
      <span class="na">nullable</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">metadata</span><span class="pi">:</span> <span class="pi">{}</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">name</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="na">nullable</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">metadata</span><span class="pi">:</span> <span class="pi">{}</span>
</code></pre></div></div>
<h3 id="write-some-table-data">
  
  
    <a href="#write-some-table-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Write some table data
  
  
</h3>
    

<p>Insert data into the table path, using your preferred method (e.g. <a href="/integrations/spark.html">Spark</a>), and commit upon completion.
This example uses CSV files, and the files added to lakeFS should look like this:</p>

<p><img src="/assets/img/csv_export_hooks_data.png" alt="lakeFS Uploaded CSV Files" /></p>
<h3 id="the-exporter-script">
  
  
    <a href="#the-exporter-script" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The exporter script
  
  
</h3>
    

<p>Upload the following script to your main branch under <code class="language-plaintext highlighter-rouge">scripts/animals_exporter.lua</code> (or a path of your choice).</p>

<blockquote class="note">
  <p>For code references check <a href="/howto/hooks/lua.html#lakefscatalogexportsymlink_exporter">symlink_exporter</a> and <a href="/howto/hooks/lua.html#lakefscatalogexportglue_exporter">glue_exporter</a> docs.</p>
</blockquote>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">aws</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"aws"</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">symlink_exporter</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"lakefs/catalogexport/symlink_exporter"</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">glue_exporter</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"lakefs/catalogexport/glue_exporter"</span><span class="p">)</span>
<span class="c1">-- settings </span>
<span class="kd">local</span> <span class="n">access_key</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">aws</span><span class="p">.</span><span class="n">aws_access_key_id</span>
<span class="kd">local</span> <span class="n">secret_key</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">aws</span><span class="p">.</span><span class="n">aws_secret_access_key</span>
<span class="kd">local</span> <span class="n">region</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">aws</span><span class="p">.</span><span class="n">aws_region</span>
<span class="kd">local</span> <span class="n">table_path</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">table_source</span> <span class="c1">-- table descriptor </span>
<span class="kd">local</span> <span class="n">db</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">catalog</span><span class="p">.</span><span class="n">db_name</span> <span class="c1">-- glue db</span>
<span class="kd">local</span> <span class="n">table_input</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">catalog</span><span class="p">.</span><span class="n">table_input</span> <span class="c1">-- table input (AWS input spec) for Glue</span>
<span class="c1">-- export symlinks </span>
<span class="kd">local</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">aws</span><span class="p">.</span><span class="n">s3_client</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">result</span> <span class="o">=</span> <span class="n">symlink_exporter</span><span class="p">.</span><span class="n">export_s3</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">table_path</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="p">{</span><span class="n">debug</span><span class="o">=</span><span class="kc">true</span><span class="p">})</span>
<span class="c1">-- register glue table</span>
<span class="kd">local</span> <span class="n">glue</span> <span class="o">=</span> <span class="n">aws</span><span class="p">.</span><span class="n">glue_client</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">res</span> <span class="o">=</span> <span class="n">glue_exporter</span><span class="p">.</span><span class="n">export_glue</span><span class="p">(</span><span class="n">glue</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">table_path</span><span class="p">,</span> <span class="n">table_input</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="p">{</span><span class="n">debug</span><span class="o">=</span><span class="kc">true</span><span class="p">})</span>
</code></pre></div></div>
<h3 id="configure-action-hooks">
  
  
    <a href="#configure-action-hooks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configure Action Hooks
  
  
</h3>
    

<p>Hooks serve as the mechanism that triggers the execution of the exporter.
For more detailed information on how to configure exporter hooks, you can refer to <a href="/howto/catalog_exports.html#running-an-exporter">Running an Exporter</a>.</p>

<blockquote class="note">
  <p>The <code class="language-plaintext highlighter-rouge">args.catalog.table_input</code> argument in the Lua script is assumed to be passed from the action arguments, that way the same script can be reused for different tables. Check the <a href="/howto/hooks/lua.html#lakefscatalogexportglue_exporterexport_glueglue-db-table_src_path-create_table_input-action_info-options">example</a> to construct the table input in the lua code.</p>
</blockquote>

<div class="tabs">
  <ul>
    <li><a href="#single-hook-csv">Hook CSV Glue Table</a></li>
    <li><a href="#single-hook">Hook Parquet Glue Table</a></li>
    <li><a href="#multiple-hooks">Multiple Hooks / Inline script</a></li>
  </ul>
  <div id="single-hook-csv">
<h4 id="single-hook-with-csv-table">
  
  
    <a href="#single-hook-with-csv-table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Single hook with CSV Table
  
  
</h4>
    

    <p>Upload to <code class="language-plaintext highlighter-rouge">_lakefs_actions/animals_glue.yaml</code>:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Glue Exporter</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">post-commit</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">main"</span><span class="pi">]</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">animals_table_glue_exporter</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">script_path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">scripts/animals_exporter.lua"</span>
      <span class="na">args</span><span class="pi">:</span>
        <span class="na">aws</span><span class="pi">:</span>
          <span class="na">aws_access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_ACCESS_KEY_ID&gt;"</span>
          <span class="na">aws_secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_SECRET_ACCESS_KEY&gt;"</span>
          <span class="na">aws_region</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_REGION&gt;"</span>
        <span class="na">table_source</span><span class="pi">:</span> <span class="s1">'</span><span class="s">_lakefs_tables/animals.yaml'</span>
        <span class="na">catalog</span><span class="pi">:</span>
          <span class="na">db_name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my-glue-db"</span>
          <span class="na">table_input</span><span class="pi">:</span>
            <span class="na">StorageDescriptor</span><span class="pi">:</span> 
              <span class="na">InputFormat</span><span class="pi">:</span> <span class="s2">"</span><span class="s">org.apache.hadoop.hive.ql.io.SymlinkTextInputFormat"</span>
              <span class="na">OutputFormat</span><span class="pi">:</span> <span class="s2">"</span><span class="s">org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"</span>
              <span class="na">SerdeInfo</span><span class="pi">:</span>
                <span class="na">SerializationLibrary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">org.apache.hadoop.hive.serde2.OpenCSVSerde"</span>
                <span class="na">Parameters</span><span class="pi">:</span>
                  <span class="na">separatorChar</span><span class="pi">:</span> <span class="s2">"</span><span class="s">,"</span>
            <span class="na">Parameters</span><span class="pi">:</span> 
              <span class="na">classification</span><span class="pi">:</span> <span class="s2">"</span><span class="s">csv"</span>
              <span class="s2">"</span><span class="s">skip.header.line.count"</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
</code></pre></div>    </div>

  </div>
  <div id="single-hook">
<h4 id="spark-parquet-example">
  
  
    <a href="#spark-parquet-example" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Spark Parquet Example
  
  
</h4>
    

    <p>When working with Parquet files, upload the following to <code class="language-plaintext highlighter-rouge">_lakefs_actions/animals_glue.yaml</code>:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Glue Exporter</span>
<span class="na">on</span><span class="pi">:</span>
   <span class="na">post-commit</span><span class="pi">:</span>
      <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">main"</span><span class="pi">]</span>
<span class="na">hooks</span><span class="pi">:</span>
   <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">animals_table_glue_exporter</span>
     <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
     <span class="na">properties</span><span class="pi">:</span>
        <span class="na">script_path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">scripts/animals_exporter.lua"</span>
        <span class="na">args</span><span class="pi">:</span>
           <span class="na">aws</span><span class="pi">:</span>
              <span class="na">aws_access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_ACCESS_KEY_ID&gt;"</span>
              <span class="na">aws_secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_SECRET_ACCESS_KEY&gt;"</span>
              <span class="na">aws_region</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_REGION&gt;"</span>
           <span class="na">table_source</span><span class="pi">:</span> <span class="s1">'</span><span class="s">_lakefs_tables/animals.yaml'</span>
           <span class="na">catalog</span><span class="pi">:</span>
              <span class="na">db_name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my-glue-db"</span>
              <span class="na">table_input</span><span class="pi">:</span>
                 <span class="na">StorageDescriptor</span><span class="pi">:</span>
                   <span class="na">InputFormat</span><span class="pi">:</span> <span class="s2">"</span><span class="s">org.apache.hadoop.hive.ql.io.SymlinkTextInputFormat"</span>
                   <span class="na">OutputFormat</span><span class="pi">:</span> <span class="s2">"</span><span class="s">org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat"</span>
                   <span class="na">SerdeInfo</span><span class="pi">:</span>
                       <span class="na">SerializationLibrary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"</span>
                 <span class="na">Parameters</span><span class="pi">:</span>
                   <span class="na">classification</span><span class="pi">:</span> <span class="s2">"</span><span class="s">parquet"</span>
                   <span class="na">EXTERNAL</span><span class="pi">:</span> <span class="s2">"</span><span class="s">TRUE"</span>
                   <span class="s2">"</span><span class="s">parquet.compression"</span><span class="pi">:</span> <span class="s2">"</span><span class="s">SNAPPY"</span>
</code></pre></div>    </div>

  </div>
  <div id="multiple-hooks">
<h4 id="multiple-hooks--inline-script">
  
  
    <a href="#multiple-hooks--inline-script" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Multiple Hooks / Inline script
  
  
</h4>
    

    <p>The following example demonstrates how to separate the symlink and glue exporter into building blocks running in separate hooks.
It also shows how to run the lua script inline instead of a file, depending on user preference.</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Animal Table Exporter</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">post-commit</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">main"</span><span class="pi">]</span>
<span class="na">hooks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">symlink_exporter</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">args</span><span class="pi">:</span>
        <span class="na">aws</span><span class="pi">:</span>
          <span class="na">aws_access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_ACCESS_KEY_ID&gt;"</span>
          <span class="na">aws_secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_SECRET_ACCESS_KEY&gt;"</span>
          <span class="na">aws_region</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_REGION&gt;"</span>
        <span class="na">table_source</span><span class="pi">:</span> <span class="s1">'</span><span class="s">_lakefs_tables/animals.yaml'</span>
      <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">local exporter = require("lakefs/catalogexport/symlink_exporter")</span>
        <span class="s">local aws = require("aws")</span>
        <span class="s">local table_path = args.table_source</span>
        <span class="s">local s3 = aws.s3_client(args.aws.aws_access_key_id, args.aws.aws_secret_access_key, args.aws.aws_region)</span>
        <span class="s">exporter.export_s3(s3, table_path, action, {debug=true})</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">glue_exporter</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">lua</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">args</span><span class="pi">:</span>
        <span class="na">aws</span><span class="pi">:</span>
          <span class="na">aws_access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_ACCESS_KEY_ID&gt;"</span>
          <span class="na">aws_secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_SECRET_ACCESS_KEY&gt;"</span>
          <span class="na">aws_region</span><span class="pi">:</span> <span class="s2">"</span><span class="s">&lt;AWS_REGION&gt;"</span>
        <span class="na">table_source</span><span class="pi">:</span> <span class="s1">'</span><span class="s">_lakefs_tables/animals.yaml'</span>
        <span class="na">catalog</span><span class="pi">:</span>
          <span class="na">db_name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">my-glue-db"</span>
          <span class="na">table_input</span><span class="pi">:</span> <span class="c1"># add glue table input here </span>
      <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">local aws = require("aws")</span>
        <span class="s">local exporter = require("lakefs/catalogexport/glue_exporter")</span>
        <span class="s">local glue = aws.glue_client(args.aws.aws_access_key_id, args.aws.aws_secret_access_key, args.aws.aws_region)</span>
        <span class="s">exporter.export_glue(glue, args.catalog.db_name, args.table_source, args.catalog.table_input, action, {debug=true})  </span>
</code></pre></div>    </div>

  </div>
</div>

<p>Adding the script and the action files to the repository and commit it. This is a post-commit action, meaning it will be executed after the commit operation has taken place.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakectl fs upload lakefs://catalogs/main/scripts/animals_exporter.lua <span class="nt">-s</span> ./animals_exporter.lua
lakectl fs upload lakefs://catalogs/main/_lakefs_actions/animals_glue.yaml <span class="nt">-s</span> ./animals_glue.yaml
lakectl commit lakefs://catalogs/main <span class="nt">-m</span> <span class="s2">"trigger first export hook"</span>
</code></pre></div></div>

<p>Once the action has completed its execution, you can review the results in the action logs.</p>

<p><img src="/assets/img/glue_export_hook_result_log.png" alt="Hooks log result in lakeFS UI" /></p>
<h3 id="use-athena">
  
  
    <a href="#use-athena" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use Athena
  
  
</h3>
    

<p>We can use the exported Glue table with any tool that supports Glue Catalog (or Hive compatible) such as Athena, Trino, Spark and others.
To use Athena we can simply run <code class="language-plaintext highlighter-rouge">MSCK REPAIR TABLE</code> and then query the tables.</p>

<p>In Athena, make sure that the correct database (<code class="language-plaintext highlighter-rouge">my-glue-db</code> in the example above) is configured, then run:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MSCK</span> <span class="n">REPAIR</span> <span class="k">TABLE</span> <span class="nv">`animals_catalogs_main_9255e5`</span><span class="p">;</span> <span class="c1">-- load partitions for the first time </span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="nv">`animals_catalogs_main_9255e5`</span> <span class="k">limit</span> <span class="mi">50</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/img/catalog_export_athena_aws_ui_sql.png" alt="Athena SQL Result" /></p>
<h3 id="cleanup">
  
  
    <a href="#cleanup" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cleanup
  
  
</h3>
    

<p>Users can use additional hooks / actions to implement a custom cleanup logic to delete the symlink in S3 and Glue Tables.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">glue</span><span class="p">.</span><span class="n">delete_table</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="s1">'&lt;glue table name&gt;'</span><span class="p">)</span>
<span class="n">s3</span><span class="p">.</span><span class="n">delete_recursive</span><span class="p">(</span><span class="s1">'bucket'</span><span class="p">,</span> <span class="s1">'path/to/symlinks/of/a/commit/'</span><span class="p">)</span>
</code></pre></div></div>

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            GitHub
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/cloud-registration/" class="site-button" >
                            lakeFS Cloud
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/youtube" class="site-button" >
                            <img src="/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/assets/icons/github.svg" class="no-hover" />
                            <img src="/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://data-folks.masto.host/@lakeFS" class="site-button" >
                            <img src="/assets/icons/mastodon.svg" class="no-hover" />
                            <img src="/assets/icons/mastodon-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/assets/icons/slack.svg" class="no-hover" />
                            <img src="/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>

